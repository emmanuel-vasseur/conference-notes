<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Devenir svelte avec Svelte</title>
  <link rel="stylesheet" href="Devenir%20svelte%20avec%20Svelte_fichiers/css.css">
  <link rel="stylesheet" href="Devenir%20svelte%20avec%20Svelte_fichiers/icon.css">
  <link rel="stylesheet" href="Devenir%20svelte%20avec%20Svelte_fichiers/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14" environment="web" category="null"></google-codelab-analytics>
  <google-codelab codelab-gaid="" id="build" environment="web" feedback-link="https://zenika.com" selected="0" google-codelab-ready="" codelab-title="Devenir svelte avec Svelte"><div id="drawer"><div class="codelab-time-container"><div class="time-remaining" title="Time remaining"><i class="material-icons">access_time</i>236 mins remaining</div></div><div class="steps"><ol><li completed="" selected=""><a href="#0"><span class="step"><span>Overview</span></span></a></li><li><a href="#1"><span class="step"><span>Créez votre première application</span></span></a></li><li><a href="#2"><span class="step"><span>Créer un composant</span></span></a></li><li><a href="#3"><span class="step"><span>Afficher des variables dans un template</span></span></a></li><li><a href="#4"><span class="step"><span>Attributs d'un composant</span></span></a></li><li><a href="#5"><span class="step"><span>Conditions d'affichage</span></span></a></li><li><a href="#6"><span class="step"><span>Ajouter du style</span></span></a></li><li><a href="#7"><span class="step"><span>Créer un formulaire</span></span></a></li><li><a href="#8"><span class="step"><span>Double binding</span></span></a></li><li><a href="#9"><span class="step"><span>Réactivité</span></span></a></li><li><a href="#10"><span class="step"><span>Évènement lors du click sur le bouton</span></span></a></li><li><a href="#11"><span class="step"><span>Mise en place du store</span></span></a></li><li><a href="#12"><span class="step"><span>Store dérivé</span></span></a></li><li><a href="#13"><span class="step"><span>Animation</span></span></a></li><li><a href="#14"><span class="step"><span>Modifier le titre de la page</span></span></a></li><li><a href="#15"><span class="step"><span>SvelteKit</span></span></a></li><li><a href="#16"><span class="step"><span>Ajouter une nouvelle page</span></span></a></li><li><a href="#17"><span class="step"><span>Ajouter un layout</span></span></a></li><li><a href="#18"><span class="step"><span>Ajouter une page de recette</span></span></a></li><li><a href="#19"><span class="step"><span>Afficher une page de détail</span></span></a></li><li><a href="#20"><span class="step"><span>Accessibilité</span></span></a></li><li><a href="#21"><span class="step"><span>Ajouter du code serveur</span></span></a></li><li><a href="#22"><span class="step"><span>Utiliser notre API</span></span></a></li><li><a href="#23"><span class="step"><span>SSR</span></span></a></li><li><a href="#24"><span class="step"><span>Testing</span></span></a></li><li><a href="#25"><span class="step"><span>Déployer l'application</span></span></a></li><li><a href="#26"><span class="step"><span>Ajouter une recherche de recette sur Marmiton (Bonus)</span></span></a></li><li><a href="#27"><span class="step"><span>Fin</span></span></a></li></ol></div><div class="metadata"><a target="_blank" href="https://zenika.com/"><i class="material-icons">bug_report</i> Report a mistake</a></div></div><div id="codelab-title"><div id="codelab-nav-buttons"><a href="https://codelab-svelte.web.app/" id="arrow-back"><i class="material-icons">close</i></a><a href="#" id="menu"><i class="material-icons">menu</i></a></div><h1 is-upgraded="" class="title">Devenir svelte avec Svelte</h1><div class="codelab-time-container"><div class="time-remaining" title="Time remaining"><i class="material-icons">access_time</i>236 mins remaining</div></div><devsite-user></devsite-user></div><div id="main"><div id="steps"><google-codelab-step label="Overview" duration="10" step="1" selected=""><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">1. Overview</h2>
        <h2 is-upgraded="">Ce que vous allez apprendre</h2>
<ul>
<li>Installation du framework</li>
<li>Création de composants</li>
<li>Passage de paramètres</li>
<li>Utilisation de la réactivité</li>
<li>Templating</li>
<li>Events et binding</li>
<li>Cycle de vie des composants</li>
<li>Stores et contexte</li>
<li>Animations</li>
<li>Sveltekit</li>
<li>SSR</li>
<li>Test</li>
<li>Déploiement</li>
</ul>
<h2 is-upgraded="">Présentation de Svelte</h2>
<p><em>Svelte</em> est un compilateur plus qu'un framework, il ajoute du
 sucre syntaxique à du code javascript pour développer des applications.
 Il va ainsi pouvoir instrumentaliser le code pour ajouter des 
instructions pour mettre à jour l'affichage lors de changement des 
données.</p>
<p>Sur le site de <a href="https://svelte.dev/" target="_blank">Svelte</a>, un REPL (Read Eval Print Loop) permet de tester en direct du code <em>Svelte</em> et voir le code généré. De même un <a href="https://svelte.dev/tutorial/basics" target="_blank">tutoriel</a> permet d'apprendre les bases du framework pas à pas.</p>
<p>Un fichier <em>Svelte</em> (fichier avec une extension .svelte) 
ressemble à un fichier html qui va contenir les balises html de notre 
template, une balise <code>&lt;script&gt;</code> contenant le code javascript, ainsi qu'une balise <code>&lt;style&gt;</code> contenant le style CSS.</p>
<p>Par exemple :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
	</span><span class="kwd">const</span><span class="pln"> name </span><span class="pun">=</span><span class="pln"> </span><span class="str">'world'</span><span class="pun">;</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;style&gt;</span><span class="pln">
	h1 </span><span class="pun">{</span><span class="pln">
		color</span><span class="pun">:</span><span class="pln"> red</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/style&gt;</span><span class="pln">

</span><span class="tag">&lt;h1&gt;</span><span class="pln">Hello {name}!</span><span class="tag">&lt;/h1&gt;</span></code></pre>
<h2 is-upgraded="">Créer un projet Svelte</h2>
<p>Comme <em>Svelte</em> est un compilateur, il est nécessaire de le lancer pour pouvoir transformer les fichiers <code>.svelte</code> en fichier javascript et css.</p>
<p><em>Svelte</em> est capable de s'intégrer avec tous les packages bundler existant comme <em>Webpack</em> ou <em>Rollup</em>.</p>
<p>Ils fournissent des templates pour créer le squelette d'une application, et propose d'utiliser <code>degit</code> un utilitaire qui télécharge les fichiers d'un repos git sans l'historique.</p>
<p>Pour créer un projet avec <em>Rollup</em> il suffit alors de saisir les lignes de commandes suivantes :</p>
<pre><code language="language-bash" class="language-bash"><span class="pln">npx degit sveltejs</span><span class="pun">/</span><span class="kwd">template</span><span class="pln"> </span><span class="kwd">my</span><span class="pun">-</span><span class="pln">svelte</span><span class="pun">-</span><span class="pln">project
cd </span><span class="kwd">my</span><span class="pun">-</span><span class="pln">svelte</span><span class="pun">-</span><span class="pln">project
npm install
npm run dev</span></code></pre>
<p>Vous aurez alors un projet de base avec les outils permettant de 
lancer l'application en développement ou construire l'application à 
deployer.</p>
<aside class="special"><p> Vous pouvez utiliser Typescript en éxecutant la commande : <code>node scripts/setupTypeScript.js</code></p>
</aside>
<h2 is-upgraded="">Le projet pour ce codelab</h2>
<p>Après cette rapide introduction à <em>Svelte</em>, nous allons créer pour ce codelab un projet permettant de calculer son IMC (Indice de Masse Corporelle).</p>
<aside class="special"><p> L'indice de masse corporelle ou IMC (en 
anglais, body mass index ou BMI) est une grandeur qui permet d'estimer 
la corpulence d'une personne. Inventé au milieu du XIXe siècle par 
Adolphe Quetelet, mathématicien belge et l'un des fondateurs de la 
statistique moderne, cet indice est appelé aussi l'indice de Quetelet. </p>
</aside>
<p>La formule pour calculer l'IMC est le poids divisé par la taille au carré.</p>
<p><a href="https://become-svelte.netlify.app/" target="_blank">Voir l'application finale</a></p>


      </div></div></google-codelab-step><google-codelab-step label="Créez votre première application" duration="10" step="2"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">2. Créez votre première application</h2>
        <h2 is-upgraded="">Initialiser le projet</h2>
<p>Comme vu lors de la première étape, nous allons initialiser notre 
application en partant d'un template. Nous avons créé un template pour 
le codelab qui va contenir des éléments qui seront utilisés directement 
par votre application. Ce template contient déjà la structure pour 
utiliser <em>SvelteKit</em> pour la suite du codelab.</p>
<pre><code language="language-bash" class="language-bash"><span class="pln">npx degit zenika</span><span class="pun">/</span><span class="pln">labs</span><span class="pun">-</span><span class="pln">svelte</span><span class="pun">/</span><span class="kwd">template</span><span class="pln"> labs</span><span class="pun">-</span><span class="pln">svelte
cd labs</span><span class="pun">-</span><span class="pln">svelte
npm install</span></code></pre>
<h2 is-upgraded="">Découvrir ce qui a été généré</h2>
<p>Vous vous retrouvez avec une application <em>SvelteKit</em>  Voici les différents fichiers que l'on peut retrouver :</p>
<ul>
<li><strong>package.json</strong> : Contient les dépendances, ainsi que les scripts <code>dev</code> (pour lancer le projet en développement) ou <code>build</code> (pour construire l'application finale).</li>
<li><strong>svelte.config.js</strong> : Configuration pour <em>SvelteKit</em>.</li>
<li><strong>static</strong> : Les ressources statiques du projet.</li>
<li><strong>src</strong>: Les fichiers sources de l'application où seront ajoutés les différents composants. <ul>
<li><strong>lib</strong> : Les composants commun de l'application, c'est dans ce répertoire que l'on va travailler pour tous le début du codelab</li>
<li><strong>routes</strong> : Les différentes pages de votre application, que l'on verra plus tard dans le codelab</li>
<li><strong>app.html</strong> : Page HTML de l'application où se chargera votre application.</li>
<li><strong>global.d.ts</strong> : Permet d'ajouter les définitions de type pour utiliser l'autocomplexion sur le projet.</li>
</ul>
</li>
</ul>
<h2 is-upgraded="">Lancer le projet</h2>
<p>Maintenant, lançons le projet :</p>
<pre><code language="language-bash" class="language-bash"><span class="pln">npm run dev</span></code></pre>
<p>En ouvrant le navigateur à l'url <a href="http://localhost:3000/" target="_blank">http://localhost:3000/</a> vous verrez la page de notre application :</p>
<p class="image-container"><img alt="Capture step 1" src="Devenir%20svelte%20avec%20Svelte_fichiers/e4960cd5f2f9d5f1.png"></p>
<h2 is-upgraded="">Modifier et voir le résultat</h2>
<p>Maintenant entrons dans le vif du sujet, ouvrez le fichier <strong>ImcCalculator.svelte</strong> puis modifiez la variable <code>name</code> pour y mettre votre nom :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">const</span><span class="pln"> name </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Votre nom"</span><span class="pun">;</span></code></pre>
<p>Une fois les modifications sauvegardées, l'application sera 
automatiquement rafraîchie avec les changements et vous devriez avoir le
 texte "Bonjour Votre nom" qui s'affiche à l'écran.</p>
<p>Passons maintenant à l'étape suivante pour créer notre premier composant.</p>


      </div></div></google-codelab-step><google-codelab-step label="Créer un composant" duration="5" step="3"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">3. Créer un composant</h2>
        <p>Nous allons maintenant créer notre premier composant, pour cela créez un nouveau fichier <strong>Imc.svelte</strong> dans le répertoire <code>src/lib</code>.</p>
<p>Dans ce fichier, mettez du code html pour afficher un simple texte :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;p&gt;</span><span class="pln">Votre IMC est de 20</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>Dans le fichier <strong>ImcCalculator.svelte</strong>, ajoutez simplement l'import de notre composant Imc :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> </span><span class="typ">Imc</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"./Imc.svelte"</span><span class="pun">;</span></code></pre>
<aside class="special"><p> Placer ce code javascript entre les balise html <em>&lt;script&gt;&lt;/script&gt;</em></p>
</aside>
<p>Nous pouvons maintenant utiliser notre composant Imc directement dans notre contenu html :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;Imc</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
<p>Nous nous retrouvons à présent avec une page qui affiche le texte "Votre IMC est de 20".</p>
<p>Maintenant, il faudrait que ce texte soit plus dynamique et qu'il puisse être configuré en fonction du poids et de la taille.</p>


      </div></div></google-codelab-step><google-codelab-step label="Afficher des variables dans un template" duration="10" step="4"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">4. Afficher des variables dans un template</h2>
        <p>Dans notre fichier <strong>Imc.svelte</strong>, nous allons 
ajouter deux variables pour définir le poids et la taille, et afficher 
ensuite le calcul de l'IMC à la place de notre texte html statique.</p>
<p>Pour cela, dans <strong>Imc.svelte</strong>, ajoutons une balise script, contenant deux déclarations de variable :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  let poids </span><span class="pun">=</span><span class="pln"> </span><span class="lit">80</span><span class="pun">;</span><span class="pln">
  let taille </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1.80</span><span class="pun">;</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<p>Nous pouvons maintenant afficher ces variables dans le html en utilisant la syntaxe <code>{variable ou expression}</code></p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;p&gt;</span><span class="pln">Votre IMC ({poids}/{taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {(poids / taille ** 2).toFixed(2)}</span><span class="tag">&lt;/p&gt;</span></code></pre>
<aside class="special"><p> La formule de l'IMC est le poids en kilo divisé par la taille en mètre au carré. </p>
</aside>
<p>Analysons le code ci-dessus : <code>{poids}</code> et <code>{taille}</code> seront remplacés respectivement par le contenu des variables <code>poids</code> et <code>taille</code>. <code>{(poids / taille ** 2).toFixed(2)}</code> réalise plusieurs actions :</p>
<ul>
<li><code>(poids / taille ** 2)</code> : Calcule l'IMC (l'opérateur ** permet de faire une puissance en javascript).</li>
<li><code>.toFixed(2)</code> : Convertit le nombre en chaine de caractère en ne gardant que deux chiffres après la virgule.</li>
<li><code>{}</code>: Syntaxe permettant à <em>Svelte</em> d'afficher le contenu dans le html.</li>
</ul>
<p>Vous pouvez maintenant faire évoluer la valeur des variables <code>poids</code> ou <code>taille</code> puis voir le résultat du calcul de l'IMC en rafraichissant la page.</p>
<p>Ce composant, même s'il permet de faire le calcul n'est pas 
utilisable dans une application car il utilise des variables locales à 
celui-ci. Voyons maintenant comment paramétrer ces variables pour 
permettre de recevoir ces valeurs en entrée du composant.</p>


      </div></div></google-codelab-step><google-codelab-step label="Attributs d'un composant" duration="10" step="5"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">5. Attributs d'un composant</h2>
        <p>Pour définir les paramètres d'un composant <em>Svelte</em>, dont les valeurs seront transmises via des attributs html, il faut définir une variable et la préfixer par le mot clé <code>export</code>. (Ex: <code>export let monParametre;</code>)</p>
<aside class="special"><p> En javascript, le mot clé <code>export</code> permet d'indiquer que la variable ou la fonction est accessible à l'extérieur du fichier (du module). <em>Svelte</em> l'utilise pour définir les entrées des composants. </p>
</aside>
<p>Une fois ce mot clé ajouté :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  </span><span class="kwd">export</span><span class="pln"> let poids </span><span class="pun">=</span><span class="pln"> </span><span class="lit">80</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">export</span><span class="pln"> let taille </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1.80</span><span class="pun">;</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<p>Nous pouvons maintenant passer des valeurs par des attributs html à notre composant :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;Imc</span><span class="pln"> </span><span class="atn">poids</span><span class="pun">=</span><span class="atv">100</span><span class="pln"> </span><span class="atn">taille</span><span class="pun">=</span><span class="atv">1.9</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
<p>Il est bien sûr possible de faire en sorte que cet attribut soit dynamique :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;Imc</span><span class="pln"> </span><span class="atn">poids</span><span class="pun">=</span><span class="atv">{monPoids}</span><span class="pln"> {</span><span class="atn">taille</span><span class="pln">} </span><span class="tag">/&gt;</span></code></pre>
<p>Ici :</p>
<ul>
<li><code>poids={monPoids}</code> : le contenu de la variable <code>monPoids</code> est passé dans l'attribut <code>poids</code></li>
<li><code>{taille}</code> : écriture simplifiée de <code>taille={taille}</code></li>
</ul>


      </div></div></google-codelab-step><google-codelab-step label="Conditions d'affichage" duration="10" step="6"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">6. Conditions d'affichage</h2>
        <p>Ajoutons maintenant un message qui précise notre état de corpulence en fonction de l'IMC.</p>
<aside class="special"><p> Un IMC compris entre 18 et 25 correspond à 
une corpulence "normale". Au delà, on parle de surpoids, et en dessous, 
de maigreur. </p>
</aside>
<p>Nous voulons donc ajouter un message en fonction de notre IMC. <em>Svelte</em> permet d'ajouter des conditions dans un template avec la syntaxe <code>{#if condition}{:else if condition}{:else}{/if}</code></p>
<p>Commençons par créer une variable contenant notre IMC. Cette valeur sera utilisée dans notre condition :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">const</span><span class="pln"> imc </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">poids </span><span class="pun">/</span><span class="pln"> taille </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span><span class="pun">).</span><span class="pln">toFixed</span><span class="pun">(</span><span class="lit">2</span><span class="pun">);</span></code></pre>
<p>Nous pouvons ensuite ajouter dans le code html, un ensemble de 
conditions pour afficher un message. Pour cela nous utilisons une 
syntaxe propre à <em>Svelte</em> en utilisant les instructions <code>{#if}</code>, <code>{:else if}</code> et <code>{/if}</code>.</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;p&gt;</span><span class="pln">Votre IMC ({poids}/{taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {imc}</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{#if imc &lt; 18}
  </span><span class="tag">&lt;p&gt;</span><span class="pln">Vous êtes maigre</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else if imc &gt; 25}
  </span><span class="tag">&lt;p&gt;</span><span class="pln">Vous êtes en surpoids</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else}
  </span><span class="tag">&lt;p&gt;</span><span class="pln">Vous êtes svelte !</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{/if}</span></code></pre>
<p><em>Svelte</em> donne accès à d'autres éléments de syntaxe de ce genre pour aider la création de templates, tel que <code>{#each}{/each}</code> pour effectuer une boucle.</p>
<p>Les éléments de template <em>Svelte</em> sont encapsulés dans 2 accolades <code>{}</code>. Afin de pouvoir imbriquer les balises, on différencie les balises ouvrantes ou fermantes, respectivement avec les caractères <code>#</code> et <code>/</code>. Les balises <code>else</code> sont elles précédées de <code>:</code>. Il est possible de les utiliser en association avec une balise <code>if</code> mais aussi avec <code>each</code>. Dans le second cas, cela permet d'afficher une alternative au cas où le tableau serait vide.</p>


      </div></div></google-codelab-step><google-codelab-step label="Ajouter du style" duration="10" step="7"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">7. Ajouter du style</h2>
        <p>Nous aimerions maintenant différencier les messages que nous affichons dans différentes couleurs :</p>
<ul>
<li><em>orange</em>: pour un IMC inférieur à 18</li>
<li><em>rouge</em>: pour un IMC supérieur à 25</li>
<li><em>vert</em>: pour un IMC compris entre 18 et 25</li>
</ul>
<p>Pour cela, nous allons créer 3 classes CSS. Deux solutions s'offrent à nous :</p>
<ul>
<li>Option 1 : ajouter ces classes dans le fichier <code>global.css</code> qui se trouve dans le répertoire <code>public</code>. Les classes seront alors disponibles pour toute l'application.</li>
<li>Option 2 : ajouter ces classes dans le fichier de notre composant <strong>Imc.svelte</strong>, en insérant une balise <code>&lt;style&gt;&lt;/style&gt;</code>. Les classes seront alors scopées à notre composant (non disponibles en dehors du composant).</li>
</ul>
<pre><code language="language-css" class="language-css"><span class="pun">.</span><span class="pln">normal </span><span class="pun">{</span><span class="pln">
  color</span><span class="pun">:</span><span class="pln"> green</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="pun">.</span><span class="pln">surpoids </span><span class="pun">{</span><span class="pln">
  color</span><span class="pun">:</span><span class="pln"> red</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="pun">.</span><span class="pln">souspoids </span><span class="pun">{</span><span class="pln">
  color</span><span class="pun">:</span><span class="pln"> orange</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<p>Nous allons choisir l'option 2. Ajoutons les classes CSS dans le code de notre composant :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;p&gt;</span><span class="pln">Votre IMC ({poids}/{taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {imc}</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{#if imc &lt; 18}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"souspoids"</span><span class="tag">&gt;</span><span class="pln">Vous êtes maigre</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else if imc &gt; 25}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"surpoids"</span><span class="tag">&gt;</span><span class="pln">Vous êtes en surpoids</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"normal"</span><span class="tag">&gt;</span><span class="pln">Vous êtes svelte !</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{/if}
</span><span class="tag">&lt;style&gt;</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">normal </span><span class="pun">{</span><span class="pln">
    color</span><span class="pun">:</span><span class="pln"> green</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">surpoids </span><span class="pun">{</span><span class="pln">
    color</span><span class="pun">:</span><span class="pln"> red</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">souspoids </span><span class="pun">{</span><span class="pln">
    color</span><span class="pun">:</span><span class="pln"> orange</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/style&gt;</span></code></pre>
<p><em>Svelte</em> va automatiquement ajouter une classe générée sur 
chaque composant, et le CSS sera automatiquement scopé grâce cette 
classe. Si un autre composant déclare aussi une classe CSS <code>.normal</code>, il n'y aura ainsi aucune collision.</p>
<p>Pour aller plus loin dans la manipulation du style, voyons comment 
nous pouvons utiliser des classes CSS de façon conditionnelle.</p>
<p>Pour cela, jouons sur l'affichage du texte dans la balise <code>p</code> de l'IMC, avec deux nouvelles classes CSS (<code>thin</code> et <code>bold</code>) :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="pln">&lt;p class:thin={imc &lt; 18} class:bold={imc &gt; 25}&gt;
    Votre IMC ({poids}/{taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {imc}
</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>puis on ajoute les classes dans la balise style de notre composant :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;style&gt;</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">normal </span><span class="pun">{</span><span class="pln">
    color</span><span class="pun">:</span><span class="pln"> green</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">surpoids </span><span class="pun">{</span><span class="pln">
    color</span><span class="pun">:</span><span class="pln"> red</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">souspoids </span><span class="pun">{</span><span class="pln">
    color</span><span class="pun">:</span><span class="pln"> orange</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">thin </span><span class="pun">{</span><span class="pln">
    font</span><span class="pun">-</span><span class="pln">weight</span><span class="pun">:</span><span class="pln"> </span><span class="lit">200</span><span class="pun">;</span><span class="pln">
    font</span><span class="pun">-</span><span class="pln">size</span><span class="pun">:</span><span class="pln"> </span><span class="pun">.</span><span class="lit">875rem</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">bold </span><span class="pun">{</span><span class="pln">
    font</span><span class="pun">-</span><span class="pln">weight</span><span class="pun">:</span><span class="pln"> </span><span class="lit">600</span><span class="pun">;</span><span class="pln">
    font</span><span class="pun">-</span><span class="pln">size</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1.125rem</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/style&gt;</span></code></pre>
<p>C'est plutôt pratique, mais avec cette façon de faire nous utilisons 
les même conditions à 2 endroits différents, ce qui n'est pas idéal en 
terme de maintenabilité. Pour remédier à ce "problème", <em>Svelte</em> 
met à disposition un sucre syntaxique extrémement pratique. Si la classe
 et la variable qui conditionne son affichage portent le même nom, alors
 nous pouvons simplement écrire <code>class:condition</code>.</p>
<p>Dans notre cas, commençons donc par ajouter nos conditions dans 2 nouvelles variables :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  </span><span class="kwd">const</span><span class="pln"> imc </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">poids </span><span class="pun">/</span><span class="pln"> taille </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span><span class="pun">).</span><span class="pln">toFixed</span><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span><span class="pln">
  </span><span class="kwd">const</span><span class="pln"> thin </span><span class="pun">=</span><span class="pln"> imc </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">18</span><span class="pln">
  </span><span class="kwd">const</span><span class="pln"> bold </span><span class="pun">=</span><span class="pln"> imc </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">25</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<p>Puis, modifions notre code html pour utiliser ces nouvelles variables :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class:thin</span><span class="pln"> </span><span class="atn">class:bold</span><span class="tag">&gt;</span><span class="pln">
    Votre IMC ({poids}/{taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {imc}
</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{#if thin}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"souspoids"</span><span class="tag">&gt;</span><span class="pln">Vous êtes maigre</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else if bold}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"surpoids"</span><span class="tag">&gt;</span><span class="pln">Vous êtes en surpoids</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"normal"</span><span class="tag">&gt;</span><span class="pln">Vous êtes svelte !</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{/if}</span></code></pre>
<p>Le code complet de notre composant ressemble au final à ceci :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  </span><span class="kwd">const</span><span class="pln"> imc </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">poids </span><span class="pun">/</span><span class="pln"> taille </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span><span class="pun">).</span><span class="pln">toFixed</span><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span><span class="pln">
  </span><span class="kwd">const</span><span class="pln"> thin </span><span class="pun">=</span><span class="pln"> imc </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">18</span><span class="pln">
  </span><span class="kwd">const</span><span class="pln"> bold </span><span class="pun">=</span><span class="pln"> imc </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">25</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class:thin</span><span class="pln"> </span><span class="atn">class:bold</span><span class="tag">&gt;</span><span class="pln">
    Votre IMC ({poids}/{taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {imc}
</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{#if thin}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"souspoids"</span><span class="tag">&gt;</span><span class="pln">Vous êtes maigre</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else if bold}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"surpoids"</span><span class="tag">&gt;</span><span class="pln">Vous êtes en surpoids</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"normal"</span><span class="tag">&gt;</span><span class="pln">Vous êtes svelte !</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{/if}

</span><span class="tag">&lt;style&gt;</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">normal </span><span class="pun">{</span><span class="pln">
    color</span><span class="pun">:</span><span class="pln"> green</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">surpoids </span><span class="pun">{</span><span class="pln">
    color</span><span class="pun">:</span><span class="pln"> red</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">souspoids </span><span class="pun">{</span><span class="pln">
    color</span><span class="pun">:</span><span class="pln"> orange</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">thin </span><span class="pun">{</span><span class="pln">
    font</span><span class="pun">-</span><span class="pln">weight</span><span class="pun">:</span><span class="pln"> </span><span class="lit">200</span><span class="pun">;</span><span class="pln">
    font</span><span class="pun">-</span><span class="pln">size</span><span class="pun">:</span><span class="pln"> </span><span class="pun">.</span><span class="lit">875rem</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">bold </span><span class="pun">{</span><span class="pln">
    font</span><span class="pun">-</span><span class="pln">weight</span><span class="pun">:</span><span class="pln"> </span><span class="lit">600</span><span class="pun">;</span><span class="pln">
    font</span><span class="pun">-</span><span class="pln">size</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1.125rem</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/style&gt;</span></code></pre>


      </div></div></google-codelab-step><google-codelab-step label="Créer un formulaire" duration="10" step="8"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">8. Créer un formulaire</h2>
        <p>Pour l'instant, le poids et la taille sont définis comme des attributs du composant <code>Imc</code>.
 Nous voulons à présent rendre ces attributs éditables par l'utilisateur
 au travers de l'interface. Nous allons alors créer un formulaire pour 
pouvoir saisir notre poids et notre taille et ainsi pouvoir calculer 
notre IMC.</p>
<h2 is-upgraded="">Nouveau composant</h2>
<p>Commençons par créer un nouveau composant que nous nommerons <code>Form.svelte</code> dans le répertoire <code>src/lib</code>.</p>
<p>Ce composant contiendra un formulaire simple avec deux sliders permettant de définir son poids et sa taille :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  let poids </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  let taille </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;form&gt;</span><span class="pln">
  </span><span class="tag">&lt;label&gt;</span><span class="pln"> Poids ({poids} kg) :
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"poids"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"10"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"200"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"5"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">{poids}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/label&gt;</span><span class="pln">

  </span><span class="tag">&lt;label&gt;</span><span class="pln"> Taille ({taille.toFixed(2)} m) :
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"taille"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"0.5"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"2.5"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"0.01"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">{taille}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/label&gt;</span><span class="pln">
</span><span class="tag">&lt;/form&gt;</span></code></pre>
<p>Regardons en détail ce que fait ce composant:</p>
<ul>
<li><code>let poids = 0; let taille = 0;</code>: Création de variables pour le poids et la taille, initialisés à <code>0</code>.</li>
<li><code>Poids ({poids} kg)</code> <code>Taille ({taille.toFixed(2)} m)</code>: Affichage de la valeur de chaque variable dans les labels, avec la syntaxe <code>{}</code> vu précédemment.</li>
<li><code>&lt;input name="poids" type="range" min="10" max="200" step="5" value={poids} /&gt;</code> <code>&lt;input name="taille" type="range" min="0.5" max="2.5" step="0.01" value={taille} /&gt;</code>: Ajout de 2 inputs de type <code>range</code> pour régler le poids et la taille, initialisés avec les valeurs de nos variables.</li>
</ul>
<p>Ajoutons maintenant ce formulaire dans notre composant principale <strong>ImcCalculator.svelte</strong>. Pour cela, commençons par l'importer :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> </span><span class="typ">Form</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"./Form.svelte"</span><span class="pun">;</span></code></pre>
<p>Puis, nous pouvons l'utiliser au dessus du composant <code>&lt;Imc /&gt;</code> :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;Form</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;Imc</span><span class="pln"> </span><span class="atn">poids</span><span class="pun">=</span><span class="atv">100</span><span class="pln"> </span><span class="atn">taille</span><span class="pun">=</span><span class="atv">1.9</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
<h2 is-upgraded="">Évènements natifs</h2>
<p>En l'état actuel des choses, nous ne récupérons pas les valeurs 
saisies via les sliders. Nous allons remédier à ceci en commençant par 
jouer avec les évènements natifs des composants html.</p>
<p>En <em>Svelte</em>, pour s'abonner aux évènements d'un composant nous pouvons utiliser le prefix <code>on:</code> sur le nom de l'évènement auquel on souhaite réagir. Exemple <code>on:click={clickHandler}</code></p>
<ul>
<li><code>on:</code> Indique que nous souhaitons nous abonner à un évènenement.</li>
<li><code>click</code> Précise l'évènement auquel nous souhaitons nous abonner.</li>
<li><code>={clickHandler}</code> Précise la fonction à appeler lorsque l'évènement va survenir. Il est également possible d'appeler une fonction lambda <code>{event =&gt; changeEvent(event.target.value)}</code>.</li>
</ul>
<p>Autres exemples :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">on:input</span><span class="pun">=</span><span class="atv">{saveChange}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;button</span><span class="pln"> </span><span class="atn">on:click</span><span class="pun">=</span><span class="atv">{submit}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">on:mousemove</span><span class="pun">=</span><span class="atv">{event</span><span class="pln"> </span><span class="tag">=&gt;</span><span class="pln"> handleMousemove(event.clientX, event.clientY)}&gt;</span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>Pour nos besoins, commençons par créer deux fonctions (nos handlers) permettant de mettre à jour nos variables, dans <code>Form.svelte</code> :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  let poids </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  let taille </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">

  </span><span class="kwd">function</span><span class="pln"> onPoidsChange</span><span class="pun">(</span><span class="pln">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    poids </span><span class="pun">=</span><span class="pln"> event</span><span class="pun">.</span><span class="pln">target</span><span class="pun">.</span><span class="pln">value
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">function</span><span class="pln"> onTailleChange</span><span class="pun">(</span><span class="pln">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    taille </span><span class="pun">=</span><span class="pln"> parseFloat</span><span class="pun">(</span><span class="pln">event</span><span class="pun">.</span><span class="pln">target</span><span class="pun">.</span><span class="pln">value</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<p>Ensuite, branchons ces nouvelles fonctions sur les events de nos inputs :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"poids"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"10"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"200"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"5"</span><span class="pln"> </span><span class="atn">on:input</span><span class="pun">=</span><span class="atv">{onPoidsChange}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">

</span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"taille"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"0.5"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"2.5"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"0.01"</span><span class="pln"> </span><span class="atn">on:input</span><span class="pun">=</span><span class="atv">{onTailleChange}</span><span class="tag">/&gt;</span></code></pre>


      </div></div></google-codelab-step><google-codelab-step label="Double binding" duration="10" step="9"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">9. Double binding</h2>
        <p>Maintenant que nous pouvons récupérer les valeur de nos inputs, il est nécessaire de faire passer ces valeurs du composant <code>Form</code> vers le composant <code>Imc</code>.</p>
<h2 is-upgraded="">Descendre une valeur d'un composant parent</h2>
<p>Pour cela, il nous faut passer par le composant ImcCalculator pour faire passer les valeurs.</p>
<p>Ajoutons deux variables dans le fichier <strong>ImcCalculator.svelte</strong> à l'intérieur de la balise <code>&lt;script&gt;&lt;/script&gt;</code></p>
<pre><code><span class="pln"> </span><span class="kwd">let</span><span class="pln"> poids </span><span class="pun">=</span><span class="pln"> </span><span class="lit">80</span><span class="pun">;</span><span class="pln">
 </span><span class="kwd">let</span><span class="pln"> taille </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1.8</span><span class="pun">;</span></code></pre>
<p>Pour faire passer les valeurs au composant <code>Imc</code>, rien de plus simple, il nous suffit d'utiliser la syntaxe permettant de passer des paramètres à un composant <code>taille={taille}</code> ou la syntaxe simplifiée <code>{taille}</code> (😍):</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;Imc</span><span class="pln"> {</span><span class="atn">taille</span><span class="pln">} {</span><span class="atn">poids</span><span class="pln">} </span><span class="tag">/&gt;</span></code></pre>
<h2 is-upgraded="">Remonter une valeur au composant parent</h2>
<p>Mais comment faire sortir les données du composant <code>Form</code> ?</p>
<p>Commençons par ajouter le mot clé <code>export</code> devant les deux variables dans le fichier <strong>Form.svelte</strong> pour en faire des propriétés du composant:</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">export</span><span class="pln"> </span><span class="kwd">let</span><span class="pln"> poids </span><span class="pun">=</span><span class="pln"> </span><span class="lit">80</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">export</span><span class="pln"> </span><span class="kwd">let</span><span class="pln"> taille </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1.8</span><span class="pun">;</span></code></pre>
<p>et dans le fichier <strong>ImcCalculator.svelte</strong></p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;Form</span><span class="pln"> {</span><span class="atn">taille</span><span class="pln">} {</span><span class="atn">poids</span><span class="pln">} </span><span class="tag">/&gt;</span></code></pre>
<p>Les valeurs de <code>taille</code> et <code>poids</code> du composant <code>ImcCalculator</code> sont désormais transmises dans les composants <code>Form</code> et <code>Imc</code>. Nous pouvons également modifier ces valeurs au sein du composant <code>Form</code> via les inputs mais ces mises à jour ne modifient pas les valeurs dans le composant <code>Imc</code> car les modifications ne sont jamais remontées jusque dans <code>ImcCalculator</code>.</p>
<h2 is-upgraded="">Le Double Binding à la rescousse !</h2>
<p>Jusqu'à présent nous ne transmettons les données que dans un seul 
sens : du parent vers l'enfant. Nous voudrions maintenant que les 
modifications qui sont effectuées sur une propriété au sein de l'enfant 
soient également transmises au parent. Pour cela <em>Svelte</em> met à 
disposition une syntaxe de double binding, ou binding bi-directionnel, 
c'est à dire un binding qui est à la fois descendant et ascendant.</p>
<p>Pour ce faire, nous utilisons le mot clé <code>bind</code>.</p>
<p>Ajouter <code>bind:</code> devant une propriété permet de s'assurer 
que toutes les mises à jour de cette propriété dans l'enfant seront 
aussi transmises à la variable associée dans le parent.</p>
<p>Nous pouvons donc faire ceci sur le composant <code>Form</code> dans le composant <code>ImcCalculator</code> :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;Form</span><span class="pln"> </span><span class="atn">bind:poids</span><span class="pln"> </span><span class="atn">bind:taille</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
<p>Maintenant, les modifications dans <code>Form</code> mettent à jour les valeurs de poids et taille dans <code>Imc</code>.</p>
<p>⚠ Pour le moment, les valeurs de l'IMC et les styles ne sont pas 
modifiés lorsqu'on change les valeurs de poids et taille, ceci est 
l'objet du prochain chapitre.</p>
<h2 is-upgraded="">Double binding sur un élèment du DOM</h2>
<p>La syntaxe <code>bind:</code> permet également de faire un double 
binding entre une variable et une propriété d'un élément du DOM pour, 
par exemple, les éléments du formulaire.</p>
<p>Nous pouvons donc remplacer la combinaison de <code>value:poids</code> et <code>on:input={onPoidsChange}</code> par <code>bind:value={poids}</code> dans le fichier <strong>Form.svelte</strong>.</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"poids"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"10"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"200"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"5"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{poids}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"taille"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"0.5"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"2.5"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"0.01"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{taille}</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
<p>Les fonctions <code>onPoidsChange</code> et <code>onTailleChange</code> ne sont donc plus nécessaires et peuvent être supprimées. Ce qui nous donne le code suivant pour le composant <code>Form</code> :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  </span><span class="kwd">export</span><span class="pln"> let poids </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">export</span><span class="pln"> let taille </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;form&gt;</span><span class="pln">
  </span><span class="tag">&lt;label&gt;</span><span class="pln"> Poids ({poids} kg) :
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"poids"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"10"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"200"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"5"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{poids}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/label&gt;</span><span class="pln">

  </span><span class="tag">&lt;label&gt;</span><span class="pln"> Taille ({taille.toFixed(2)} m) :
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"taille"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"0.5"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"2.5"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"0.01"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{taille}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/label&gt;</span><span class="pln">
</span><span class="tag">&lt;/form&gt;</span><span class="pln">
</span></code></pre>


      </div></div></google-codelab-step><google-codelab-step label="Réactivité" duration="5" step="10"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">10. Réactivité</h2>
        <p>Nous pouvons modifier les valeurs de <code>poids</code> et <code>taille</code> dans <code>Imc</code> depuis <code>Form</code>, mais cela ne vient pas mettre à jour la valeur d'<code>imc</code>, ni les styles car les valeurs de <code>imc</code>, <code>thin</code> et <code>bold</code> ne sont calculées qu'à la création du composant. Les évolutions de valeurs des propriétés ne sont pas prises en compte.</p>
<p><em>Svelte</em> propose donc une syntaxe pour rendre réactive une (ou
 plusieurs) ligne de code. Cela permet de re-éxécuter la ligne de code 
en question si une ou plusieurs variables contenues dans cette ligne 
sont modifiées.</p>
<p>Pour cela il faut ajouter <code>$:</code> au début de la ligne (si on veut plusieurs lignes, on peut utiliser les <code>{}</code> : <code>$:{ }</code>).</p>
<p>Utilisons cette syntaxe de réactivité dans pour le calcul de l'imc et des classes css <code>thin</code> et <code>bold</code>.</p>
<pre><code language="language-javascript" class="language-javascript"><span class="pln">$</span><span class="pun">:</span><span class="pln"> imc </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">poids </span><span class="pun">/</span><span class="pln"> taille </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span><span class="pun">).</span><span class="pln">toFixed</span><span class="pun">(</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
$</span><span class="pun">:</span><span class="pln"> thin </span><span class="pun">=</span><span class="pln"> imc </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">18</span><span class="pun">;</span><span class="pln">
$</span><span class="pun">:</span><span class="pln"> bold </span><span class="pun">=</span><span class="pln"> imc </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">25</span><span class="pun">;</span></code></pre>
<p>L'IMC est maintenant bien recalculé lors de la modification du formulaire.</p>
<aside class="special"><p> Il n'est pas nécessaire de déclarer la variable avec <code>const</code> ou <code>let</code> lorsque nous utilisons cette syntaxe. Si la variable n'est pas déjà déclarée avant alors <em>Svelte</em> se charge de le faire pour nous. </p>
</aside>
<p>Cette syntaxe peut également être pratique pour faire du log et suivre les changements de valeurs des variables :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="pln">$</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">poids</span><span class="pun">);</span><span class="pln">
  console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">taille</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<aside class="warning"><p> Cette syntaxe $: n'est pas une invention de <em>Svelte</em>, c'est un détournement d'une syntaxe peu utilisée en javascript, les <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/label" target="_blank">labeled statements</a>. </p>
</aside>
<p>Une autre méthode permet de s'abonner aux changements des paramètres 
d'un composant en utilisant les fonctions du cycle de vie d'un composant
 :</p>
<ul>
<li><code>beforeUpdate</code> : la fonction passée en paramètre est appelée avant que les paramètres ne soient modifiés;</li>
<li><code>afterUpdate</code> : la fonction est appelée après que les paramètres aient été modifiés.</li>
</ul>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> beforeUpdate</span><span class="pun">,</span><span class="pln"> afterUpdate </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"svelte"</span><span class="pun">;</span><span class="pln">

beforeUpdate</span><span class="pun">(()</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">"the component is about to update"</span><span class="pun">);</span><span class="pln">
</span><span class="pun">});</span><span class="pln">

afterUpdate</span><span class="pun">(()</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">"the component just updated"</span><span class="pun">);</span><span class="pln">
  imc </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">poids </span><span class="pun">/</span><span class="pln"> taille </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span><span class="pun">).</span><span class="pln">toFixed</span><span class="pun">(</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
</span><span class="pun">});</span></code></pre>


      </div></div></google-codelab-step><google-codelab-step label="Évènement lors du click sur le bouton" duration="10" step="11"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">11. Évènement lors du click sur le bouton</h2>
        <p>Ajoutons maintenant la possibilité de sauvegarder notre IMC. Pour cela il est nécessaire d'ajouter un bouton <code>Sauvegarder</code> dans notre formulaire.</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  </span><span class="kwd">export</span><span class="pln"> let poids </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">export</span><span class="pln"> let taille </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;form&gt;</span><span class="pln">
  </span><span class="tag">&lt;label&gt;</span><span class="pln"> Poids ({poids} kg) :
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"poids"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"10"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"200"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"5"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{poids}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/label&gt;</span><span class="pln">

  </span><span class="tag">&lt;label&gt;</span><span class="pln"> Taille ({taille.toFixed(2)} m) :
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"taille"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"0.5"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"2.5"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"0.01"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{taille}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/label&gt;</span><span class="pln">

  </span><span class="tag">&lt;button</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"submit"</span><span class="tag">&gt;</span><span class="pln">Sauvegarder</span><span class="tag">&lt;/button&gt;</span><span class="pln">
</span><span class="tag">&lt;/form&gt;</span><span class="pln">
</span></code></pre>
<h2 is-upgraded="">Event dispatcher</h2>
<p>Pour envoyer un évènement, nous allons commencer par utiliser le <em>dispatcher</em> de <em>svelte</em>. Après la création d'un <code>eventDispatcher</code> avec le code suivant :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> createEventDispatcher </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"svelte"</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> dispatch </span><span class="pun">=</span><span class="pln"> createEventDispatcher</span><span class="pun">();</span></code></pre>
<p>Nous pouvons maintenant dispatcher des évènements personnalisés :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="pln">dispatch</span><span class="pun">(</span><span class="str">"sauvegarder"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  date</span><span class="pun">,</span><span class="pln">
  imc</span><span class="pun">,</span><span class="pln">
</span><span class="pun">});</span></code></pre>
<p>La fonction dispatch prends 2 arguments:</p>
<ul>
<li>Le nom de l'évènement.</li>
<li>La valeur à transmettre dans l'évènement.</li>
</ul>
<p>Le composant parent peut alors s'abonner à l'évènement, de la même façon qu'un évènement DOM natif, avec la syntaxe <code>on:sauvegarder={fonction_a_appeler}</code>.</p>
<p>La fonction <code>fonction_a_appeler</code> du composant parent 
recevra alors un argument qui représente l'évènement. Les valeurs 
passées dans cet évènement sont accessibles dans la propriété <code>detail</code> de cet argument :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">function</span><span class="pln"> fonction_a_appeler</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">"mes valeurs"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">event</span><span class="pun">.</span><span class="pln">detail</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<h2 is-upgraded="">Évènement personnalisé</h2>
<p>Appliquons ce que nous avons vu précédemment avec l'eventDispatcher à notre composant. Nous écoutons l'évènement <code>submit</code> du formulaire et envoyons un évènement personnalisé <code>sauvegarder</code>. Nous obtenons le code suivant :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  </span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> createEventDispatcher </span><span class="pun">}</span><span class="pln"> from </span><span class="str">'svelte'</span><span class="pun">;</span><span class="pln">

  </span><span class="kwd">const</span><span class="pln"> dispatch </span><span class="pun">=</span><span class="pln"> createEventDispatcher</span><span class="pun">();</span><span class="pln">
  </span><span class="kwd">export</span><span class="pln"> let taille </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1.8</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">export</span><span class="pln"> let poids </span><span class="pun">=</span><span class="pln"> </span><span class="lit">80</span><span class="pun">;</span><span class="pln">

  </span><span class="kwd">function</span><span class="pln"> handleSubmit</span><span class="pun">(</span><span class="pln">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    dispatch</span><span class="pun">(</span><span class="str">'sauvegarder'</span><span class="pun">,</span><span class="pln"> event</span><span class="pun">.</span><span class="pln">target</span><span class="pun">.</span><span class="pln">poids</span><span class="pun">.</span><span class="pln">value </span><span class="pun">/</span><span class="pln"> </span><span class="pun">(</span><span class="pln">event</span><span class="pun">.</span><span class="pln">target</span><span class="pun">.</span><span class="pln">taille</span><span class="pun">.</span><span class="pln">value </span><span class="pun">*</span><span class="pln"> event</span><span class="pun">.</span><span class="pln">target</span><span class="pun">.</span><span class="pln">taille</span><span class="pun">.</span><span class="pln">value</span><span class="pun">));</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;form</span><span class="pln"> </span><span class="atn">on:submit</span><span class="pun">=</span><span class="atv">{handleSubmit}</span><span class="tag">&gt;</span><span class="pln">
  </span><span class="tag">&lt;label&gt;</span><span class="pln"> Poids ({poids} kg) :
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"poids"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"10"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"200"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"5"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{poids}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/label&gt;</span><span class="pln">

  </span><span class="tag">&lt;label&gt;</span><span class="pln"> Taille ({taille.toFixed(2)} m) :
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"taille"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"0.5"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"2.5"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"0.01"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{taille}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/label&gt;</span><span class="pln">

  </span><span class="tag">&lt;button</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"submit"</span><span class="tag">&gt;</span><span class="pln">Sauvegarder</span><span class="tag">&lt;/button&gt;</span><span class="pln">
</span><span class="tag">&lt;/form&gt;</span></code></pre>
<p>Et dans le fichier <strong>ImcCalculator.svelte</strong>, nous pouvons réagir à l'évènement de la sorte :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  let taille </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1.8</span><span class="pun">;</span><span class="pln">
  let poids </span><span class="pun">=</span><span class="pln"> </span><span class="lit">80</span><span class="pun">;</span><span class="pln">

  </span><span class="kwd">function</span><span class="pln"> sauvegarderIMC</span><span class="pun">(</span><span class="pln">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">event</span><span class="pun">.</span><span class="pln">detail</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;Form</span><span class="pln"> </span><span class="atn">bind:poids</span><span class="pln"> </span><span class="atn">bind:taille</span><span class="pln"> </span><span class="atn">on:sauvegarder</span><span class="pun">=</span><span class="atv">{sauvegarderIMC}</span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;Imc</span><span class="pln"> {</span><span class="atn">taille</span><span class="pln">} {</span><span class="atn">poids</span><span class="pln">} </span><span class="tag">/&gt;</span></code></pre>
<p><em>Svelte</em> met à notre disposition une petite astuce pour nous 
simplifier la vie dans ce genre de situation. Nous pouvons transmettre 
directement un event envoyé par un élément au sein de notre composant à 
son parent.</p>
<p>Et la syntaxe est elle aussi très simple : <code>on:submit</code>.</p>
<p>C'est tout, rien de plus. Avec cette syntaxe, l'event "onSubmit" sera
 propagé et peut donc être écouté directement sur le composant parent <code>&lt;Form on:submit={sauvegarderIMC}/&gt;</code></p>
<p>Mais dans notre cas, cela n'est pas une bonne pratique, notre 
composant ne doit pas exposer directement l'évènement à son parent. Nous
 transformons l'événement natif en un nouvel évènement métier.</p>
<h2 is-upgraded="">Event modifier</h2>
<p>Une fois ce code implémenté, vous devriez remarquer que la page est 
rafraîchie à chaque fois que l'on clique sur le bouton, car le bouton 
envoie le formulaire.</p>
<p>Pour corriger cela, il est nécessaire en javascript d'appeler la fonction <code>preventDefault</code> sur l'objet <code>event</code> passé en paramètre de la fonction <code>handleSubmit</code>. Mais <em>Svelte</em> nous simplifie la vie en apportant une syntaxe pour ajouter des modifications à un évènement.</p>
<p>En ajoutant <code>|preventDefault</code> après le <code>on:submit</code>, <em>Svelte</em> va automatiquement exécuter le code <code>event.preventDefault()</code> avant d'appeler votre fonction :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;form</span><span class="pln"> </span><span class="atn">on:submit</span><span class="pln">|</span><span class="atn">preventDefault</span><span class="tag">&gt;</span></code></pre>
<aside class="special"><p><a href="https://svelte.dev/docs#on_element_event" target="_blank">D'autres modificateurs</a> sont disponibles : </p>
<ul>
<li><code>stopPropagation</code> : Exécute le code <code>event.stopPropagation()</code> qui permet de ne pas propager l'évènement sur les noeuds html parents.</li>
<li><code>once</code>: Se désabonne après avoir reçu un évènement.</li>
<li><code>self</code>: L'évènement n'est actif que si envoyé par l'élément DOM où l'on ajoute l'évènement.</li>
</ul>
</aside>
<h2 is-upgraded="">Afficher l'historique</h2>
<p>Ajoutons maintenant un tableau qui va contenir l'historique avec la date et l'IMC.</p>
<pre><code language="language-javascript" class="language-javascript"><span class="pln">  </span><span class="kwd">const</span><span class="pln"> historique </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[];</span><span class="pln">
  </span><span class="kwd">function</span><span class="pln"> sauvegarderIMC</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    historique</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">.</span><span class="pln">detail</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span></code></pre>
<p>Reste à ajouter le code pour afficher les résultats dans le html :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;h3&gt;</span><span class="pln">Evolution de l'IMC</span><span class="tag">&lt;/h3&gt;</span><span class="pln">
</span><span class="tag">&lt;ul&gt;</span><span class="pln">
	{#each historique as item, index}
		</span><span class="tag">&lt;li&gt;</span><span class="pln">{index + 1}: {item.toFixed(2)}</span><span class="tag">&lt;/li&gt;</span><span class="pln">
	{/each}
</span><span class="tag">&lt;/ul&gt;</span></code></pre>
<aside class="special"><p> La balise #each, permet de boucler sur un tableau, pour ensuite afficher chaque élément du tableau. </p>
</aside>
<p>En testant notre code, vous remarquerez que l'historique ne s'affiche pas en cliquant sur le bouton. C'est parce que <em>Svelte</em>
 utilise l'affectation d'une variable pour savoir quand une donnée est 
modifiée. Or lorsque l'on fait un push sur notre tableau, la variable 
n'est pas modifiée et donc <em>Svelte</em> ne détecte pas la modification. Utilisez alors la syntaxe de décomposition pour reconstruire un nouveau tableau :</p>
<pre><code language="language-javascription" class="language-javascription"><span class="pln">	</span><span class="kwd">function</span><span class="pln"> sauvegarderIMC</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		historique </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[...</span><span class="pln">historique</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">event</span><span class="pun">.</span><span class="pln">detail</span><span class="pun">];</span><span class="pln">
	</span><span class="pun">}</span></code></pre>


      </div></div></google-codelab-step><google-codelab-step label="Mise en place du store" duration="10" step="12"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">12. Mise en place du store</h2>
        <h2 is-upgraded="">Présentation</h2>
<p>La communication entre plusieurs composants via les attributs et les 
évènements peut vite devenir complexe dans une grosse application. Il 
est donc nécessaire de mettre en place un mécanisme pour partager des 
données entre les différents composants. Un pattern est maintenant très 
utilisé pour cela dans les applications front, c'est le concept de 
"store". L'idée est d'avoir un endroit où garder en mémoire à tout 
moment, l'état global de l'application.</p>
<p><em>Svelte</em> propose une implémentation de ce pattern en permettant d'écrire des stores. Il propose trois types de store :</p>
<ul>
<li><strong>writable</strong> : Cas le plus courant, un store qui est modifiable.</li>
<li><strong>readable</strong> : L'application ne peut que lire des 
données du store, mais pas écrire (sert pour accéder à des données 
venant d'une autre source et non modifié par l'application : api du 
navigateur, push serveur, temps ...).</li>
<li><strong>derived</strong> : Ce store observe d'autres stores et se met à jour en fonction des modifications de ces derniers.</li>
</ul>
<h2 is-upgraded="">Un store writable</h2>
<p>Un store <strong>writable</strong> est donc un object qui contient 
une valeur initiale, que nous pouvons ensuite mettre à jour, et 
s'abonner sur ces mises à jours :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> writable </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"svelte/store"</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> count </span><span class="pun">=</span><span class="pln"> writable</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">

count</span><span class="pun">.</span><span class="pln">subscribe</span><span class="pun">((</span><span class="pln">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">value</span><span class="pun">);</span><span class="pln">
</span><span class="pun">});</span><span class="pln"> </span><span class="com">// logs '0'</span><span class="pln">

count</span><span class="pun">.</span><span class="kwd">set</span><span class="pun">(</span><span class="lit">1</span><span class="pun">);</span><span class="pln"> </span><span class="com">// logs '1'</span><span class="pln">

count</span><span class="pun">.</span><span class="pln">update</span><span class="pun">((</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln"> </span><span class="com">// logs '2'</span></code></pre>
<h2 is-upgraded="">Créer un store pour stocker le poids et la taille</h2>
<p>Pour cela, créons un fichier javascript (il ne contient que du code, et pas de template, donc pas nécessaire d'avoir un fichier <em>Svelte</em>) <code>stores.js</code> dans le répertoire <code>src/lib</code> qui va contenir la création de nos deux stores pour stocker le poids et la taille :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> writable </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"svelte/store"</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">export</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> poids </span><span class="pun">=</span><span class="pln"> writable</span><span class="pun">(</span><span class="lit">80</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">export</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> taille </span><span class="pun">=</span><span class="pln"> writable</span><span class="pun">(</span><span class="lit">1.8</span><span class="pun">);</span></code></pre>
<p>Maintenant, nous pouvons modifier notre fichier <strong>Form.svelte</strong> pour utiliser notre store :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> poids</span><span class="pun">,</span><span class="pln"> taille </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"./stores"</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> onPoidsChange</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  poids</span><span class="pun">.</span><span class="kwd">set</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">.</span><span class="pln">target</span><span class="pun">.</span><span class="pln">value</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> onTailleChange</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  taille</span><span class="pun">.</span><span class="kwd">set</span><span class="pun">(</span><span class="pln">parseFloat</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">.</span><span class="pln">target</span><span class="pun">.</span><span class="pln">value</span><span class="pun">));</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<p>Nous allons repasser dans le premier mode de fonctionnement en s'abonnant directement sur les évènements des champs <code>poids</code> et <code>taille</code> et supprimer le bouton calculer.</p>
<p>Voici donc le code html du formulaire :</p>
<pre><code><span class="pln">   </span><span class="tag">&lt;form&gt;</span><span class="pln">
     </span><span class="tag">&lt;label&gt;</span><span class="pln"> Poids :
        </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"poids"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"10"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"200"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"5"</span><span class="pln"> </span><span class="atn">on:input</span><span class="pun">=</span><span class="atv">{onPoidsChange}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
     </span><span class="tag">&lt;/label&gt;</span><span class="pln">

     </span><span class="tag">&lt;label&gt;</span><span class="pln"> Taille :
        </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"taille"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"0.5"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"2.5"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"0.01"</span><span class="pln"> </span><span class="atn">on:input</span><span class="pun">=</span><span class="atv">{onTailleChange}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
     </span><span class="tag">&lt;/label&gt;</span><span class="pln">

    </span><span class="tag">&lt;button</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"submit"</span><span class="tag">&gt;</span><span class="pln">Sauvegarder</span><span class="tag">&lt;/button&gt;</span><span class="pln">
   </span><span class="tag">&lt;/form&gt;</span></code></pre>
<aside class="warning"><p> Remarquez que nous avons supprimé 
provisoirement l'affichage des valeurs dans le champ label, nous verrons
 plus tard comment afficher le contenu du store avec une syntaxe 
simplifiée. </p>
</aside>
<p>Dans le fichier <strong>Imc.svelte</strong> dans la balise <code>&lt;script&gt;</code>, ajoutons le code pour récupérer les valeurs du store :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> poids </span><span class="kwd">as</span><span class="pln"> storePoids</span><span class="pun">,</span><span class="pln"> taille </span><span class="kwd">as</span><span class="pln"> storeTaille </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"./stores"</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">let</span><span class="pln"> poids</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">let</span><span class="pln"> taille</span><span class="pun">;</span><span class="pln">

storePoids</span><span class="pun">.</span><span class="pln">subscribe</span><span class="pun">((</span><span class="pln">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">poids </span><span class="pun">=</span><span class="pln"> value</span><span class="pun">));</span><span class="pln">
storeTaille</span><span class="pun">.</span><span class="pln">subscribe</span><span class="pun">((</span><span class="pln">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">taille </span><span class="pun">=</span><span class="pln"> value</span><span class="pun">));</span><span class="pln">

$</span><span class="pun">:</span><span class="pln"> imc </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">poids </span><span class="pun">/</span><span class="pln"> taille </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span><span class="pun">).</span><span class="pln">toFixed</span><span class="pun">(</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
$</span><span class="pun">:</span><span class="pln"> thin </span><span class="pun">=</span><span class="pln"> imc </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">18</span><span class="pun">;</span><span class="pln">
$</span><span class="pun">:</span><span class="pln"> bold </span><span class="pun">=</span><span class="pln"> imc </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">25</span><span class="pun">;</span></code></pre>
<aside class="warning"><p> Attention, le subscribe retourne une fonction
 qui permet de se désabonner. Il faut donc stocker cette fonction dans 
une variable et utiliser le livecycle <code>onDestroy()</code> pour nettoyer les souscriptions et éviter les fuites mémoires. La syntaxe simplifiée s'en occupe automatiquement. </p>
</aside>
<p>De même le code de la page <em>ImcCalculator.svelte</em> est simplifié :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
	</span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Imc</span><span class="pln"> from </span><span class="str">"./Imc.svelte"</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Form</span><span class="pln"> from </span><span class="str">"./Form.svelte"</span><span class="pun">;</span><span class="pln">

	</span><span class="kwd">const</span><span class="pln"> name </span><span class="pun">=</span><span class="pln"> </span><span class="str">"world"</span><span class="pun">;</span><span class="pln">
  let historique </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[];</span><span class="pln">

	</span><span class="kwd">function</span><span class="pln"> sauvegarderIMC</span><span class="pun">(</span><span class="pln">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		historique </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[...</span><span class="pln">historique</span><span class="pun">,</span><span class="pln"> event</span><span class="pun">.</span><span class="pln">detail</span><span class="pun">];</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;main&gt;</span><span class="pln">
	</span><span class="tag">&lt;h1&gt;</span><span class="pln">Calculateur IMC</span><span class="tag">&lt;/h1&gt;</span><span class="pln">
	</span><span class="tag">&lt;p&gt;</span><span class="pln">Bonjour {name} ! Calculez votre IMC (Indice de Masse Corporelle)</span><span class="tag">&lt;/p&gt;</span><span class="pln">
  </span><span class="tag">&lt;Form</span><span class="pln"> </span><span class="atn">on:sauvegarder</span><span class="pun">=</span><span class="atv">{sauvegarderIMC}</span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;Imc</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;h3&gt;</span><span class="pln">Evolution de l'IMC</span><span class="tag">&lt;/h3&gt;</span><span class="pln">
  </span><span class="com">&lt;!-- [...] --&gt;</span><span class="pln">
</span><span class="tag">&lt;/main&gt;</span></code></pre>
<h2 is-upgraded="">Syntaxe simplifiée</h2>
<p>La syntaxe avec les méthodes <code>set</code> et <code>subscribe</code> n'est pas très pratique et lisible pour les développeurs. <em>Svelte</em> propose donc un mécanisme pour rendre ce code plus simple et lisible. Pour cela, on va encore utiliser la syntaxe <code>$</code>. Toute variable, précédé par un <code>$</code> sera utilisable comme une variable de base et se mettra à jour automatiquement :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> writable </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"svelte/store"</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> count </span><span class="pun">=</span><span class="pln"> writable</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">

$</span><span class="pun">:</span><span class="pln"> console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">$count</span><span class="pun">);</span><span class="pln">

$count </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> </span><span class="com">// logs '1'</span></code></pre>
<p>Cette syntaxe est également disponible dans le template :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"number"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{$count}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;p&gt;</span><span class="pln">Count : {$count}</span><span class="tag">&lt;/p&gt;</span></code></pre>
<aside class="special"><p><em>Svelte</em> propose des fonctions pour créer facilement des stores, mais tout object <code>Observable</code> (qui possède un subscribe, unsubscribe) est considéré par <em>Svelte</em> comme un store et peut utiliser la syntaxe réactive de <em>Svelte</em>. </p>
</aside>
<h2 is-upgraded="">Utiliser la syntaxe simplifiée dans notre application</h2>
<p>Grâce à la syntaxe simplifiée, nous pouvons avoir un template très simple en utilisant <code>$poids</code> et <code>$taille</code> comme si elles étaient de simple variables.</p>
<p>Dans le fichier <strong>Form.svelte</strong> :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
 </span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> poids</span><span class="pun">,</span><span class="pln"> taille </span><span class="pun">}</span><span class="pln"> from </span><span class="str">'./stores'</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;form&gt;</span><span class="pln">
  </span><span class="tag">&lt;label&gt;</span><span class="pln"> Poids ({$poids} kg) :
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"poids"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"10"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"200"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"5"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{$poids}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/label&gt;</span><span class="pln">

  </span><span class="tag">&lt;label&gt;</span><span class="pln"> Taille ({$taille.toFixed(2)} m) :
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"taille"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"0.5"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"2.5"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"0.01"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{$taille}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/label&gt;</span><span class="pln">
</span><span class="tag">&lt;/form&gt;</span></code></pre>
<p>Dans le fichier <strong>Imc.svelte</strong> :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
 </span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> poids</span><span class="pun">,</span><span class="pln"> taille </span><span class="pun">}</span><span class="pln"> from </span><span class="str">'./stores'</span><span class="pln">
  $</span><span class="pun">:</span><span class="pln"> imc </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">$poids </span><span class="pun">/</span><span class="pln"> $taille </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span><span class="pun">).</span><span class="pln">toFixed</span><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span><span class="pln">
  $</span><span class="pun">:</span><span class="pln"> thin </span><span class="pun">=</span><span class="pln"> imc </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">18</span><span class="pln">
  $</span><span class="pun">:</span><span class="pln"> bold </span><span class="pun">=</span><span class="pln"> imc </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">25</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class:thin</span><span class="pln"> </span><span class="atn">class:bold</span><span class="tag">&gt;</span><span class="pln">
  Votre IMC ({$poids}/{$taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {imc}
</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>Maintenant, il n'est plus nécessaire de faire passer les informations par le composant <code>ImcCalculator</code>. Nous pourrions également avoir d'autres composants qui utilisent ce store.</p>


      </div></div></google-codelab-step><google-codelab-step label="Store dérivé" duration="5" step="13"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">13. Store dérivé</h2>
        <p>En plus des stores simples <strong>writable</strong>, <em>Svelte</em> propose les stores <strong>derived</strong>,
 ce store se met à jour par la modification d'un ou plusieurs autres 
stores. Ce qui est notre cas, ici, le calcule de l'IMC est un dérivé des
 valeurs du poids et de la taille.</p>
<p>Ajoutons dans le fichier <code>stores.js</code>, ce nouveau store dérivé :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> derived</span><span class="pun">,</span><span class="pln"> writable </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"svelte/store"</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">export</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> poids </span><span class="pun">=</span><span class="pln"> writable</span><span class="pun">(</span><span class="lit">80</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">export</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> taille </span><span class="pun">=</span><span class="pln"> writable</span><span class="pun">(</span><span class="lit">1.8</span><span class="pun">);</span><span class="pln">

</span><span class="kwd">export</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> imc </span><span class="pun">=</span><span class="pln"> derived</span><span class="pun">([</span><span class="pln">poids</span><span class="pun">,</span><span class="pln"> taille</span><span class="pun">],</span><span class="pln"> </span><span class="pun">([</span><span class="pln">$poids</span><span class="pun">,</span><span class="pln"> $taille</span><span class="pun">])</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="pln">$poids </span><span class="pun">/</span><span class="pln"> $taille </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span><span class="pun">).</span><span class="pln">toFixed</span><span class="pun">(</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
</span><span class="pun">});</span></code></pre>
<p>Nous pouvons maintenant supprimer dans le fichier <strong>Imc.svelte</strong> la ligne qui calcule l'IMC est utiliser à la place la syntaxe simplifiée du store dérivée <code>$imc</code> :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  </span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> poids</span><span class="pun">,</span><span class="pln"> taille</span><span class="pun">,</span><span class="pln"> imc </span><span class="pun">}</span><span class="pln"> from </span><span class="str">'./stores'</span><span class="pln">

  $</span><span class="pun">:</span><span class="pln"> thin </span><span class="pun">=</span><span class="pln"> $imc </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">18</span><span class="pln">
  $</span><span class="pun">:</span><span class="pln"> bold </span><span class="pun">=</span><span class="pln"> $imc </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">25</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class:thin</span><span class="pln"> </span><span class="atn">class:bold</span><span class="tag">&gt;</span><span class="pln">
  Votre IMC ({$poids}/{$taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {$imc}
</span><span class="tag">&lt;/p&gt;</span></code></pre>


      </div></div></google-codelab-step><google-codelab-step label="Animation" duration="10" step="14"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">14. Animation</h2>
        <h2 is-upgraded="">Présentation</h2>
<p>Maintenant que nous avons une application finalisée, ajoutons quelques animations.</p>
<p><em>Svelte</em> permet d'ajouter facilement des animations, en 
plaçant simplement des attributs aux balises HTML pour, par exemple, 
ajouter une transition qui pourra s'exécuter à l'apparition ou la 
disparition d'un élément. La syntaxe est simple, nous indiquons la 
transition que l'on veut utiliser, préfixée par <code>in:</code> ou <code>out:</code>
 en fonction de si nous souhaitons jouer l'animation à l'apparition ou à
 la disparition de l'élément. Si la même transition est souhaitée à 
l'apparition et la disparition, il suffit d'utiliser le préfixe <code>transition:</code> à la place de <code>in:</code> et <code>out:</code>. Il existe 6 transitions proposées par défaut, mais il est possible de créer sa propre transition personnalisée.</p>
<ul>
<li><strong>fade</strong> : Change l'opacité de l'élément.</li>
<li><strong>blur</strong> : Applique un filtre de flou et change l'opacité.</li>
<li><strong>fly</strong> : Déplace l'élément et change l'opacité.</li>
<li><strong>slide</strong> : Masque ou affiche l'élément par un effet de slide.</li>
<li><strong>scale</strong> : Affiche ou masque l'élément en changeant sa taille.</li>
<li><strong>draw</strong> : Intéressant pour un SVG pour avoir un effet de dessin par un crayon.</li>
</ul>
<p>Il est bien sûr possible de passer des paramètres pour personnaliser 
les animations avec, par exemple, la durée de l'animation, ou la 
position initiale :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">in:fly</span><span class="pun">=</span><span class="atv">"{{ y: 200, duration: 2000 }}"</span><span class="pln"> </span><span class="atn">out:fade</span><span class="tag">&gt;</span></code></pre>
<h2 is-upgraded="">Le mettre en place</h2>
<p>Ajoutons maintenant des animations sur les textes qui s'affichent en fonction de la valeur de l'IMC.</p>
<p>Les animations sont à importer depuis <code>'svelte/transition'</code>. Dans le fichier <strong>Imc.svelte</strong>, nous aurons :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  </span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> poids</span><span class="pun">,</span><span class="pln"> taille</span><span class="pun">,</span><span class="pln"> imc </span><span class="pun">}</span><span class="pln"> from </span><span class="str">'./stores'</span><span class="pln">
  </span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> fly</span><span class="pun">,</span><span class="pln"> fade </span><span class="pun">}</span><span class="pln"> from </span><span class="str">'svelte/transition'</span><span class="pun">;</span><span class="pln">

  $</span><span class="pun">:</span><span class="pln"> thin </span><span class="pun">=</span><span class="pln"> $imc </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">18</span><span class="pln">
  $</span><span class="pun">:</span><span class="pln"> bold </span><span class="pun">=</span><span class="pln"> $imc </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">25</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class:thin</span><span class="pln"> </span><span class="atn">class:bold</span><span class="tag">&gt;</span><span class="pln">
  Votre IMC ({$poids}/{$taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {$imc}
</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{#if thin}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"souspoids"</span><span class="pln"> </span><span class="atn">in:fly</span><span class="pun">=</span><span class="atv">"{{ y: 200, duration: 2000 }}"</span><span class="pln"> </span><span class="atn">out:fade</span><span class="tag">&gt;</span><span class="pln">
    Vous êtes maigre
  </span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else if bold}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"surpoids"</span><span class="pln"> </span><span class="atn">in:fly</span><span class="pun">=</span><span class="atv">"{{ y: 200, duration: 2000 }}"</span><span class="pln"> </span><span class="atn">out:fade</span><span class="tag">&gt;</span><span class="pln">
    Vous êtes en surpoids
  </span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"normal"</span><span class="pln"> </span><span class="atn">in:fly</span><span class="pun">=</span><span class="atv">"{{ y: 200, duration: 2000 }}"</span><span class="pln"> </span><span class="atn">out:fade</span><span class="tag">&gt;</span><span class="pln">
    Vous êtes svelte !
  </span><span class="tag">&lt;/p&gt;</span><span class="pln">
{/if}</span></code></pre>


      </div></div></google-codelab-step><google-codelab-step label="Modifier le titre de la page" duration="5" step="15"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">15. Modifier le titre de la page</h2>
        <p><em>Svelte</em> met à disposition une collection d'<a href="https://svelte.dev/docs#svelte_self" target="_blank">éléments spéciaux</a> qui nous donnent accès à des éléments déjà existant dans le DOM tel que la balise <code>head</code> ou <code>body</code>. Mais également à l'objet <code>window</code> pour l'ajout d'events.</p>
<p>Nous pouvons manipuler cela en modifiant le composant <code>Imc</code> pour qu'il mette à jour le titre de la page avec la valeur calculée de l'IMC.</p>
<p>Pour cela, utilisons l'élément spécial <code>&lt;svelte:head&gt;</code> :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  </span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> poids</span><span class="pun">,</span><span class="pln"> taille</span><span class="pun">,</span><span class="pln"> imc </span><span class="pun">}</span><span class="pln"> from </span><span class="str">'./stores'</span><span class="pln">
  </span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> fly</span><span class="pun">,</span><span class="pln"> fade </span><span class="pun">}</span><span class="pln"> from </span><span class="str">'svelte/transition'</span><span class="pun">;</span><span class="pln">

  $</span><span class="pun">:</span><span class="pln"> thin </span><span class="pun">=</span><span class="pln"> $imc </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">18</span><span class="pln">
  $</span><span class="pun">:</span><span class="pln"> bold </span><span class="pun">=</span><span class="pln"> $imc </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">25</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;svelte:head&gt;</span><span class="pln">
  </span><span class="tag">&lt;title&gt;</span><span class="pln">Votre IMC : {$imc}</span><span class="tag">&lt;/title&gt;</span><span class="pln">
</span><span class="tag">&lt;/svelte:head&gt;</span><span class="pln">

</span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class:thin</span><span class="pln"> </span><span class="atn">class:bold</span><span class="tag">&gt;</span><span class="pln">
  Votre IMC ({$poids}/{$taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {$imc}
</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{#if thin}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"souspoids"</span><span class="pln"> </span><span class="atn">in:fly</span><span class="pun">=</span><span class="atv">"{{ y: 200, duration: 2000 }}"</span><span class="pln"> </span><span class="atn">out:fade</span><span class="tag">&gt;</span><span class="pln">
    Vous êtes maigre
  </span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else if bold}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"surpoids"</span><span class="pln"> </span><span class="atn">in:fly</span><span class="pun">=</span><span class="atv">"{{ y: 200, duration: 2000 }}"</span><span class="pln"> </span><span class="atn">out:fade</span><span class="tag">&gt;</span><span class="pln">
    Vous êtes en surpoids
  </span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"normal"</span><span class="pln"> </span><span class="atn">in:fly</span><span class="pun">=</span><span class="atv">"{{ y: 200, duration: 2000 }}"</span><span class="pln"> </span><span class="atn">out:fade</span><span class="tag">&gt;</span><span class="pln">
    Vous êtes svelte !
  </span><span class="tag">&lt;/p&gt;</span><span class="pln">
{/if}</span></code></pre>
<p>L'ajout de ce code permet à <em>Svelte</em> de venir modifier la balise <code>title</code> de notre page à chaque fois que le composant est inclus dans notre page. L'inclusion de <code>{$imc}</code> dans le titre permet également la mise à jour du titre lorsque la valeur du store <code>imc</code> change.</p>


      </div></div></google-codelab-step><google-codelab-step label="SvelteKit" duration="10" step="16"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">16. SvelteKit</h2>
        <p>Maintenant que nous avons fait le tour des principales fonctionnalités offertes par <em>Svelte</em>, passons à la vitesse supérieure en découvrant <em>SvelteKit</em>.</p>
<p>SvelteKit est un framework, basé sur <em>Svelte</em>, permettant de construire des sites ultra performants en intégrant notament les fonctionnalités suivantes :</p>
<ul>
<li>Un router</li>
<li>Une api avec de nouvelles fonctionnalités</li>
<li>De la génération de pages côté serveur</li>
<li>Une optimisation au build</li>
</ul>
<p>SvelteKit est le remplaçant du framework Sapper.</p>
<aside class="warning"><p><em>SvelteKit</em> n'est pas encore en version
 finale, mais son développement est suffisamment avancé pour s'y 
intéresser, et pourquoi pas l'utiliser en production (cependant, 
attention aux breaking changes !). </p>
</aside>
<p>SvelteKit utilise le bundler <code>vite</code> qui apporte la fonctionnalité de Hot Module Replacement (Recharge le code modifié sans même recharger la page).</p>
<p>La force de <em>SvelteKit</em>  c'est de profiter de la puissance du 
compilateur svelte qui va générer tout le code nécessaire (et seulement 
celui-ci) pour faire fonctionner votre site et d'y ajouter tout 
l'outillage nécessaire facilitant la construction d'applications web 
complexes.</p>
<h2 is-upgraded="">Créer un projet SvelteKit</h2>
<aside class="warning"><p> Votre code est déjà un projet sveltekit, il n'est pas nécessaire de recréer un projet pour continuer le projet. </p>
</aside>
<p>Même si vous avez déjà un projet <em>SvelteKit</em> grâce au template de projet. La création d'un projet <em>Svelte</em>
 est simplifiée par une CLI pour créer un projet qui va vous poser un 
certain nombre de questions pour choisir les options que vous voulez 
intégrer.</p>
<pre><code language="language-sh" class="language-sh"><span class="pln">npm init svelte@next </span><span class="kwd">my</span><span class="pun">-</span><span class="pln">app
cd </span><span class="kwd">my</span><span class="pun">-</span><span class="pln">app
npm install
npm run dev</span></code></pre>
<p>Voici la sortie de la console pour la création d'un projet :</p>
<pre><code><span class="pln">$ npm init svelte@next </span><span class="kwd">my</span><span class="pun">-</span><span class="pln">app
</span><span class="typ">Need</span><span class="pln"> to install the following packages</span><span class="pun">:</span><span class="pln">
  create</span><span class="pun">-</span><span class="pln">svelte@next
</span><span class="typ">Ok</span><span class="pln"> to proceed</span><span class="pun">?</span><span class="pln"> </span><span class="pun">(</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> 

create</span><span class="pun">-</span><span class="pln">svelte version </span><span class="lit">2.0</span><span class="pun">.</span><span class="lit">0</span><span class="pun">-</span><span class="kwd">next</span><span class="pun">.</span><span class="lit">98</span><span class="pln">

</span><span class="typ">Welcome</span><span class="pln"> to </span><span class="typ">SvelteKit</span><span class="pln"> 

</span><span class="typ">This</span><span class="pln"> </span><span class="kwd">is</span><span class="pln"> beta software</span><span class="pun">;</span><span class="pln"> expect bugs </span><span class="kwd">and</span><span class="pln"> missing features</span><span class="pun">.</span><span class="pln">

</span><span class="typ">Problems</span><span class="pun">?</span><span class="pln"> </span><span class="typ">Open</span><span class="pln"> an issue on https</span><span class="pun">:</span><span class="com">//github.com/sveltejs/kit/issues if none exists already.</span><span class="pln">

</span><span class="pun">✔</span><span class="pln"> </span><span class="typ">Which</span><span class="pln"> </span><span class="typ">Svelte</span><span class="pln"> app </span><span class="kwd">template</span><span class="pun">?</span><span class="pln"> </span><span class="pun">›</span><span class="pln"> </span><span class="typ">_SvelteKit_</span><span class="pln"> demo app
</span><span class="pun">✔</span><span class="pln"> </span><span class="typ">Use</span><span class="pln"> </span><span class="typ">TypeScript</span><span class="pun">?</span><span class="pln"> </span><span class="pun">...</span><span class="pln"> </span><span class="typ">No</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="typ">Yes</span><span class="pln">
</span><span class="pun">✔</span><span class="pln"> </span><span class="typ">Add</span><span class="pln"> </span><span class="typ">ESLint</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> code linting</span><span class="pun">?</span><span class="pln"> </span><span class="pun">...</span><span class="pln"> </span><span class="typ">No</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="typ">Yes</span><span class="pln">
</span><span class="pun">✔</span><span class="pln"> </span><span class="typ">Add</span><span class="pln"> </span><span class="typ">Prettier</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> code formatting</span><span class="pun">?</span><span class="pln"> </span><span class="pun">...</span><span class="pln"> </span><span class="typ">No</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="typ">Yes</span><span class="pln">

</span><span class="typ">Your</span><span class="pln"> project </span><span class="kwd">is</span><span class="pln"> ready</span><span class="pun">!</span><span class="pln">

</span><span class="typ">Install</span><span class="pln"> community</span><span class="pun">-</span><span class="pln">maintained integrations</span><span class="pun">:</span><span class="pln">
  https</span><span class="pun">:</span><span class="com">//github.com/svelte-add/svelte-adders</span><span class="pln">

</span><span class="typ">Next</span><span class="pln"> steps</span><span class="pun">:</span><span class="pln">
  </span><span class="lit">1</span><span class="pun">:</span><span class="pln"> cd </span><span class="kwd">my</span><span class="pun">-</span><span class="pln">app
  </span><span class="lit">2</span><span class="pun">:</span><span class="pln"> npm install </span><span class="pun">(</span><span class="kwd">or</span><span class="pln"> pnpm install</span><span class="pun">,</span><span class="pln"> etc</span><span class="pun">)</span><span class="pln">
  </span><span class="lit">3</span><span class="pun">:</span><span class="pln"> git init </span><span class="pun">&amp;&amp;</span><span class="pln"> git add </span><span class="pun">-</span><span class="pln">A </span><span class="pun">&amp;&amp;</span><span class="pln"> git commit </span><span class="pun">-</span><span class="pln">m </span><span class="str">"Initial commit"</span><span class="pln"> </span><span class="pun">(</span><span class="pln">optional</span><span class="pun">)</span><span class="pln">
  </span><span class="lit">4</span><span class="pun">:</span><span class="pln"> npm run dev </span><span class="pun">--</span><span class="pln"> </span><span class="pun">--</span><span class="pln">open

</span><span class="typ">To</span><span class="pln"> close the dev server</span><span class="pun">,</span><span class="pln"> hit </span><span class="typ">Ctrl</span><span class="pun">-</span><span class="pln">C

</span><span class="typ">Stuck</span><span class="pun">?</span><span class="pln"> </span><span class="typ">Visit</span><span class="pln"> us at https</span><span class="pun">:</span><span class="com">//svelte.dev/chat</span></code></pre>
<h2 is-upgraded="">Un framework sans runtime</h2>
<p>Si vous regardez dans votre package.json, vous n'aurez que des dépendances de dev et aucune dépendance runtime :</p>
<pre><code language="language-json" class="language-json"><span class="pun">{</span><span class="pln">
  </span><span class="str">"name"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"become-svelte"</span><span class="pun">,</span><span class="pln">
  </span><span class="str">"version"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"0.0.1"</span><span class="pun">,</span><span class="pln">
  </span><span class="str">"scripts"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="str">"dev"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"svelte-kit dev"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"build"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"svelte-kit build"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"package"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"svelte-kit package"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"preview"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"svelte-kit preview"</span><span class="pln">
  </span><span class="pun">},</span><span class="pln">
  </span><span class="str">"devDependencies"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="str">"@sveltejs/adapter-auto"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"next"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"@sveltejs/adapter-netlify"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"^1.0.0-next.38"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"@sveltejs/kit"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"next"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"netlify-cli"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"^8.6.20"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"svelte"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"^3.44.0"</span><span class="pln">
  </span><span class="pun">},</span><span class="pln">
  </span><span class="str">"type"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"module"</span><span class="pln">
</span><span class="pun">}</span></code></pre>


      </div></div></google-codelab-step><google-codelab-step label="Ajouter une nouvelle page" duration="5" step="17"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">17. Ajouter une nouvelle page</h2>
        <p>Créons une page <code>about.svelte</code> dans le répertoire <code>src/routes</code>. Ajoutons-y un texte spécifiant l'auteur du site :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;p&gt;</span><span class="pln">
Ce site a été créé par xxx lors de Devoxx France 2022
</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>La page est maintenant automatiquement disponible sur l'url <a href="http://localhost:3000/about" target="_blank">http://localhost:3000/about</a></p>


      </div></div></google-codelab-step><google-codelab-step label="Ajouter un layout" duration="5" step="18"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">18. Ajouter un layout</h2>
        <p>Il est aussi possible d'avoir un layout commun à toutes les pages en créant un fichier <code>__layout.svelte</code> dans le répertoire <code>src/routes</code>.</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">
</span><span class="tag">&lt;header&gt;</span><span class="pln">
	</span><span class="tag">&lt;h1&gt;</span><span class="pln">Devenir Svelte avec Svelte</span><span class="tag">&lt;/h1&gt;</span><span class="pln">
	</span><span class="tag">&lt;nav&gt;</span><span class="pln">
		</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/"</span><span class="tag">&gt;</span><span class="pln">Accueil</span><span class="tag">&lt;/a&gt;</span><span class="pln">
		</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/about"</span><span class="tag">&gt;</span><span class="pln">A propos</span><span class="tag">&lt;/a&gt;</span><span class="pln">
	</span><span class="tag">&lt;/nav&gt;</span><span class="pln">
</span><span class="tag">&lt;/header&gt;</span><span class="pln">
</span><span class="tag">&lt;main&gt;</span><span class="pln">
	</span><span class="tag">&lt;slot&gt;&lt;/slot&gt;</span><span class="pln">
</span><span class="tag">&lt;/main&gt;</span></code></pre>
<aside class="special"><p> La syntaxe <code>slot</code> permet d'indiquer à <em>Svelte</em>
 d'insérer à cet emplacement le contenu qui est ajouté entre les balises
 permettant d'utiliser le composant. Ici, les différentes pages seront 
affichées. </p>
</aside>


      </div></div></google-codelab-step><google-codelab-step label="Ajouter une page de recette" duration="10" step="19"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">19. Ajouter une page de recette</h2>
        <p>Il est possible d'avoir des sous-pages en créant un répertoire dans le dossier <code>src/routes</code>.</p>
<p>Nous allons ajouter sur notre site une page listant des recettes de cuisine, permettant ensuite d'avoir le détail de la recette.</p>
<p>Créons un répertoire <code>recettes</code> dans <code>src/routes</code>.</p>
<p>Ensuite, en ajoutant une page <code>index.svelte</code> dans ce répertoire, nous définissons la page qui s'affichera pour l'url <code>/recettes</code>.</p>
<h2 is-upgraded="">Liste des recettes</h2>
<p>Pour la suite, nous avons besoin d'une liste de recettes de cuisine. 
Dans un premier temps, nous allons créer cette liste de recettes dans 
une fichier json. Ajoutons une page <code>recettes.json</code> dans le répertoire <code>src/route/recettes</code> avec les recettes suivantes :</p>
<pre><code language="language-json" class="language-json"><span class="pun">[</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="str">"name"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"Tomates farcies au thon (recette légère)"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"image"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"https://assets.afcdn.com/recipe/20130616/20057_w1200h911c1cx256cy192.jpeg"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"totalTime"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">20</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"budget"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"difficulty"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"tags"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="str">"Entrée"</span><span class="pun">],</span><span class="pln">
        </span><span class="str">"people"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">4</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"ingredients"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="str">"4 tomates"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1/2 cc de moutarde"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"citron"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1 cc d'herbe de provence"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1 cs d'huile d'olive"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"poivre"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"sel"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"2 boites de thon au naturel"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"120g de crème fraiche allégée"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1 échalotte hachée"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"basilique frais"</span><span class="pun">],</span><span class="pln">
        </span><span class="str">"steps"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="pln">
            </span><span class="str">"Découper un chapeau dans le haut de chaque tomate préalablement lavée."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Evider les tomates à l'aide d'une cuillère, saler légèrement l'intérieur et les retourner sur une grille afin qu'elles s'égouttent."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Mélanger la crème, la moutarde et le reste ingrédients avant d'y ajouter le thon égoutté en miettes."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Bien mélanger le tout."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Remplir chaque tomate de cette farce. Y ajouter les feuilles de basilic pour la présentation et le goût!"</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"A servir frais, disposés sur un lit de feuilles de salade."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Bon appétit."</span><span class="pln">
        </span><span class="pun">],</span><span class="pln">
        </span><span class="str">"credit"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"https://www.marmiton.org/recettes/recette_tomates-farcies-au-thon-recette-legere_81846.aspx"</span><span class="pln">
    </span><span class="pun">},</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="str">"name"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"Dahl de lentilles corail"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"image"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"https://assets.afcdn.com/recipe/20200928/114451_w1200h1877c1cx540cy844cxb1080cyb1689.jpeg"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"totalTime"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">30</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"budget"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"difficulty"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"people"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">4</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"tags"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="str">"Plat"</span><span class="pun">],</span><span class="pln">
        </span><span class="str">"ingredients"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="str">"30 cl de lentilles corail"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"5 tomates"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"4 carottes"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"25cl de lait de coco"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1 gousse d'ail"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1 cs de concentré de tomates"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1 cc de curcuma"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1/2 cc de cumin"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1/2 cc de gemgembre"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1/2 cc d'huile de tournesol"</span><span class="pun">],</span><span class="pln">
        </span><span class="str">"steps"</span><span class="pun">:[</span><span class="pln">
            </span><span class="str">"Laver les tomates et les découper en dés. Peler les carottes, et les découper en fines rondelles."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Dans une casserole, verser les lentilles corail et couvrir d'eau. Porter à ébullition. Laisser cuire pendant 10 min environ, jusqu'à complète absorption de l'eau. Retire du feu et laisser reposer."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Dans une sauteuse, verser l'huile et chauffer. Y ajouter l'ail qui dorera pendant une petite minute. Verser ensuite les légumes et saupoudrer avec les épices. Ajouter enfin le concentré de tomate."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Verser le lait de coco et laisser mijoter environ 10 min. sans couvrir."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Enfin, ajouter les lentilles et bien remuer le tout."</span><span class="pln">
        </span><span class="pun">],</span><span class="pln">
        </span><span class="str">"credit"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"https://www.marmiton.org/recettes/recette_dahl-de-lentilles-corail_166862.aspx"</span><span class="pln">
    </span><span class="pun">},</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="str">"name"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"Dessert léger aux fruits de la passion"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"image"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"https://assets.afcdn.com/recipe/20170204/34670_w1200h911c1cx331cy290.jpeg"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"totalTime"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">35</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"budget"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"difficulty"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"people"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">6</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"tags"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="str">"Dessert"</span><span class="pun">],</span><span class="pln">
        </span><span class="str">"ingredients"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="str">"1/2 l de lait"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"2 sachet de sucre vanille"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"75g de sucre"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"50g de farine"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1 mangue"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"8 fruits de la passion"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"4 oeufs"</span><span class="pun">],</span><span class="pln">
        </span><span class="str">"steps"</span><span class="pun">:[</span><span class="pln">
            </span><span class="str">"Couper la mangue en petits morceaux, et vider les fruits de la passion."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Mélanger délicatement les fruits ensemble, et les disposer dans le fond d'un plat assez creux (type grand saladier). Réserver."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Préparer une crème patissière :"</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"faire bouillir 1/2 l de lait avec les 2 sachets de sucre vanillé."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Pendant ce temps, mélanger 3 jaunes d oeufs avec le sucre. On doit obtenir un mélange lisse."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Rajouter la farine, et remuer énergiquement (pâte onctueuse)."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Incorporer le lait et mélanger. Remettre le tout sur le feu (feux doux), et laisser epaissir la crème sans s'arrêter de tourner. Laisser refroidir."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Une fois que la crème pâtissière a refroidi, la mettre sur les fruits dans le saladier."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Battre 4 blancs en neige, et en recouvrir les fruits et la crème patissière."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Mettre le saladier 3 min au grill, pour faire dorer les blancs en neige. Laisser refroidir, et conserver au frigo avant de servir."</span><span class="pln">
        </span><span class="pun">],</span><span class="pln">
        </span><span class="str">"credit"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"https://www.marmiton.org/recettes/recette_dessert-leger-aux-fruits-de-la-passion_43479.aspx"</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">]</span></code></pre>
<h2 is-upgraded="">Afficher la liste des recettes</h2>
<p>Pour afficher ces recettes, nous avons juste à importer dans notre page <em>Svelte</em> le fichier json créé précédemment.</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
    </span><span class="kwd">import</span><span class="pln"> recettes from </span><span class="str">"./recettes.json"</span><span class="pun">;</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<p>Nous pouvons ensuite parcourir la liste pour afficher les différentes recettes :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;section</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"recettes"</span><span class="tag">&gt;</span><span class="pln">
    {#each recettes as item, index (item.name)}
        </span><span class="tag">&lt;article&gt;</span><span class="pln">
            </span><span class="tag">&lt;div&gt;</span><span class="pln">
              </span><span class="tag">&lt;h2&gt;</span><span class="pln">{item.name}</span><span class="tag">&lt;/h2&gt;</span><span class="pln">
              </span><span class="tag">&lt;p&gt;</span><span class="pln">⏱ {item.totalTime} min 👨‍🍳 {['', 'Très Facile', 'Facile', 'Moyenne', 'Difficile'][item.difficulty || 0]} € {['', 'Bon marché', 'Moyen', 'Assez cher'][item.budget||0]} 😋 {item.people} Personnes</span><span class="tag">&lt;/p&gt;</span><span class="pln">
            </span><span class="tag">&lt;/div&gt;</span><span class="pln">
            </span><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">{item.image}</span><span class="pln"> </span><span class="atn">alt</span><span class="pun">=</span><span class="atv">{item.name}</span><span class="tag">&gt;</span><span class="pln">
        </span><span class="tag">&lt;/article&gt;</span><span class="pln">
    {/each}
</span><span class="tag">&lt;/section&gt;</span></code></pre>
<aside class="special"><p> La syntaxe <code>{#each recettes as item (item.name)}{/each}</code>
 permet d'itérer sur un tableau pour afficher une liste en créant une 
variable item pour réccupérer l'élément en cours lors de l'itération. Le
 <code>(item.name)</code> permet d'indiquer la clé de notre élément et ainsi permettre d'optimiser le rendu si l'élément DOM existe déjà. </p>
</aside>
<p>N'oublions pas d'ajouter le lien permettant d'accéder à cette nouvelle page dans le fichier de layout :</p>
<pre><code language="language-html" class="language-html"><span class="pln">	</span><span class="tag">&lt;nav&gt;</span><span class="pln">
		</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/"</span><span class="tag">&gt;</span><span class="pln">Accueil</span><span class="tag">&lt;/a&gt;</span><span class="pln">
		</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/recettes"</span><span class="tag">&gt;</span><span class="pln">Recettes</span><span class="tag">&lt;/a&gt;</span><span class="pln">
		</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/about"</span><span class="tag">&gt;</span><span class="pln">A propos</span><span class="tag">&lt;/a&gt;</span><span class="pln">
	</span><span class="tag">&lt;/nav&gt;</span></code></pre>


      </div></div></google-codelab-step><google-codelab-step label="Afficher une page de détail" duration="10" step="20"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">20. Afficher une page de détail</h2>
        <p>Créons maintenant une page <code>[id].svelte</code> qui sera appelée par les url <code>/recettes/1</code> ou <code>recettes/2</code> par exemple. La variable <code>id</code> sera alors disponible directement dans la page avec la valeur passée en paramètre.</p>
<p>Pour récupérer les parametres <em>SvelteKit</em> fournit un <strong>store </strong><code>page</code> depuis <code>$app/stores</code> qui permet de récupérer les parametres et autres informations sur la page :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> page </span><span class="pun">}</span><span class="pln"> from </span><span class="str">'$app/stores'</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> recettes from </span><span class="str">"./recettes.json"</span><span class="pun">;</span><span class="pln">

let recette </span><span class="pun">=</span><span class="pln"> recettes</span><span class="pun">[</span><span class="pln">$page</span><span class="pun">.</span><span class="pln">params</span><span class="pun">.</span><span class="pln">id</span><span class="pun">]</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<p>Maintenant affichons le détail d'une recette :</p>
<pre><code language="language-svletehtml" class="language-svletehtml"><span class="tag">&lt;section</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"recette"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">{recette.image}</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;h2&gt;</span><span class="pln">{recette.name}</span><span class="tag">&lt;/h2&gt;</span><span class="pln">
    </span><span class="tag">&lt;h3&gt;</span><span class="pln">⏱ {recette.totalTime} min 👨‍🍳 {['', 'Très Facile', 'Facile', 'Moyenne', 'Difficile'][recette.difficulty || 0]} € {['', 'Bon marché', 'Moyen', 'Assez cher'][recette.budget||0]} 😋 {recette.people} Personnes</span><span class="tag">&lt;/h3&gt;</span><span class="pln">
    
    </span><span class="tag">&lt;ul&gt;</span><span class="pln">
        {#each recette?.ingredients as ingredient}
            </span><span class="tag">&lt;li&gt;</span><span class="pln">{ingredient}</span><span class="tag">&lt;/li&gt;</span><span class="pln">
        {/each}
    </span><span class="tag">&lt;/ul&gt;</span><span class="pln">
    </span><span class="tag">&lt;dl&gt;</span><span class="pln">
        {#each recette?.steps as step, index}
            </span><span class="tag">&lt;dt&gt;</span><span class="pln">Etape {index+1}</span><span class="tag">&lt;/dt&gt;</span><span class="pln">
            </span><span class="tag">&lt;dd&gt;</span><span class="pln">{step}</span><span class="tag">&lt;/dd&gt;</span><span class="pln">
        {/each}
    </span><span class="tag">&lt;/dl&gt;</span><span class="pln">
</span><span class="tag">&lt;/section&gt;</span></code></pre>
<aside class="special"><p> La syntaxe <code>{#each recettes as item, index}{/each}</code> permet de récupérer l'index courant du tableau dans la variable `index`. </p>
</aside>
<h2 is-upgraded="">Ajoutons un lien</h2>
<p>Sur la page de recette, il est maintenant nécessaire d'ajouter un lien vers la page de détail.</p>
<p>Pour cela récupérons l'index de la recette et ajoutons simplement une ligne vers <code>/recettes/{index}</code> comme ceci :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="pln">    </span><span class="pun">{#</span><span class="pln">each recettes </span><span class="kwd">as</span><span class="pln"> item</span><span class="pun">,</span><span class="pln"> index </span><span class="pun">(</span><span class="pln">item</span><span class="pun">.</span><span class="pln">name</span><span class="pun">)}</span><span class="pln">
        </span><span class="str">&lt;article&gt;</span><span class="pln">
            </span><span class="str">&lt;div&gt;</span><span class="pln">
                </span><span class="str">&lt;h2&gt;</span><span class="pun">&lt;</span><span class="pln">a href</span><span class="pun">=</span><span class="str">"/recettes/{index}"</span><span class="pun">&gt;{</span><span class="pln">item</span><span class="pun">.</span><span class="pln">name</span><span class="pun">}&lt;</span><span class="str">/a&gt;&lt;/</span><span class="pln">h2</span><span class="pun">&gt;</span></code></pre>
<p><em>Svelte</em> va automatiquement gérer la navigation de la page vers la page de détail sans rechargement.</p>
<aside class="special"><p> Par défaut, _Svelte_ va intercepter les clics
 sur les liens `a` pour ne pas recharger la page sur les urls internes. 
Si besoin, nous pouvons désactiver ce comportement en ajoutant 
l'attribut `rel="external"` sur le lien. </p>
</aside>
<h2 is-upgraded="">Changement de page dynamique</h2>
<p>Ajoutons en bas de la page de détail, des liens pour naviguer automatiquement à la recette suivante ou précédente :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;nav</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"recette-nav"</span><span class="tag">&gt;</span><span class="pln">
	{#if $page.params.id &gt; 0}
	</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/recettes/{Number($page.params.id) - 1}"</span><span class="tag">&gt;</span><span class="pln">Précédent</span><span class="tag">&lt;/a&gt;</span><span class="pln">
	{/if}
	{#if $page.params.id &lt; 2}
	</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/recettes/{Number($page.params.id) + 1}"</span><span class="tag">&gt;</span><span class="pln">Suivant</span><span class="tag">&lt;/a&gt;</span><span class="pln">
	{/if}
</span><span class="tag">&lt;/nav&gt;</span></code></pre>
<p>Testons maintenant ce lien. Nous remarquons que le changement de page ne fonctionne pas, la page ne réagit pas.</p>
<p>La récupération du paramètre dans le store de la page est une notion 
dite "réactive". Le composant de la page n'est pas réinitilisé lorsque 
nous changeons simplement un paramètre de la page.</p>
<p>Pour que notre navigation fonctionne, il est donc nécessaire d'utiliser la syntaxe de réactivité de <em>Svelte</em> pour récupérer la bonne recette :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="pln">$</span><span class="pun">:</span><span class="pln"> recette </span><span class="pun">=</span><span class="pln"> recettes</span><span class="pun">[</span><span class="pln">$page</span><span class="pun">.</span><span class="kwd">params</span><span class="pun">.</span><span class="pln">id</span><span class="pun">]</span></code></pre>


      </div></div></google-codelab-step><google-codelab-step label="Accessibilité" duration="5" step="21"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">21. Accessibilité</h2>
        <p>Peut-être l'avez vous remarqué, lors de la création de la page affichant une recette, <em>Svelte</em>
 nous a indiqué via un warning dans le terminal, d'un problème 
d'accessibilité dans notre code. (Si vous utiliser un plugin dans l'IDE,
 l'erreur est également affichée).</p>
<pre><code><span class="lit">17</span><span class="pun">:</span><span class="lit">47</span><span class="pun">:</span><span class="lit">21</span><span class="pln"> </span><span class="pun">[</span><span class="pln">vite</span><span class="pun">-</span><span class="pln">plugin</span><span class="pun">-</span><span class="pln">svelte</span><span class="pun">]</span><span class="pln"> become</span><span class="pun">-</span><span class="pln">svelte</span><span class="pun">/</span><span class="pln">src</span><span class="pun">/</span><span class="pln">routes</span><span class="pun">/</span><span class="pln">recettes</span><span class="pun">/[</span><span class="pln">id</span><span class="pun">].</span><span class="pln">svelte</span><span class="pun">:</span><span class="lit">9</span><span class="pun">:</span><span class="lit">4</span><span class="pln">
A11y</span><span class="pun">:</span><span class="pln"> </span><span class="str">&lt;img&gt;</span><span class="pln"> element should have an alt attribute</span></code></pre>
<p>Ce warning nous indique que nous n'avons pas mis d'attribut <code>alt</code> à notre balise <code>img</code>.</p>
<p>Pour corriger ceci, renseignons par exemple l'attribut <code>alt</code> comme ceci :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">{recette.image}</span><span class="pln"> </span><span class="atn">alt</span><span class="pun">=</span><span class="atv">"Photo de la recette {recette.name}"</span><span class="tag">&gt;</span></code></pre>
<p>Retrouvez dans la <a href="https://svelte.dev/docs#accessibility-warnings" target="_blank">documentation</a>, la liste des erreurs d'accessibilité prises en compte.</p>


      </div></div></google-codelab-step><google-codelab-step label="Ajouter du code serveur" duration="10" step="22"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">22. Ajouter du code serveur</h2>
        <p>L'import d'un fichier json dans notre page inclut directement
 ce fichier dans le code javascript et est donc chargé dès que l'on 
affiche notre site. Si la liste de recettes grossie, les performances de
 notre site seront impactées.</p>
<p>La force de <em>SvelteKit</em>  c'est aussi de permettre d'écrire du code front et back au même endroit, sans distinction.</p>
<p>Un fichier au format <code>.svelte</code> sera affiché dans le front, alors qu'un fichier au format <code>.js</code> (ou <code>.ts</code> si nous utilisons TypeScript) sera alors executé côté serveur.</p>
<p>Lorsque nous ajoutons une extension juste avant le <code>.js</code>, alors l'url prendra en compte cette dernière pour définir le type du fichier. Par exemple, le fichier <code>recettes.json.js</code>
 sera alors accessible par l'url ‘/recettes.json'. Il est conseillé 
d'utiliser ce type d'extesion si nos pages et notre API se trouvent 
exactement au même endroit. Sinon ,entre le fichier <code>recettes.svelte</code> ou <code>recettes.js</code>, <em>SvelteKit</em> appellera en priorité le fichier <code>.js</code>.</p>
<h2 is-upgraded="">/recettes.json</h2>
<p>Développons maintenant une API pour récupérer les recettes, et ne pas
 importer l'intégralité de notre fichier json dans nos pages html.</p>
<p>Pour ce faire, commencons par créer une page <code>index.json.js</code> dans le répertoire <code>src/route/recettes</code></p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> recettes </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"./recettes.json"</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">export</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="kwd">get</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        body</span><span class="pun">:</span><span class="pln"> recettes</span><span class="pun">.</span><span class="pln">map</span><span class="pun">(({</span><span class="pln"> ingredients</span><span class="pun">,</span><span class="pln"> steps</span><span class="pun">,</span><span class="pln"> credit</span><span class="pun">,</span><span class="pln"> </span><span class="pun">...</span><span class="pln">rest </span><span class="pun">})</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> rest</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<p>Pour écrire le code serveur, nous ajoutons et exportons une fonction du nom de la méthode http que nous voulons gérer (ici GET).</p>
<p>La fonction doit retourner un objet avec les propriétés suivantes :</p>
<ul>
<li>status : Status HTTP de la réponse, si celui-ci n'est pas indiqué, indique le status 200.</li>
<li>headers : Si nous voulons indiquer des headers. À ajouter soit sous la forme d'une liste de string ou d'un objet clé/valeur.</li>
<li>body : Si le body est de type <code>object</code> et que nous n'avons pas donné de contentType dans les headers, alors l'objet est automatiquement transformé en json.</li>
</ul>
<p>Nous avons maintenant une URL <a href="http://localhost:3000/recettes.json" target="_blank">/recettes.json</a> qui retourne notre liste de recettes (auxquelles nous avons supprimé les propriétés ingredients et steps).</p>
<h2 is-upgraded="">/recettes/1.json</h2>
<p>Ajoutons maintenant une API pour récupérer une recette selon son <code>id</code>. Pour cela créons une page <code>[id].json.js</code> dans le répertoire <code>src/route/recettes</code>.</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> recettes </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"./recettes.json"</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">export</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="kwd">get</span><span class="pun">({</span><span class="pln"> </span><span class="kwd">params</span><span class="pln"> </span><span class="pun">})</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        body</span><span class="pun">:</span><span class="pln"> recettes</span><span class="pun">[</span><span class="kwd">params</span><span class="pun">.</span><span class="pln">id</span><span class="pun">]</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<p>La fonction exportée, est appelée avec un argument qui contient les informations suivantes :</p>
<ul>
<li>request : L'objet request de node avec toutes les informations qu'il contient (headers, queryParams, body, ...).</li>
<li>url : L'url de la page.</li>
<li>params : Une map avec les paramètres de la page (les paramètres entre [] dans le nom du fichier).</li>
</ul>
<p>Nous avons maintenant une URL <a href="http://localhost:3000/recettes/0.json" target="_blank">/recettes/0.json</a> qui retourne la première recette de notre liste.</p>


      </div></div></google-codelab-step><google-codelab-step label="Utiliser notre API" duration="10" step="23"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">23. Utiliser notre API</h2>
        <p>Il est maintenant nécessaire de modifier nos page svelte pour utiliser notre API.</p>
<p>Ce code doit être executé également côté serveur lors du server side rendering, il est donc nécessaire d'utiliser la balise <code>&lt;script context="module"&gt;</code>.</p>
<p>Sveltekit permet d'écrire une fonction nommée <code>load</code> qui 
va s'executer lors du chargement de la page. Cette fonction peut 
retourner un objet props qui contient les paramètres que l'on veut faire
 passer à notre page qui possède alors une propriété en entrée du 
composant (via <code>export let propname;</code>).</p>
<h2 is-upgraded="">Page des recettes</h2>
<p>Remplaçons dans la page <code>index.svelte</code>, la balise script par le code suivant :</p>
<pre><code><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">context</span><span class="pun">=</span><span class="atv">"module"</span><span class="tag">&gt;</span><span class="pln">
	</span><span class="com">/** @type {import('@sveltejs/kit').Load} */</span><span class="pln">
	</span><span class="kwd">export</span><span class="pln"> async </span><span class="kwd">function</span><span class="pln"> load</span><span class="pun">({</span><span class="pln"> fetch </span><span class="pun">})</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">const</span><span class="pln"> url </span><span class="pun">=</span><span class="pln"> </span><span class="pun">`/</span><span class="pln">recettes</span><span class="pun">.</span><span class="pln">json</span><span class="pun">`;</span><span class="pln">
		</span><span class="kwd">const</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> await fetch</span><span class="pun">(</span><span class="pln">url</span><span class="pun">);</span><span class="pln">

		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">res</span><span class="pun">.</span><span class="pln">ok</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				props</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
					recettes</span><span class="pun">:</span><span class="pln"> await res</span><span class="pun">.</span><span class="pln">json</span><span class="pun">()</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
			</span><span class="pun">};</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">

		</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			status</span><span class="pun">:</span><span class="pln"> res</span><span class="pun">.</span><span class="pln">status</span><span class="pun">,</span><span class="pln">
			error</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Error</span><span class="pun">(`</span><span class="typ">Could</span><span class="pln"> not load $</span><span class="pun">{</span><span class="pln">url</span><span class="pun">}`)</span><span class="pln">
		</span><span class="pun">};</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">
</span><span class="tag">&lt;script&gt;</span><span class="pln">
    </span><span class="kwd">export</span><span class="pln"> let recettes </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[];</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<h2 is-upgraded="">Page détail d'une recette</h2>
<p>Remplaçons la balise <code>script</code> par le code suivant :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">context</span><span class="pun">=</span><span class="atv">"module"</span><span class="tag">&gt;</span><span class="pln">
	</span><span class="com">/** @type {import('@sveltejs/kit').Load} */</span><span class="pln">
	</span><span class="kwd">export</span><span class="pln"> async </span><span class="kwd">function</span><span class="pln"> load</span><span class="pun">({</span><span class="pln"> params</span><span class="pun">,</span><span class="pln"> fetch </span><span class="pun">})</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">const</span><span class="pln"> url </span><span class="pun">=</span><span class="pln"> </span><span class="pun">`/</span><span class="pln">recettes</span><span class="pun">/</span><span class="pln">$</span><span class="pun">{</span><span class="pln">params</span><span class="pun">.</span><span class="pln">id</span><span class="pun">}.</span><span class="pln">json</span><span class="pun">`;</span><span class="pln">
		</span><span class="kwd">const</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> await fetch</span><span class="pun">(</span><span class="pln">url</span><span class="pun">);</span><span class="pln">

		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">res</span><span class="pun">.</span><span class="pln">ok</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				props</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
					recette</span><span class="pun">:</span><span class="pln"> await res</span><span class="pun">.</span><span class="pln">json</span><span class="pun">()</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
			</span><span class="pun">};</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">

		</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			status</span><span class="pun">:</span><span class="pln"> res</span><span class="pun">.</span><span class="pln">status</span><span class="pun">,</span><span class="pln">
			error</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Error</span><span class="pun">(`</span><span class="typ">Could</span><span class="pln"> not load $</span><span class="pun">{</span><span class="pln">url</span><span class="pun">}`)</span><span class="pln">
		</span><span class="pun">};</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">
</span><span class="tag">&lt;script&gt;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> page </span><span class="pun">}</span><span class="pln"> from </span><span class="str">'$app/stores'</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">export</span><span class="pln"> let recette</span><span class="pun">;</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<p>La fonction <code>load</code>, permet de récupérer plusieurs éléments :</p>
<ul>
<li>url : Url de la page.</li>
<li>params : Les paramètres de la page (paramètres entre [] dans le nom du fichier).</li>
<li>fetch : Fonction pour faire des appels http, identique à fetch 
natif, sauf qu'il gère le fait d'être appelé côté serveur ou côté client
 (enregistre le retour de l'appel côté server pour le serialiser dans le
 code de la page et réutiliser la valeur côté client).</li>
<li>session : Donnée de session qui est accessible côté serveur et côté client.</li>
<li>stuff : Donnée que l'on réucupère depuis le layout.</li>
</ul>
<p>La méthode retourne un objet avec les propriétés suivantes :</p>
<ul>
<li>status : Status HTTP de la page.</li>
<li>error : Si la fonction load a une erreur (status doit alors est de type 4xx ou 5xx)</li>
<li>redirect : Pour rediriger vers une autre page (status doit être de type 3xx)</li>
<li>maxage : indique la durée de mise en cache de la page</li>
<li>props : les informations que l'on passe au composant de la page lors de son affichage</li>
<li>stuff : informations qui est passé aux sous-pages (que l'on récupère ensuite dans les paramètres de la fonction load)</li>
</ul>


      </div></div></google-codelab-step><google-codelab-step label="SSR" duration="5" step="24"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">24. SSR</h2>
        <p>Le serveur side rendering permet de générer le code html sur 
le serveur avant d'envoyer le résultat directement au navigateur. 
L'intérêt est d'améliorer les performances de la page, car il suffit 
alors au navigateur d'afficher le resultat sans devoir construire toute 
la page.</p>
<p>Ce fonctionnement est automatique et disponible par défaut. <em>Svelte</em>
 côté serveur va générer un état de la page qui sera alors utilisé par 
le code javascript côté front pour s'initialiser et ainsi pouvoir 
ajouter l'interaction automatiquement.</p>
<p>Si vous regarder le code source d'une page, vous y verrez alors la totalité du html qui est généré :</p>
<pre><code language="language-html" class="language-html"><span class="dec">&lt;!DOCTYPE html&gt;</span><span class="pln">
</span><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">lang</span><span class="pun">=</span><span class="atv">"en"</span><span class="tag">&gt;</span><span class="pln">
	</span><span class="tag">&lt;head&gt;</span><span class="pln">
		</span><span class="tag">&lt;meta</span><span class="pln"> </span><span class="atn">charset</span><span class="pun">=</span><span class="atv">"utf-8"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
		</span><span class="tag">&lt;meta</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"description"</span><span class="pln"> </span><span class="atn">content</span><span class="pun">=</span><span class="atv">""</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
		</span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"icon"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"./favicon.png"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
		</span><span class="tag">&lt;link</span><span class="pln">
			</span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://fonts.googleapis.com/css2?family=Fredoka+One&amp;display=swap"</span><span class="pln">
			</span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"stylesheet"</span><span class="pln">
		</span><span class="tag">/&gt;</span><span class="pln">
		</span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"stylesheet"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"./global.css"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
		</span><span class="tag">&lt;meta</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"viewport"</span><span class="pln"> </span><span class="atn">content</span><span class="pun">=</span><span class="atv">"width=device-width, initial-scale=1"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
		</span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"stylesheet"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/_app/assets/start-61d1577b.css"</span><span class="tag">&gt;</span><span class="pln">
		</span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"modulepreload"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/_app/start-53bce2a1.js"</span><span class="tag">&gt;</span><span class="pln">
		</span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"modulepreload"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/_app/chunks/vendor-fa2d59c6.js"</span><span class="tag">&gt;</span><span class="pln">
		</span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"modulepreload"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/_app/pages/__layout.svelte-d673c1f6.js"</span><span class="tag">&gt;</span><span class="pln">
		</span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"modulepreload"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/_app/pages/recettes/index.svelte-7cee68ff.js"</span><span class="tag">&gt;</span><span class="pln">
		</span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"modulepreload"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/_app/chunks/recette-6ce5406e.js"</span><span class="tag">&gt;</span><span class="pln">
		</span><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"module"</span><span class="tag">&gt;</span><span class="pln">
			</span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> start </span><span class="pun">}</span><span class="pln"> from </span><span class="str">"/_app/start-53bce2a1.js"</span><span class="pun">;</span><span class="pln">
			start</span><span class="pun">({</span><span class="pln">
				target</span><span class="pun">:</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">querySelector</span><span class="pun">(</span><span class="str">"#svelte"</span><span class="pun">),</span><span class="pln">
				paths</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str">"base"</span><span class="pun">:</span><span class="str">""</span><span class="pun">,</span><span class="str">"assets"</span><span class="pun">:</span><span class="str">""</span><span class="pun">},</span><span class="pln">
				session</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{},</span><span class="pln">
				route</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln">
				spa</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln">
				trailing_slash</span><span class="pun">:</span><span class="pln"> </span><span class="str">"never"</span><span class="pun">,</span><span class="pln">
				hydrate</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
					status</span><span class="pun">:</span><span class="pln"> </span><span class="lit">200</span><span class="pun">,</span><span class="pln">
					error</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">,</span><span class="pln">
					nodes</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="pln">
						</span><span class="kwd">import</span><span class="pun">(</span><span class="str">"/_app/pages/__layout.svelte-d673c1f6.js"</span><span class="pun">),</span><span class="pln">
						</span><span class="kwd">import</span><span class="pun">(</span><span class="str">"/_app/pages/recettes/index.svelte-7cee68ff.js"</span><span class="pun">)</span><span class="pln">
					</span><span class="pun">],</span><span class="pln">
					url</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URL</span><span class="pun">(</span><span class="str">"https://become-svelte.patou.dev/recettes"</span><span class="pun">),</span><span class="pln">
					params</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
			</span><span class="pun">});</span><span class="pln">
		</span><span class="tag">&lt;/script&gt;</span><span class="pln">
	</span><span class="tag">&lt;/head&gt;</span><span class="pln">
	</span><span class="tag">&lt;body&gt;</span><span class="pln">
		</span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"svelte"</span><span class="tag">&gt;</span><span class="pln">
      </span><span class="tag">&lt;header&gt;&lt;h1&gt;</span><span class="pln">Devenir Svelte avec Svelte</span><span class="tag">&lt;/h1&gt;</span><span class="pln">
      </span><span class="tag">&lt;nav&gt;&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/"</span><span class="tag">&gt;</span><span class="pln">Accueil</span><span class="tag">&lt;/a&gt;</span><span class="pln">
        </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/recettes"</span><span class="tag">&gt;</span><span class="pln">Recettes</span><span class="tag">&lt;/a&gt;</span><span class="pln">
        </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/about"</span><span class="tag">&gt;</span><span class="pln">A propos</span><span class="tag">&lt;/a&gt;&lt;/nav&gt;&lt;/header&gt;</span><span class="pln">
        </span><span class="tag">&lt;main&gt;&lt;section</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"recettes"</span><span class="tag">&gt;&lt;article&gt;&lt;h2&gt;&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/recettes/0"</span><span class="tag">&gt;</span><span class="pln">Tomates farcies au thon (recette légère)</span><span class="tag">&lt;/a&gt;&lt;/h2&gt;</span><span class="pln">
            </span><span class="tag">&lt;h3&gt;</span><span class="pln">⏱ 20 min 👨‍🍳 Très facile € Bon marché 😋 4 Personnes</span><span class="tag">&lt;/h3&gt;</span><span class="pln">
            </span><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"https://assets.afcdn.com/recipe/20130616/20057_w1200h911c1cx256cy192.jpeg"</span><span class="pln"> </span><span class="atn">alt</span><span class="pun">=</span><span class="atv">"Tomates farcies au thon (recette légère)"</span><span class="tag">&gt;</span><span class="pln">
        </span><span class="tag">&lt;/article&gt;&lt;article&gt;&lt;h2&gt;&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/recettes/1"</span><span class="tag">&gt;</span><span class="pln">Dahl de lentilles corail</span><span class="tag">&lt;/a&gt;&lt;/h2&gt;</span><span class="pln">
            </span><span class="tag">&lt;h3&gt;</span><span class="pln">⏱ 30 min 👨‍🍳 Facile € Bon marché 😋 4 Personnes</span><span class="tag">&lt;/h3&gt;</span><span class="pln">
            </span><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"https://assets.afcdn.com/recipe/20200928/114451_w1200h1877c1cx540cy844cxb1080cyb1689.jpeg"</span><span class="pln"> </span><span class="atn">alt</span><span class="pun">=</span><span class="atv">"Dahl de lentilles corail"</span><span class="tag">&gt;</span><span class="pln">
        </span><span class="tag">&lt;/article&gt;&lt;article&gt;&lt;h2&gt;&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/recettes/2"</span><span class="tag">&gt;</span><span class="pln">Dessert léger aux fruits de la passion</span><span class="tag">&lt;/a&gt;&lt;/h2&gt;</span><span class="pln">
            </span><span class="tag">&lt;h3&gt;</span><span class="pln">⏱ 35 min 👨‍🍳 Facile € Bon marché 😋 6 Personnes</span><span class="tag">&lt;/h3&gt;</span><span class="pln">
            </span><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"https://assets.afcdn.com/recipe/20170204/34670_w1200h911c1cx331cy290.jpeg"</span><span class="pln"> </span><span class="atn">alt</span><span class="pun">=</span><span class="atv">"Dessert léger aux fruits de la passion"</span><span class="tag">&gt;</span><span class="pln">
        </span><span class="tag">&lt;/article&gt;&lt;/section&gt;&lt;/main&gt;</span><span class="pln">
    </span><span class="tag">&lt;/div&gt;</span><span class="pln">
	</span><span class="tag">&lt;/body&gt;</span><span class="pln">
</span><span class="tag">&lt;/html&gt;</span></code></pre>
<p>De même, nous remarquons aussi du code javascript qui indique quel 
est l'état de la page pour que le javascript puisse se démarrer et se 
positionner dans l'état où la page a été créé.</p>
<p>Si nous regardons les appels http, et que nous ouvrons directement une page de recette : <a href="http://localhost:3000/recettes/0" target="_blank">http://localhost:3000/recettes/0</a>, nous remarquons qu'aucun appel à l'url <a href="http://localhost:3000/recettes/0.json" target="_blank">http://localhost:3000/recettes/0.json</a> n'est fait. Si nous cliquons sur le lien <code>Suivant</code>, l'url <a href="http://localhost:3000/recettes/1.json" target="_blank">http://localhost:3000/recettes/1.json</a> est chargée.</p>
<h2 is-upgraded="">Prefetch</h2>
<p>SvelteKit va essayer de précharger au maximum les pages et les 
ressources. Si nous voulons permettre de précharger une page disponible 
derrière un lien (au survol de celui-ci), il suffit d'ajouter <code>sveltekit:prefetch</code> sur une balise html <code>&lt;a&gt;</code>.</p>
<p>Dans le fichier <code>index.svelte</code> du répertoire <code>src/routes</code>, modifions le lien vers les pages de recettes :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;h2&gt;&lt;a</span><span class="pln"> </span><span class="atn">sveltekit:prefetch</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/recettes/{index}"</span><span class="tag">&gt;</span><span class="pln">{item.name}</span><span class="tag">&lt;/a&gt;&lt;/h2&gt;</span></code></pre>
<p>Maintenant en regardant les requettes http, nous pouvons voir que l'url <code>/recettes/x.json</code>
 sera préchargée au survol du lien, avant même de cliquer sur celui-ci. 
La page s'affichera ensuite immédiatement après un clic sur le lien.</p>


      </div></div></google-codelab-step><google-codelab-step label="Testing" duration="10" step="25"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">25. Testing</h2>
        <p>À présent, penchons nous un peu sur la partie testing. Nous allons voir comment nous pouvons tester nos composants <em>Svelte</em>.</p>
<h2 is-upgraded="">Configuration</h2>
<p>Pour écrire des tests dans notre application, nous allons utiliser <a href="https://jestjs.io/fr/" target="_blank">jest</a> et la  <a href="https://testing-library.com/docs/svelte-testing-library/intro" target="_blank">Svelte Testing Library</a> .</p>
<h3 is-upgraded="">jest, svelte-jester &amp; babel</h3>
<p>Commençons par installer <a href="https://jestjs.io/fr/" target="_blank">jest</a>, ainsi que <a href="https://github.com/svelteness/svelte-jester" target="_blank">svelte-jester</a> qui va nous permettre de tester nos composants Svelte et <a href="https://babeljs.io/" target="_blank">babel</a> pour pouvoir utiliser les modules es6.</p>
<pre><code language="language-sh:" class="language-sh:"><span class="pln">npm install </span><span class="pun">--</span><span class="pln">save</span><span class="pun">-</span><span class="pln">dev jest svelte</span><span class="pun">-</span><span class="pln">jester babel</span><span class="pun">-</span><span class="pln">jest </span><span class="lit">@babel</span><span class="pun">/</span><span class="pln">preset</span><span class="pun">-</span><span class="pln">env</span></code></pre>
<p>Ensuite, nous pouvons ajouter les scripts suivants dans le <code>package.json</code> pour pouvoir lancer les tests :</p>
<pre><code language="language-json" class="language-json"><span class="pln">  </span><span class="str">"test"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"jest src"</span><span class="pun">,</span><span class="pln">
  </span><span class="str">"test:watch"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"npm run test -- --watch"</span></code></pre>
<p>Toujours dans le fichier <code>package.json</code>, configurons jest en ajoutant les lignes suivantes :</p>
<pre><code language="language-json" class="language-json"><span class="pln"> </span><span class="str">"jest"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
   </span><span class="str">"testEnvironment"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"jsdom"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"transform"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="str">"^.+\\.js$"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"babel-jest"</span><span class="pun">,</span><span class="pln">
      </span><span class="str">"^.+\\.svelte$"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"svelte-jester"</span><span class="pln">
    </span><span class="pun">},</span><span class="pln">
    </span><span class="str">"moduleFileExtensions"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="pln">
      </span><span class="str">"js"</span><span class="pun">,</span><span class="pln">
      </span><span class="str">"svelte"</span><span class="pln">
    </span><span class="pun">]</span><span class="pln">
  </span><span class="pun">}</span></code></pre>
<p>Configurons à présent babel en ajoutant à la racine du projet un nouveau fichier <code>.babelrc</code> :</p>
<pre><code language="language-json" class="language-json"><span class="pun">{</span><span class="pln">
    </span><span class="str">"presets"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[[</span><span class="str">"@babel/preset-env"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="str">"targets"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str">"node"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"current"</span><span class="pun">}}]]</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<h3 is-upgraded="">@testing-library/svelte</h3>
<p>Nous allons maintenant installer <a href="https://testing-library.com/docs/svelte-testing-library/intro" target="_blank">@testing-library/svelte</a>.</p>
<pre><code language="language-shell" class="language-shell"><span class="pln">npm install </span><span class="pun">--</span><span class="pln">save</span><span class="pun">-</span><span class="pln">dev </span><span class="lit">@testing</span><span class="pun">-</span><span class="pln">library</span><span class="pun">/</span><span class="pln">svelte </span><span class="lit">@testing</span><span class="pun">-</span><span class="pln">library</span><span class="pun">/</span><span class="pln">jest</span><span class="pun">-</span><span class="pln">dom</span></code></pre>
<p>La configuration des outils nécessaires aux tests est terminée. Passons à la création des tests.</p>
<h2 is-upgraded="">Création des tests</h2>
<p>Pour découvrir comment tester des composants <em>Svelte</em>, nous allons créer des tests sur le composant <code>Imc</code>.</p>
<h3 is-upgraded="">Premier test</h3>
<p>Commençons par créer notre fichier de test à côté du fichier <code>Imc.svelte</code> : <code>Imc.test.js</code>.</p>
<p>Pour le premier test, nous allons chercher à valider le fait que 
l'imc est bien calculé avec les valeurs par défaut de l'application.</p>
<p>Dans le fichier <code>Imc.svelte</code>, nous allons ajouter un identifiant de test <code>data-testid="imc"</code>sur la balise <code></code></p><p> affichant l'imc. Cela va nous permettre de sélectionner cette balise dans le DOM pour récupérer son contenu.</p>
<pre><code language="language-html" class="language-html"><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class:thin</span><span class="pln"> </span><span class="atn">class:bold</span><span class="pln"> </span><span class="atn">data-testid</span><span class="pun">=</span><span class="atv">"imc"</span><span class="tag">&gt;</span><span class="pln">
  Votre IMC ({$poids}/{$taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {$imc}
</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>Ensuite, nous pouvons écrire notre test dans le fichier <code>Imc.test.js</code> :</p>
<pre><code language="language-js" class="language-js"><span class="kwd">import</span><span class="pln"> </span><span class="str">'@testing-library/jest-dom'</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> render </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">'@testing-library/svelte'</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Imc</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">'./Imc'</span><span class="pln">

describe</span><span class="pun">(</span><span class="str">'Imc'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    it</span><span class="pun">(</span><span class="str">'should display default imc'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="com">// Chargement du composant.</span><span class="pln">
        </span><span class="kwd">const</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> getByTestId </span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> render</span><span class="pun">(</span><span class="typ">Imc</span><span class="pun">)</span><span class="pln">
        </span><span class="com">// Sélectionne le &lt;p&gt; affichant l'Imc et récupère le contenu textuel.</span><span class="pln">
        </span><span class="kwd">const</span><span class="pln"> displayImc </span><span class="pun">=</span><span class="pln"> getByTestId</span><span class="pun">(</span><span class="str">'imc'</span><span class="pun">).</span><span class="pln">textContent</span><span class="pun">;</span><span class="pln">
        </span><span class="com">// Le texte attendu, avec l'imc calculé grâce aux valeurs par défaut.</span><span class="pln">
        </span><span class="kwd">const</span><span class="pln"> expectedImc </span><span class="pun">=</span><span class="pln"> </span><span class="str">'Votre IMC (80/1.82) est de 24.69'</span><span class="pun">;</span><span class="pln">
        </span><span class="com">// La vérification.</span><span class="pln">
        expect</span><span class="pun">(</span><span class="pln">displayImc</span><span class="pun">).</span><span class="pln">toBe</span><span class="pun">(</span><span class="pln">expectedImc</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">});</span><span class="pln">
</span><span class="pun">});</span></code></pre>
<p>Maintenant, nous pouvons lancer le test et vérifier que ce dernier passe correctement.</p>
<pre><code language="language-sh" class="language-sh"><span class="pln">npm run test</span></code></pre>
<h3 is-upgraded="">Second test</h3>
<p>Un second test que nous pouvons ajouter ici est la vérification de l'affichage de l'indicateur <code>Vous êtes svelte !</code> avec l'imc par défaut.</p>
<pre><code language="language-js" class="language-js"><span class="pln">    it</span><span class="pun">(</span><span class="str">'should display the right health indicator'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">const</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> getByText </span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> render</span><span class="pun">(</span><span class="typ">Imc</span><span class="pun">);</span><span class="pln">
        expect</span><span class="pun">(</span><span class="pln">getByText</span><span class="pun">(</span><span class="str">'Vous êtes svelte !'</span><span class="pun">)).</span><span class="pln">toBeInTheDocument</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">});</span></code></pre>
<p>L'idée n'étant d'être exhaustif sur les tests du composant <code>Imc</code>,
 nous allons nous arrêter là pour la partie testing. Si vous souhaitez 
aller un peu plus loin, vous pourrez ajouter d'autres tests pour tester 
les autres états du composant. Référez vous à la documention de <a href="https://testing-library.com/docs/svelte-testing-library/intro" target="_blank">@testing-library/svelte</a> et de <a href="https://jestjs.io/fr/" target="_blank">jest</a> pour vous aider.</p>


      </div></div></google-codelab-step><google-codelab-step label="Déployer l'application" duration="10" step="26"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">26. Déployer l'application</h2>
        <p>Pour déployer l'application créée sur un serveur, il est 
nécessaire d'installer un "adapter". Cet adapter va transformer le code 
pour générer le code statique et le code dynamique et les confirgurer en
 fonction de la plateforme cible.</p>
<h2 is-upgraded="">Application node</h2>
<p>Installer l'adapter :</p>
<pre><code language="language-shell" class="language-shell"><span class="pln">npm install </span><span class="pun">-</span><span class="pln">d </span><span class="lit">@sveltejs</span><span class="pun">/</span><span class="pln">adapter</span><span class="pun">-</span><span class="pln">node@next</span></code></pre>
<p>Puis dans le fichier svelte.config.js modifier l'import de l'adapter par :</p>
<pre><code language="language-js" class="language-js"><span class="kwd">import</span><span class="pln"> adapter </span><span class="kwd">from</span><span class="pln"> </span><span class="str">'@sveltejs/adapter-node'</span><span class="pun">;</span></code></pre>
<p>Il est aussi possible passer des paramètres à l'adapter :</p>
<pre><code language="language-js" class="language-js"><span class="kwd">import</span><span class="pln"> adapter </span><span class="kwd">from</span><span class="pln"> </span><span class="str">'@sveltejs/adapter-node'</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">export</span><span class="pln"> </span><span class="kwd">default</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	kit</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		adapter</span><span class="pun">:</span><span class="pln"> adapter</span><span class="pun">({</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">:</span><span class="pln"> </span><span class="str">'my-output-directory'</span><span class="pln"> </span><span class="pun">})</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">};</span><span class="pln">
</span></code></pre>
<h2 is-upgraded="">Application static</h2>
<p>Si votre application n'a pas de code coté serveur, il est possible 
d'avoir un adapter qui va générer un site statique (uniquement du html 
et du javascript).</p>
<p>Pour cela, il suffit d'installer l'adapter <code>@sveltejs/adapter-static</code>.</p>
<p>Le site peut alors être déployé sur n'importe quel serveur http.</p>
<h2 is-upgraded="">Déployer l'application sur netlify</h2>
<p>Netlify permet d'avoir un site avec des fichiers statiques mais aussi
 des fonctions javascript permettant d'éxecuter votre application back 
ou le prérendu html de votre front.</p>
<p>Installer l'adapter :</p>
<pre><code language="language-shell" class="language-shell"><span class="pln">npm install </span><span class="pun">-</span><span class="pln">d </span><span class="lit">@sveltejs</span><span class="pun">/</span><span class="pln">adapter</span><span class="pun">-</span><span class="pln">netlify@next</span></code></pre>
<p>Puis modifiez le fichier de configuration svelte.config.js :</p>
<pre><code language="language-js" class="language-js"><span class="kwd">import</span><span class="pln"> adapter </span><span class="kwd">from</span><span class="pln"> </span><span class="str">'@sveltejs/adapter-netlify'</span><span class="pun">;</span><span class="pln">

</span><span class="com">/** @type {import('@sveltejs/kit').Config} */</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> config </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	kit</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		adapter</span><span class="pun">:</span><span class="pln"> adapter</span><span class="pun">({</span><span class="pln">
			split</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pln">
		</span><span class="pun">}),</span><span class="pln">

		</span><span class="com">// hydrate the &lt;div id="svelte"&gt; element in src/app.html</span><span class="pln">
		target</span><span class="pun">:</span><span class="pln"> </span><span class="str">'#svelte'</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">};</span><span class="pln">

</span><span class="kwd">export</span><span class="pln"> </span><span class="kwd">default</span><span class="pln"> config</span><span class="pun">;</span></code></pre>
<p>Créer ensuite un fichier netlify.toml pour indiquer à netlify comment constuire votre application et la publier</p>
<pre><code language="language-properties" class="language-properties"><span class="pun">[</span><span class="pln">build</span><span class="pun">]</span><span class="pln">
  command </span><span class="pun">=</span><span class="pln"> </span><span class="str">"npm run build"</span><span class="pln">
  publish </span><span class="pun">=</span><span class="pln"> </span><span class="str">"build"</span></code></pre>
<h3 is-upgraded="">Déployer directement depuis git</h3>
<p>Sauvegardez votre site sur un repos github, gitlab, ou bitbucket.</p>
<p>Allez directement sur https://app.netlify.com/start</p>
<p>Connectez vous avec votre compte github, gitlab ou bitbucket, et 
selectionnez votre projet. Netlify va automatiquement s'abonner à votre 
projet git et mettera alors automatiquement à jour votre site sur 
netlify</p>
<h3 is-upgraded="">Déployer de manière manuel</h3>
<p>Si vous voulez déployer sur netlify depuis votre CI, netlify fournit 
une ligne de commande qui permet de deployer quand vous voulez votre 
projet.</p>
<p>Documentation : <a href="https://docs.netlify.com/cli/get-started/" target="_blank">https://docs.netlify.com/cli/get-started/</a></p>


      </div></div></google-codelab-step><google-codelab-step label="Ajouter une recherche de recette sur Marmiton (Bonus)" duration="15" step="27"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">27. Ajouter une recherche de recette sur Marmiton (Bonus)</h2>
        <p>Ajoutons maintenant un formulaire de recherche pour rechercher des recettes sur le site marmiton.org.</p>
<p>Une bibliothèque apporte une API pour faire une recherche sur le site marmiton.org : https://www.npmjs.com/package/marmiton-api</p>
<h2 is-upgraded="">Ajouter la lib</h2>
<p>Ajoutons cette dépendance sur le projet :</p>
<pre><code language="language-shell" class="language-shell"><span class="pln">npm install marmiton</span><span class="pun">-</span><span class="pln">api</span></code></pre>
<h2 is-upgraded="">API de recherche</h2>
<p>Il faut maintenant créer une API sur notre projet qui récupère en 
POST la recherche qui est faite.Nous utilisons la lib nouvellement 
ajoutée et puis nous retournons le résultat.</p>
<p>Créons un nouveau fichier <code>search.json.js</code> dans le répertoire <code>src/route/recettes</code></p>
<pre><code><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> searchRecipes</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MarmitonQueryBuilder</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">'marmiton-api'</span><span class="pln">

</span><span class="com">/** @type {import('@sveltejs/kit').RequestHandler} */</span><span class="pln">
</span><span class="kwd">export</span><span class="pln"> async </span><span class="kwd">function</span><span class="pln"> post</span><span class="pun">({</span><span class="pln"> request </span><span class="pun">})</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">const</span><span class="pln"> body </span><span class="pun">=</span><span class="pln"> await request</span><span class="pun">.</span><span class="pln">json</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">const</span><span class="pln"> qb </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MarmitonQueryBuilder</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">const</span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> qb
    </span><span class="pun">.</span><span class="pln">withTitleContaining</span><span class="pun">(</span><span class="pln">body</span><span class="pun">.</span><span class="pln">query</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">.</span><span class="pln">build</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">const</span><span class="pln"> recipes </span><span class="pun">=</span><span class="pln"> await searchRecipes</span><span class="pun">(</span><span class="pln">query</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> limit</span><span class="pun">:</span><span class="pln"> </span><span class="lit">6</span><span class="pln"> </span><span class="pun">})</span><span class="pln">

    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        body</span><span class="pun">:</span><span class="pln"> recipes
    </span><span class="pun">};</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<p>Nous avons maintenant une API pour faire une recherche sur marmiton sur l'url <a href="http://localhost:3000/recettes/search.json" target="_blank">http://localhost:3000/recettes/search.json</a></p>
<p>Vous pouvez la tester avec la requette suivante :</p>
<pre><code language="language-shell" class="language-shell"><span class="pln">curl </span><span class="pun">--</span><span class="pln">location </span><span class="pun">--</span><span class="pln">request POST </span><span class="str">'http://localhost:3000/recettes/search.json'</span><span class="pln"> \
</span><span class="pun">--</span><span class="pln">data</span><span class="pun">-</span><span class="pln">raw </span><span class="str">'{
    "query": "tomate"
}'</span></code></pre>
<h2 is-upgraded="">Interface front</h2>
<p>Dans le fichier <code>index.svelte</code>, ajoutons le code pour le formulaire de recherche :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;form</span><span class="pln"> </span><span class="atn">on:submit</span><span class="pln">|</span><span class="atn">preventDefault</span><span class="pun">=</span><span class="atv">{submitForm}</span><span class="tag">&gt;</span><span class="pln">
	</span><span class="tag">&lt;label</span><span class="pln"> </span><span class="atn">for</span><span class="pun">=</span><span class="atv">"query"</span><span class="tag">&gt;</span><span class="pln">
	</span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"sr-only"</span><span class="tag">&gt;</span><span class="pln">Recherche sur marmiton.org</span><span class="tag">&lt;/span&gt;</span><span class="pln">
	</span><span class="tag">&lt;/label&gt;</span><span class="pln">
	</span><span class="tag">&lt;input</span><span class="pln">
	    </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"query"</span><span class="pln">
	    </span><span class="atn">aria-label</span><span class="pun">=</span><span class="atv">"Recherche sur marmiton.org"</span><span class="pln">
		</span><span class="atn">type</span><span class="pun">=</span><span class="atv">"search"</span><span class="pln">
		</span><span class="atn">name</span><span class="pun">=</span><span class="atv">"query"</span><span class="pln">
		</span><span class="atn">placeholder</span><span class="pun">=</span><span class="atv">"Recherche sur marmiton.org"</span><span class="pln">
		</span><span class="atn">required</span><span class="pln">
		</span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{query}</span><span class="pln">
	</span><span class="tag">/&gt;</span><span class="pln">
	</span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"submit"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"Rechercher"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;/form&gt;</span></code></pre>
<p>Implémentons maintenant la fonction qui fait la recherche :</p>
<p>Remplaçons le script qui défini la variable <code>recettes</code> par ce code :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  </span><span class="kwd">export</span><span class="pln"> let recettes </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[];</span><span class="pln">
	let query</span><span class="pun">;</span><span class="pln">

	async </span><span class="kwd">function</span><span class="pln"> submitForm</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">const</span><span class="pln"> submit </span><span class="pun">=</span><span class="pln"> await fetch</span><span class="pun">(</span><span class="str">'/recettes/search.json'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		method</span><span class="pun">:</span><span class="pln"> </span><span class="str">'POST'</span><span class="pun">,</span><span class="pln">
		headers</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="str">'Accept'</span><span class="pun">:</span><span class="pln"> </span><span class="str">'application/json, text/plain, */*'</span><span class="pun">,</span><span class="pln">
			</span><span class="str">'Content-Type'</span><span class="pun">:</span><span class="pln"> </span><span class="str">'application/json'</span><span class="pln">
		</span><span class="pun">},</span><span class="pln">
		body</span><span class="pun">:</span><span class="pln"> JSON</span><span class="pun">.</span><span class="pln">stringify</span><span class="pun">({</span><span class="pln"> query </span><span class="pun">}),</span><span class="pln">
		</span><span class="pun">})</span><span class="pln">
		</span><span class="kwd">const</span><span class="pln"> data </span><span class="pun">=</span><span class="pln"> await submit</span><span class="pun">.</span><span class="pln">json</span><span class="pun">()</span><span class="pln">

		recettes </span><span class="pun">=</span><span class="pln"> data
	</span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<p>Nous faisons ici un appel vers notre API POST que nous avons écrit juste avant et nous mettons le résultat dans la variable <code>recettes</code>.</p>
<p>Comme l'API de recherche ne nous permet pas de récupérer les infos 
d'une recette, et que nous n'avons pas l'image, il est nécessaire 
d'adapter un peu le code qui affiche les recettes :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;section</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"recettes"</span><span class="tag">&gt;</span><span class="pln">
    {#each recettes as item, index (item.name)}
        </span><span class="tag">&lt;article&gt;</span><span class="pln">
            </span><span class="tag">&lt;h2&gt;&lt;a</span><span class="pln"> </span><span class="atn">sveltekit:prefetch</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"{item.url ?? `/recettes/${index}`}"</span><span class="tag">&gt;</span><span class="pln">{item.name}</span><span class="tag">&lt;/a&gt;&lt;/h2&gt;</span><span class="pln">
            </span><span class="tag">&lt;h3&gt;</span><span class="pln">⏱ {item.totalTime} min 👨‍🍳 {['', 'Très Facile', 'Facile', 'Moyenne', 'Difficile'][item.difficulty || 0]} € {['', 'Bon marché', 'Moyen', 'Assez cher'][item.budget||0]} 😋 {item.people} Personnes</span><span class="tag">&lt;/h3&gt;</span><span class="pln">
            {#if item.image}
               </span><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">{item.image}</span><span class="pln"> </span><span class="atn">alt</span><span class="pun">=</span><span class="atv">{item.name}</span><span class="tag">&gt;</span><span class="pln">
            {/if}
        </span><span class="tag">&lt;/article&gt;</span><span class="pln">
    {/each}
</span><span class="tag">&lt;/section&gt;</span></code></pre>
<p>Nous ouvrons directement la page de marmiton, et nous masquons l'image si elle n'existe pas (la lib ne nous la retourne pas).</p>
<h2 is-upgraded="">Bonus</h2>
<p>Améliorer cette recherche :</p>
<ul>
<li>Indicateur de chargement lorsque l'on fait la recherche.</li>
<li>Message si pas de résultats.</li>
<li>Message si il y a une erreur.</li>
<li>Afficher la recette en grand dans l'application.</li>
<li>Ajouter plus d'options de recherche (regarder l'api marmiton-api 
pour connaitre les différentes options possible) : filtre par 
ingrédients, par difficultés, prix, ...</li>
</ul>


      </div></div></google-codelab-step><google-codelab-step label="Fin" duration="1" step="28"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">28. Fin</h2>
        <p>Bravo ! Vous êtes arrivés à la fin de ce lab ! Nous espérons que vous avez apprécié cette petite expérience avec <em>Svelte</em> !</p>
<p>Vous trouverez le code final de l'app <a href="https://github.com/Zenika/labs-svelte/tree/master/become-svelte" target="_blank">ici</a>.</p>
<aside class="special"><p>   Pour devenir <em>Svelte</em>, pratiquez régulièrement ... </p>
</aside>


      </div></div></google-codelab-step></div><div id="controls"><div id="fabs"><a href="#" id="previous-step" title="Previous step" disappear="">Back</a><div class="spacer"></div><a href="#" id="next-step" title="Next step">Next</a><a href="https://codelab-svelte.web.app/" id="done" title="Codelab complete" hidden="">Done</a></div></div></div></google-codelab>

  <script src="Devenir%20svelte%20avec%20Svelte_fichiers/native-shim.js"></script>
  <script src="Devenir%20svelte%20avec%20Svelte_fichiers/custom-elements.js"></script>
  <script src="Devenir%20svelte%20avec%20Svelte_fichiers/prettify.js"></script>
  <script src="Devenir%20svelte%20avec%20Svelte_fichiers/codelab-elements.js"></script>
  <script src="Devenir%20svelte%20avec%20Svelte_fichiers/api.js"></script>



</body></html>