<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Devenir svelte avec Svelte</title>
  <link rel="stylesheet" href="Devenir%20svelte%20avec%20Svelte_fichiers/css.css">
  <link rel="stylesheet" href="Devenir%20svelte%20avec%20Svelte_fichiers/icon.css">
  <link rel="stylesheet" href="Devenir%20svelte%20avec%20Svelte_fichiers/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14" environment="web" category="null"></google-codelab-analytics>
  <google-codelab codelab-gaid="" id="build" environment="web" feedback-link="https://zenika.com" selected="0" google-codelab-ready="" codelab-title="Devenir svelte avec Svelte"><div id="drawer"><div class="codelab-time-container"><div class="time-remaining" title="Time remaining"><i class="material-icons">access_time</i>236 mins remaining</div></div><div class="steps"><ol><li completed="" selected=""><a href="#0"><span class="step"><span>Overview</span></span></a></li><li><a href="#1"><span class="step"><span>Cr√©ez votre premi√®re application</span></span></a></li><li><a href="#2"><span class="step"><span>Cr√©er un composant</span></span></a></li><li><a href="#3"><span class="step"><span>Afficher des variables dans un template</span></span></a></li><li><a href="#4"><span class="step"><span>Attributs d'un composant</span></span></a></li><li><a href="#5"><span class="step"><span>Conditions d'affichage</span></span></a></li><li><a href="#6"><span class="step"><span>Ajouter du style</span></span></a></li><li><a href="#7"><span class="step"><span>Cr√©er un formulaire</span></span></a></li><li><a href="#8"><span class="step"><span>Double binding</span></span></a></li><li><a href="#9"><span class="step"><span>R√©activit√©</span></span></a></li><li><a href="#10"><span class="step"><span>√âv√®nement lors du click sur le bouton</span></span></a></li><li><a href="#11"><span class="step"><span>Mise en place du store</span></span></a></li><li><a href="#12"><span class="step"><span>Store d√©riv√©</span></span></a></li><li><a href="#13"><span class="step"><span>Animation</span></span></a></li><li><a href="#14"><span class="step"><span>Modifier le titre de la page</span></span></a></li><li><a href="#15"><span class="step"><span>SvelteKit</span></span></a></li><li><a href="#16"><span class="step"><span>Ajouter une nouvelle page</span></span></a></li><li><a href="#17"><span class="step"><span>Ajouter un layout</span></span></a></li><li><a href="#18"><span class="step"><span>Ajouter une page de recette</span></span></a></li><li><a href="#19"><span class="step"><span>Afficher une page de d√©tail</span></span></a></li><li><a href="#20"><span class="step"><span>Accessibilit√©</span></span></a></li><li><a href="#21"><span class="step"><span>Ajouter du code serveur</span></span></a></li><li><a href="#22"><span class="step"><span>Utiliser notre API</span></span></a></li><li><a href="#23"><span class="step"><span>SSR</span></span></a></li><li><a href="#24"><span class="step"><span>Testing</span></span></a></li><li><a href="#25"><span class="step"><span>D√©ployer l'application</span></span></a></li><li><a href="#26"><span class="step"><span>Ajouter une recherche de recette sur Marmiton (Bonus)</span></span></a></li><li><a href="#27"><span class="step"><span>Fin</span></span></a></li></ol></div><div class="metadata"><a target="_blank" href="https://zenika.com/"><i class="material-icons">bug_report</i> Report a mistake</a></div></div><div id="codelab-title"><div id="codelab-nav-buttons"><a href="https://codelab-svelte.web.app/" id="arrow-back"><i class="material-icons">close</i></a><a href="#" id="menu"><i class="material-icons">menu</i></a></div><h1 is-upgraded="" class="title">Devenir svelte avec Svelte</h1><div class="codelab-time-container"><div class="time-remaining" title="Time remaining"><i class="material-icons">access_time</i>236 mins remaining</div></div><devsite-user></devsite-user></div><div id="main"><div id="steps"><google-codelab-step label="Overview" duration="10" step="1" selected=""><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">1. Overview</h2>
        <h2 is-upgraded="">Ce que vous allez apprendre</h2>
<ul>
<li>Installation du framework</li>
<li>Cr√©ation de composants</li>
<li>Passage de param√®tres</li>
<li>Utilisation de la r√©activit√©</li>
<li>Templating</li>
<li>Events et binding</li>
<li>Cycle de vie des composants</li>
<li>Stores et contexte</li>
<li>Animations</li>
<li>Sveltekit</li>
<li>SSR</li>
<li>Test</li>
<li>D√©ploiement</li>
</ul>
<h2 is-upgraded="">Pr√©sentation de Svelte</h2>
<p><em>Svelte</em> est un compilateur plus qu'un framework, il ajoute du
 sucre syntaxique √† du code javascript pour d√©velopper des applications.
 Il va ainsi pouvoir instrumentaliser le code pour ajouter des 
instructions pour mettre √† jour l'affichage lors de changement des 
donn√©es.</p>
<p>Sur le site de <a href="https://svelte.dev/" target="_blank">Svelte</a>, un REPL (Read Eval Print Loop) permet de tester en direct du code <em>Svelte</em> et voir le code g√©n√©r√©. De m√™me un <a href="https://svelte.dev/tutorial/basics" target="_blank">tutoriel</a> permet d'apprendre les bases du framework pas √† pas.</p>
<p>Un fichier <em>Svelte</em> (fichier avec une extension .svelte) 
ressemble √† un fichier html qui va contenir les balises html de notre 
template, une balise <code>&lt;script&gt;</code> contenant le code javascript, ainsi qu'une balise <code>&lt;style&gt;</code> contenant le style CSS.</p>
<p>Par exemple :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
	</span><span class="kwd">const</span><span class="pln"> name </span><span class="pun">=</span><span class="pln"> </span><span class="str">'world'</span><span class="pun">;</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;style&gt;</span><span class="pln">
	h1 </span><span class="pun">{</span><span class="pln">
		color</span><span class="pun">:</span><span class="pln"> red</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/style&gt;</span><span class="pln">

</span><span class="tag">&lt;h1&gt;</span><span class="pln">Hello {name}!</span><span class="tag">&lt;/h1&gt;</span></code></pre>
<h2 is-upgraded="">Cr√©er un projet Svelte</h2>
<p>Comme <em>Svelte</em> est un compilateur, il est n√©cessaire de le lancer pour pouvoir transformer les fichiers <code>.svelte</code> en fichier javascript et css.</p>
<p><em>Svelte</em> est capable de s'int√©grer avec tous les packages bundler existant comme <em>Webpack</em> ou <em>Rollup</em>.</p>
<p>Ils fournissent des templates pour cr√©er le squelette d'une application, et propose d'utiliser <code>degit</code> un utilitaire qui t√©l√©charge les fichiers d'un repos git sans l'historique.</p>
<p>Pour cr√©er un projet avec <em>Rollup</em> il suffit alors de saisir les lignes de commandes suivantes :</p>
<pre><code language="language-bash" class="language-bash"><span class="pln">npx degit sveltejs</span><span class="pun">/</span><span class="kwd">template</span><span class="pln"> </span><span class="kwd">my</span><span class="pun">-</span><span class="pln">svelte</span><span class="pun">-</span><span class="pln">project
cd </span><span class="kwd">my</span><span class="pun">-</span><span class="pln">svelte</span><span class="pun">-</span><span class="pln">project
npm install
npm run dev</span></code></pre>
<p>Vous aurez alors un projet de base avec les outils permettant de 
lancer l'application en d√©veloppement ou construire l'application √† 
deployer.</p>
<aside class="special"><p> Vous pouvez utiliser Typescript en √©xecutant la commande : <code>node scripts/setupTypeScript.js</code></p>
</aside>
<h2 is-upgraded="">Le projet pour ce codelab</h2>
<p>Apr√®s cette rapide introduction √† <em>Svelte</em>, nous allons cr√©er pour ce codelab un projet permettant de calculer son IMC (Indice de Masse Corporelle).</p>
<aside class="special"><p> L'indice de masse corporelle ou IMC (en 
anglais, body mass index ou BMI) est une grandeur qui permet d'estimer 
la corpulence d'une personne. Invent√© au milieu du XIXe si√®cle par 
Adolphe Quetelet, math√©maticien belge et l'un des fondateurs de la 
statistique moderne, cet indice est appel√© aussi l'indice de Quetelet. </p>
</aside>
<p>La formule pour calculer l'IMC est le poids divis√© par la taille au carr√©.</p>
<p><a href="https://become-svelte.netlify.app/" target="_blank">Voir l'application finale</a></p>


      </div></div></google-codelab-step><google-codelab-step label="Cr√©ez votre premi√®re application" duration="10" step="2"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">2. Cr√©ez votre premi√®re application</h2>
        <h2 is-upgraded="">Initialiser le projet</h2>
<p>Comme vu lors de la premi√®re √©tape, nous allons initialiser notre 
application en partant d'un template. Nous avons cr√©√© un template pour 
le codelab qui va contenir des √©l√©ments qui seront utilis√©s directement 
par votre application. Ce template contient d√©j√† la structure pour 
utiliser <em>SvelteKit</em> pour la suite du codelab.</p>
<pre><code language="language-bash" class="language-bash"><span class="pln">npx degit zenika</span><span class="pun">/</span><span class="pln">labs</span><span class="pun">-</span><span class="pln">svelte</span><span class="pun">/</span><span class="kwd">template</span><span class="pln"> labs</span><span class="pun">-</span><span class="pln">svelte
cd labs</span><span class="pun">-</span><span class="pln">svelte
npm install</span></code></pre>
<h2 is-upgraded="">D√©couvrir ce qui a √©t√© g√©n√©r√©</h2>
<p>Vous vous retrouvez avec une application <em>SvelteKit</em>  Voici les diff√©rents fichiers que l'on peut retrouver :</p>
<ul>
<li><strong>package.json</strong> : Contient les d√©pendances, ainsi que les scripts <code>dev</code> (pour lancer le projet en d√©veloppement) ou <code>build</code> (pour construire l'application finale).</li>
<li><strong>svelte.config.js</strong> : Configuration pour <em>SvelteKit</em>.</li>
<li><strong>static</strong> : Les ressources statiques du projet.</li>
<li><strong>src</strong>: Les fichiers sources de l'application o√π seront ajout√©s les diff√©rents composants. <ul>
<li><strong>lib</strong> : Les composants commun de l'application, c'est dans ce r√©pertoire que l'on va travailler pour tous le d√©but du codelab</li>
<li><strong>routes</strong> : Les diff√©rentes pages de votre application, que l'on verra plus tard dans le codelab</li>
<li><strong>app.html</strong> : Page HTML de l'application o√π se chargera votre application.</li>
<li><strong>global.d.ts</strong> : Permet d'ajouter les d√©finitions de type pour utiliser l'autocomplexion sur le projet.</li>
</ul>
</li>
</ul>
<h2 is-upgraded="">Lancer le projet</h2>
<p>Maintenant, lan√ßons le projet :</p>
<pre><code language="language-bash" class="language-bash"><span class="pln">npm run dev</span></code></pre>
<p>En ouvrant le navigateur √† l'url <a href="http://localhost:3000/" target="_blank">http://localhost:3000/</a> vous verrez la page de notre application :</p>
<p class="image-container"><img alt="Capture step 1" src="Devenir%20svelte%20avec%20Svelte_fichiers/e4960cd5f2f9d5f1.png"></p>
<h2 is-upgraded="">Modifier et voir le r√©sultat</h2>
<p>Maintenant entrons dans le vif du sujet, ouvrez le fichier <strong>ImcCalculator.svelte</strong> puis modifiez la variable <code>name</code> pour y mettre votre nom :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">const</span><span class="pln"> name </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Votre nom"</span><span class="pun">;</span></code></pre>
<p>Une fois les modifications sauvegard√©es, l'application sera 
automatiquement rafra√Æchie avec les changements et vous devriez avoir le
 texte "Bonjour Votre nom" qui s'affiche √† l'√©cran.</p>
<p>Passons maintenant √† l'√©tape suivante pour cr√©er notre premier composant.</p>


      </div></div></google-codelab-step><google-codelab-step label="Cr√©er un composant" duration="5" step="3"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">3. Cr√©er un composant</h2>
        <p>Nous allons maintenant cr√©er notre premier composant, pour cela cr√©ez un nouveau fichier <strong>Imc.svelte</strong> dans le r√©pertoire <code>src/lib</code>.</p>
<p>Dans ce fichier, mettez du code html pour afficher un simple texte :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;p&gt;</span><span class="pln">Votre IMC est de 20</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>Dans le fichier <strong>ImcCalculator.svelte</strong>, ajoutez simplement l'import de notre composant Imc :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> </span><span class="typ">Imc</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"./Imc.svelte"</span><span class="pun">;</span></code></pre>
<aside class="special"><p> Placer ce code javascript entre les balise html <em>&lt;script&gt;&lt;/script&gt;</em></p>
</aside>
<p>Nous pouvons maintenant utiliser notre composant Imc directement dans notre contenu html :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;Imc</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
<p>Nous nous retrouvons √† pr√©sent avec une page qui affiche le texte "Votre IMC est de 20".</p>
<p>Maintenant, il faudrait que ce texte soit plus dynamique et qu'il puisse √™tre configur√© en fonction du poids et de la taille.</p>


      </div></div></google-codelab-step><google-codelab-step label="Afficher des variables dans un template" duration="10" step="4"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">4. Afficher des variables dans un template</h2>
        <p>Dans notre fichier <strong>Imc.svelte</strong>, nous allons 
ajouter deux variables pour d√©finir le poids et la taille, et afficher 
ensuite le calcul de l'IMC √† la place de notre texte html statique.</p>
<p>Pour cela, dans <strong>Imc.svelte</strong>, ajoutons une balise script, contenant deux d√©clarations de variable :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  let poids </span><span class="pun">=</span><span class="pln"> </span><span class="lit">80</span><span class="pun">;</span><span class="pln">
  let taille </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1.80</span><span class="pun">;</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<p>Nous pouvons maintenant afficher ces variables dans le html en utilisant la syntaxe <code>{variable ou expression}</code></p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;p&gt;</span><span class="pln">Votre IMC ({poids}/{taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {(poids / taille ** 2).toFixed(2)}</span><span class="tag">&lt;/p&gt;</span></code></pre>
<aside class="special"><p> La formule de l'IMC est le poids en kilo divis√© par la taille en m√®tre au carr√©. </p>
</aside>
<p>Analysons le code ci-dessus : <code>{poids}</code> et <code>{taille}</code> seront remplac√©s respectivement par le contenu des variables <code>poids</code> et <code>taille</code>. <code>{(poids / taille ** 2).toFixed(2)}</code> r√©alise plusieurs actions :</p>
<ul>
<li><code>(poids / taille ** 2)</code> : Calcule l'IMC (l'op√©rateur ** permet de faire une puissance en javascript).</li>
<li><code>.toFixed(2)</code> : Convertit le nombre en chaine de caract√®re en ne gardant que deux chiffres apr√®s la virgule.</li>
<li><code>{}</code>: Syntaxe permettant √† <em>Svelte</em> d'afficher le contenu dans le html.</li>
</ul>
<p>Vous pouvez maintenant faire √©voluer la valeur des variables <code>poids</code> ou <code>taille</code> puis voir le r√©sultat du calcul de l'IMC en rafraichissant la page.</p>
<p>Ce composant, m√™me s'il permet de faire le calcul n'est pas 
utilisable dans une application car il utilise des variables locales √† 
celui-ci. Voyons maintenant comment param√©trer ces variables pour 
permettre de recevoir ces valeurs en entr√©e du composant.</p>


      </div></div></google-codelab-step><google-codelab-step label="Attributs d'un composant" duration="10" step="5"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">5. Attributs d'un composant</h2>
        <p>Pour d√©finir les param√®tres d'un composant <em>Svelte</em>, dont les valeurs seront transmises via des attributs html, il faut d√©finir une variable et la pr√©fixer par le mot cl√© <code>export</code>. (Ex: <code>export let monParametre;</code>)</p>
<aside class="special"><p> En javascript, le mot cl√© <code>export</code> permet d'indiquer que la variable ou la fonction est accessible √† l'ext√©rieur du fichier (du module). <em>Svelte</em> l'utilise pour d√©finir les entr√©es des composants. </p>
</aside>
<p>Une fois ce mot cl√© ajout√© :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  </span><span class="kwd">export</span><span class="pln"> let poids </span><span class="pun">=</span><span class="pln"> </span><span class="lit">80</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">export</span><span class="pln"> let taille </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1.80</span><span class="pun">;</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<p>Nous pouvons maintenant passer des valeurs par des attributs html √† notre composant :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;Imc</span><span class="pln"> </span><span class="atn">poids</span><span class="pun">=</span><span class="atv">100</span><span class="pln"> </span><span class="atn">taille</span><span class="pun">=</span><span class="atv">1.9</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
<p>Il est bien s√ªr possible de faire en sorte que cet attribut soit dynamique :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;Imc</span><span class="pln"> </span><span class="atn">poids</span><span class="pun">=</span><span class="atv">{monPoids}</span><span class="pln"> {</span><span class="atn">taille</span><span class="pln">} </span><span class="tag">/&gt;</span></code></pre>
<p>Ici :</p>
<ul>
<li><code>poids={monPoids}</code> : le contenu de la variable <code>monPoids</code> est pass√© dans l'attribut <code>poids</code></li>
<li><code>{taille}</code> : √©criture simplifi√©e de <code>taille={taille}</code></li>
</ul>


      </div></div></google-codelab-step><google-codelab-step label="Conditions d'affichage" duration="10" step="6"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">6. Conditions d'affichage</h2>
        <p>Ajoutons maintenant un message qui pr√©cise notre √©tat de corpulence en fonction de l'IMC.</p>
<aside class="special"><p> Un IMC compris entre 18 et 25 correspond √† 
une corpulence "normale". Au del√†, on parle de surpoids, et en dessous, 
de maigreur. </p>
</aside>
<p>Nous voulons donc ajouter un message en fonction de notre IMC. <em>Svelte</em> permet d'ajouter des conditions dans un template avec la syntaxe <code>{#if condition}{:else if condition}{:else}{/if}</code></p>
<p>Commen√ßons par cr√©er une variable contenant notre IMC. Cette valeur sera utilis√©e dans notre condition :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">const</span><span class="pln"> imc </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">poids </span><span class="pun">/</span><span class="pln"> taille </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span><span class="pun">).</span><span class="pln">toFixed</span><span class="pun">(</span><span class="lit">2</span><span class="pun">);</span></code></pre>
<p>Nous pouvons ensuite ajouter dans le code html, un ensemble de 
conditions pour afficher un message. Pour cela nous utilisons une 
syntaxe propre √† <em>Svelte</em> en utilisant les instructions <code>{#if}</code>, <code>{:else if}</code> et <code>{/if}</code>.</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;p&gt;</span><span class="pln">Votre IMC ({poids}/{taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {imc}</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{#if imc &lt; 18}
  </span><span class="tag">&lt;p&gt;</span><span class="pln">Vous √™tes maigre</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else if imc &gt; 25}
  </span><span class="tag">&lt;p&gt;</span><span class="pln">Vous √™tes en surpoids</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else}
  </span><span class="tag">&lt;p&gt;</span><span class="pln">Vous √™tes svelte !</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{/if}</span></code></pre>
<p><em>Svelte</em> donne acc√®s √† d'autres √©l√©ments de syntaxe de ce genre pour aider la cr√©ation de templates, tel que <code>{#each}{/each}</code> pour effectuer une boucle.</p>
<p>Les √©l√©ments de template <em>Svelte</em> sont encapsul√©s dans 2 accolades <code>{}</code>. Afin de pouvoir imbriquer les balises, on diff√©rencie les balises ouvrantes ou fermantes, respectivement avec les caract√®res <code>#</code> et <code>/</code>. Les balises <code>else</code> sont elles pr√©c√©d√©es de <code>:</code>. Il est possible de les utiliser en association avec une balise <code>if</code> mais aussi avec <code>each</code>. Dans le second cas, cela permet d'afficher une alternative au cas o√π le tableau serait vide.</p>


      </div></div></google-codelab-step><google-codelab-step label="Ajouter du style" duration="10" step="7"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">7. Ajouter du style</h2>
        <p>Nous aimerions maintenant diff√©rencier les messages que nous affichons dans diff√©rentes couleurs :</p>
<ul>
<li><em>orange</em>: pour un IMC inf√©rieur √† 18</li>
<li><em>rouge</em>: pour un IMC sup√©rieur √† 25</li>
<li><em>vert</em>: pour un IMC compris entre 18 et 25</li>
</ul>
<p>Pour cela, nous allons cr√©er 3 classes CSS. Deux solutions s'offrent √† nous :</p>
<ul>
<li>Option 1 : ajouter ces classes dans le fichier <code>global.css</code> qui se trouve dans le r√©pertoire <code>public</code>. Les classes seront alors disponibles pour toute l'application.</li>
<li>Option 2 : ajouter ces classes dans le fichier de notre composant <strong>Imc.svelte</strong>, en ins√©rant une balise <code>&lt;style&gt;&lt;/style&gt;</code>. Les classes seront alors scop√©es √† notre composant (non disponibles en dehors du composant).</li>
</ul>
<pre><code language="language-css" class="language-css"><span class="pun">.</span><span class="pln">normal </span><span class="pun">{</span><span class="pln">
  color</span><span class="pun">:</span><span class="pln"> green</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="pun">.</span><span class="pln">surpoids </span><span class="pun">{</span><span class="pln">
  color</span><span class="pun">:</span><span class="pln"> red</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="pun">.</span><span class="pln">souspoids </span><span class="pun">{</span><span class="pln">
  color</span><span class="pun">:</span><span class="pln"> orange</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<p>Nous allons choisir l'option 2. Ajoutons les classes CSS dans le code de notre composant :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;p&gt;</span><span class="pln">Votre IMC ({poids}/{taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {imc}</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{#if imc &lt; 18}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"souspoids"</span><span class="tag">&gt;</span><span class="pln">Vous √™tes maigre</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else if imc &gt; 25}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"surpoids"</span><span class="tag">&gt;</span><span class="pln">Vous √™tes en surpoids</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"normal"</span><span class="tag">&gt;</span><span class="pln">Vous √™tes svelte !</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{/if}
</span><span class="tag">&lt;style&gt;</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">normal </span><span class="pun">{</span><span class="pln">
    color</span><span class="pun">:</span><span class="pln"> green</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">surpoids </span><span class="pun">{</span><span class="pln">
    color</span><span class="pun">:</span><span class="pln"> red</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">souspoids </span><span class="pun">{</span><span class="pln">
    color</span><span class="pun">:</span><span class="pln"> orange</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/style&gt;</span></code></pre>
<p><em>Svelte</em> va automatiquement ajouter une classe g√©n√©r√©e sur 
chaque composant, et le CSS sera automatiquement scop√© gr√¢ce cette 
classe. Si un autre composant d√©clare aussi une classe CSS <code>.normal</code>, il n'y aura ainsi aucune collision.</p>
<p>Pour aller plus loin dans la manipulation du style, voyons comment 
nous pouvons utiliser des classes CSS de fa√ßon conditionnelle.</p>
<p>Pour cela, jouons sur l'affichage du texte dans la balise <code>p</code> de l'IMC, avec deux nouvelles classes CSS (<code>thin</code> et <code>bold</code>) :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="pln">&lt;p class:thin={imc &lt; 18} class:bold={imc &gt; 25}&gt;
    Votre IMC ({poids}/{taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {imc}
</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>puis on ajoute les classes dans la balise style de notre composant :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;style&gt;</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">normal </span><span class="pun">{</span><span class="pln">
    color</span><span class="pun">:</span><span class="pln"> green</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">surpoids </span><span class="pun">{</span><span class="pln">
    color</span><span class="pun">:</span><span class="pln"> red</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">souspoids </span><span class="pun">{</span><span class="pln">
    color</span><span class="pun">:</span><span class="pln"> orange</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">thin </span><span class="pun">{</span><span class="pln">
    font</span><span class="pun">-</span><span class="pln">weight</span><span class="pun">:</span><span class="pln"> </span><span class="lit">200</span><span class="pun">;</span><span class="pln">
    font</span><span class="pun">-</span><span class="pln">size</span><span class="pun">:</span><span class="pln"> </span><span class="pun">.</span><span class="lit">875rem</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">bold </span><span class="pun">{</span><span class="pln">
    font</span><span class="pun">-</span><span class="pln">weight</span><span class="pun">:</span><span class="pln"> </span><span class="lit">600</span><span class="pun">;</span><span class="pln">
    font</span><span class="pun">-</span><span class="pln">size</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1.125rem</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/style&gt;</span></code></pre>
<p>C'est plut√¥t pratique, mais avec cette fa√ßon de faire nous utilisons 
les m√™me conditions √† 2 endroits diff√©rents, ce qui n'est pas id√©al en 
terme de maintenabilit√©. Pour rem√©dier √† ce "probl√®me", <em>Svelte</em> 
met √† disposition un sucre syntaxique extr√©mement pratique. Si la classe
 et la variable qui conditionne son affichage portent le m√™me nom, alors
 nous pouvons simplement √©crire <code>class:condition</code>.</p>
<p>Dans notre cas, commen√ßons donc par ajouter nos conditions dans 2 nouvelles variables :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  </span><span class="kwd">const</span><span class="pln"> imc </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">poids </span><span class="pun">/</span><span class="pln"> taille </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span><span class="pun">).</span><span class="pln">toFixed</span><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span><span class="pln">
  </span><span class="kwd">const</span><span class="pln"> thin </span><span class="pun">=</span><span class="pln"> imc </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">18</span><span class="pln">
  </span><span class="kwd">const</span><span class="pln"> bold </span><span class="pun">=</span><span class="pln"> imc </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">25</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<p>Puis, modifions notre code html pour utiliser ces nouvelles variables :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class:thin</span><span class="pln"> </span><span class="atn">class:bold</span><span class="tag">&gt;</span><span class="pln">
    Votre IMC ({poids}/{taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {imc}
</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{#if thin}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"souspoids"</span><span class="tag">&gt;</span><span class="pln">Vous √™tes maigre</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else if bold}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"surpoids"</span><span class="tag">&gt;</span><span class="pln">Vous √™tes en surpoids</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"normal"</span><span class="tag">&gt;</span><span class="pln">Vous √™tes svelte !</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{/if}</span></code></pre>
<p>Le code complet de notre composant ressemble au final √† ceci :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  </span><span class="kwd">const</span><span class="pln"> imc </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">poids </span><span class="pun">/</span><span class="pln"> taille </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span><span class="pun">).</span><span class="pln">toFixed</span><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span><span class="pln">
  </span><span class="kwd">const</span><span class="pln"> thin </span><span class="pun">=</span><span class="pln"> imc </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">18</span><span class="pln">
  </span><span class="kwd">const</span><span class="pln"> bold </span><span class="pun">=</span><span class="pln"> imc </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">25</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class:thin</span><span class="pln"> </span><span class="atn">class:bold</span><span class="tag">&gt;</span><span class="pln">
    Votre IMC ({poids}/{taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {imc}
</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{#if thin}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"souspoids"</span><span class="tag">&gt;</span><span class="pln">Vous √™tes maigre</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else if bold}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"surpoids"</span><span class="tag">&gt;</span><span class="pln">Vous √™tes en surpoids</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"normal"</span><span class="tag">&gt;</span><span class="pln">Vous √™tes svelte !</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{/if}

</span><span class="tag">&lt;style&gt;</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">normal </span><span class="pun">{</span><span class="pln">
    color</span><span class="pun">:</span><span class="pln"> green</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">surpoids </span><span class="pun">{</span><span class="pln">
    color</span><span class="pun">:</span><span class="pln"> red</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">souspoids </span><span class="pun">{</span><span class="pln">
    color</span><span class="pun">:</span><span class="pln"> orange</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">thin </span><span class="pun">{</span><span class="pln">
    font</span><span class="pun">-</span><span class="pln">weight</span><span class="pun">:</span><span class="pln"> </span><span class="lit">200</span><span class="pun">;</span><span class="pln">
    font</span><span class="pun">-</span><span class="pln">size</span><span class="pun">:</span><span class="pln"> </span><span class="pun">.</span><span class="lit">875rem</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">bold </span><span class="pun">{</span><span class="pln">
    font</span><span class="pun">-</span><span class="pln">weight</span><span class="pun">:</span><span class="pln"> </span><span class="lit">600</span><span class="pun">;</span><span class="pln">
    font</span><span class="pun">-</span><span class="pln">size</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1.125rem</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/style&gt;</span></code></pre>


      </div></div></google-codelab-step><google-codelab-step label="Cr√©er un formulaire" duration="10" step="8"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">8. Cr√©er un formulaire</h2>
        <p>Pour l'instant, le poids et la taille sont d√©finis comme des attributs du composant <code>Imc</code>.
 Nous voulons √† pr√©sent rendre ces attributs √©ditables par l'utilisateur
 au travers de l'interface. Nous allons alors cr√©er un formulaire pour 
pouvoir saisir notre poids et notre taille et ainsi pouvoir calculer 
notre IMC.</p>
<h2 is-upgraded="">Nouveau composant</h2>
<p>Commen√ßons par cr√©er un nouveau composant que nous nommerons <code>Form.svelte</code> dans le r√©pertoire <code>src/lib</code>.</p>
<p>Ce composant contiendra un formulaire simple avec deux sliders permettant de d√©finir son poids et sa taille :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  let poids </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  let taille </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;form&gt;</span><span class="pln">
  </span><span class="tag">&lt;label&gt;</span><span class="pln"> Poids ({poids} kg) :
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"poids"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"10"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"200"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"5"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">{poids}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/label&gt;</span><span class="pln">

  </span><span class="tag">&lt;label&gt;</span><span class="pln"> Taille ({taille.toFixed(2)} m) :
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"taille"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"0.5"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"2.5"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"0.01"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">{taille}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/label&gt;</span><span class="pln">
</span><span class="tag">&lt;/form&gt;</span></code></pre>
<p>Regardons en d√©tail ce que fait ce composant:</p>
<ul>
<li><code>let poids = 0; let taille = 0;</code>: Cr√©ation de variables pour le poids et la taille, initialis√©s √† <code>0</code>.</li>
<li><code>Poids ({poids} kg)</code> <code>Taille ({taille.toFixed(2)} m)</code>: Affichage de la valeur de chaque variable dans les labels, avec la syntaxe <code>{}</code> vu pr√©c√©demment.</li>
<li><code>&lt;input name="poids" type="range" min="10" max="200" step="5" value={poids} /&gt;</code> <code>&lt;input name="taille" type="range" min="0.5" max="2.5" step="0.01" value={taille} /&gt;</code>: Ajout de 2 inputs de type <code>range</code> pour r√©gler le poids et la taille, initialis√©s avec les valeurs de nos variables.</li>
</ul>
<p>Ajoutons maintenant ce formulaire dans notre composant principale <strong>ImcCalculator.svelte</strong>. Pour cela, commen√ßons par l'importer :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> </span><span class="typ">Form</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"./Form.svelte"</span><span class="pun">;</span></code></pre>
<p>Puis, nous pouvons l'utiliser au dessus du composant <code>&lt;Imc /&gt;</code> :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;Form</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;Imc</span><span class="pln"> </span><span class="atn">poids</span><span class="pun">=</span><span class="atv">100</span><span class="pln"> </span><span class="atn">taille</span><span class="pun">=</span><span class="atv">1.9</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
<h2 is-upgraded="">√âv√®nements natifs</h2>
<p>En l'√©tat actuel des choses, nous ne r√©cup√©rons pas les valeurs 
saisies via les sliders. Nous allons rem√©dier √† ceci en commen√ßant par 
jouer avec les √©v√®nements natifs des composants html.</p>
<p>En <em>Svelte</em>, pour s'abonner aux √©v√®nements d'un composant nous pouvons utiliser le prefix <code>on:</code> sur le nom de l'√©v√®nement auquel on souhaite r√©agir. Exemple <code>on:click={clickHandler}</code></p>
<ul>
<li><code>on:</code> Indique que nous souhaitons nous abonner √† un √©v√®nenement.</li>
<li><code>click</code> Pr√©cise l'√©v√®nement auquel nous souhaitons nous abonner.</li>
<li><code>={clickHandler}</code> Pr√©cise la fonction √† appeler lorsque l'√©v√®nement va survenir. Il est √©galement possible d'appeler une fonction lambda <code>{event =&gt; changeEvent(event.target.value)}</code>.</li>
</ul>
<p>Autres exemples :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">on:input</span><span class="pun">=</span><span class="atv">{saveChange}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;button</span><span class="pln"> </span><span class="atn">on:click</span><span class="pun">=</span><span class="atv">{submit}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">on:mousemove</span><span class="pun">=</span><span class="atv">{event</span><span class="pln"> </span><span class="tag">=&gt;</span><span class="pln"> handleMousemove(event.clientX, event.clientY)}&gt;</span><span class="tag">&lt;/div&gt;</span></code></pre>
<p>Pour nos besoins, commen√ßons par cr√©er deux fonctions (nos handlers) permettant de mettre √† jour nos variables, dans <code>Form.svelte</code> :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  let poids </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  let taille </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">

  </span><span class="kwd">function</span><span class="pln"> onPoidsChange</span><span class="pun">(</span><span class="pln">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    poids </span><span class="pun">=</span><span class="pln"> event</span><span class="pun">.</span><span class="pln">target</span><span class="pun">.</span><span class="pln">value
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">function</span><span class="pln"> onTailleChange</span><span class="pun">(</span><span class="pln">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    taille </span><span class="pun">=</span><span class="pln"> parseFloat</span><span class="pun">(</span><span class="pln">event</span><span class="pun">.</span><span class="pln">target</span><span class="pun">.</span><span class="pln">value</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<p>Ensuite, branchons ces nouvelles fonctions sur les events de nos inputs :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"poids"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"10"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"200"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"5"</span><span class="pln"> </span><span class="atn">on:input</span><span class="pun">=</span><span class="atv">{onPoidsChange}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">

</span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"taille"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"0.5"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"2.5"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"0.01"</span><span class="pln"> </span><span class="atn">on:input</span><span class="pun">=</span><span class="atv">{onTailleChange}</span><span class="tag">/&gt;</span></code></pre>


      </div></div></google-codelab-step><google-codelab-step label="Double binding" duration="10" step="9"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">9. Double binding</h2>
        <p>Maintenant que nous pouvons r√©cup√©rer les valeur de nos inputs, il est n√©cessaire de faire passer ces valeurs du composant <code>Form</code> vers le composant <code>Imc</code>.</p>
<h2 is-upgraded="">Descendre une valeur d'un composant parent</h2>
<p>Pour cela, il nous faut passer par le composant ImcCalculator pour faire passer les valeurs.</p>
<p>Ajoutons deux variables dans le fichier <strong>ImcCalculator.svelte</strong> √† l'int√©rieur de la balise <code>&lt;script&gt;&lt;/script&gt;</code></p>
<pre><code><span class="pln"> </span><span class="kwd">let</span><span class="pln"> poids </span><span class="pun">=</span><span class="pln"> </span><span class="lit">80</span><span class="pun">;</span><span class="pln">
 </span><span class="kwd">let</span><span class="pln"> taille </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1.8</span><span class="pun">;</span></code></pre>
<p>Pour faire passer les valeurs au composant <code>Imc</code>, rien de plus simple, il nous suffit d'utiliser la syntaxe permettant de passer des param√®tres √† un composant <code>taille={taille}</code> ou la syntaxe simplifi√©e <code>{taille}</code> (üòç):</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;Imc</span><span class="pln"> {</span><span class="atn">taille</span><span class="pln">} {</span><span class="atn">poids</span><span class="pln">} </span><span class="tag">/&gt;</span></code></pre>
<h2 is-upgraded="">Remonter une valeur au composant parent</h2>
<p>Mais comment faire sortir les donn√©es du composant <code>Form</code> ?</p>
<p>Commen√ßons par ajouter le mot cl√© <code>export</code> devant les deux variables dans le fichier <strong>Form.svelte</strong> pour en faire des propri√©t√©s du composant:</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">export</span><span class="pln"> </span><span class="kwd">let</span><span class="pln"> poids </span><span class="pun">=</span><span class="pln"> </span><span class="lit">80</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">export</span><span class="pln"> </span><span class="kwd">let</span><span class="pln"> taille </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1.8</span><span class="pun">;</span></code></pre>
<p>et dans le fichier <strong>ImcCalculator.svelte</strong></p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;Form</span><span class="pln"> {</span><span class="atn">taille</span><span class="pln">} {</span><span class="atn">poids</span><span class="pln">} </span><span class="tag">/&gt;</span></code></pre>
<p>Les valeurs de <code>taille</code> et <code>poids</code> du composant <code>ImcCalculator</code> sont d√©sormais transmises dans les composants <code>Form</code> et <code>Imc</code>. Nous pouvons √©galement modifier ces valeurs au sein du composant <code>Form</code> via les inputs mais ces mises √† jour ne modifient pas les valeurs dans le composant <code>Imc</code> car les modifications ne sont jamais remont√©es jusque dans <code>ImcCalculator</code>.</p>
<h2 is-upgraded="">Le Double Binding √† la rescousse !</h2>
<p>Jusqu'√† pr√©sent nous ne transmettons les donn√©es que dans un seul 
sens : du parent vers l'enfant. Nous voudrions maintenant que les 
modifications qui sont effectu√©es sur une propri√©t√© au sein de l'enfant 
soient √©galement transmises au parent. Pour cela <em>Svelte</em> met √† 
disposition une syntaxe de double binding, ou binding bi-directionnel, 
c'est √† dire un binding qui est √† la fois descendant et ascendant.</p>
<p>Pour ce faire, nous utilisons le mot cl√© <code>bind</code>.</p>
<p>Ajouter <code>bind:</code> devant une propri√©t√© permet de s'assurer 
que toutes les mises √† jour de cette propri√©t√© dans l'enfant seront 
aussi transmises √† la variable associ√©e dans le parent.</p>
<p>Nous pouvons donc faire ceci sur le composant <code>Form</code> dans le composant <code>ImcCalculator</code> :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;Form</span><span class="pln"> </span><span class="atn">bind:poids</span><span class="pln"> </span><span class="atn">bind:taille</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
<p>Maintenant, les modifications dans <code>Form</code> mettent √† jour les valeurs de poids et taille dans <code>Imc</code>.</p>
<p>‚ö† Pour le moment, les valeurs de l'IMC et les styles ne sont pas 
modifi√©s lorsqu'on change les valeurs de poids et taille, ceci est 
l'objet du prochain chapitre.</p>
<h2 is-upgraded="">Double binding sur un √©l√®ment du DOM</h2>
<p>La syntaxe <code>bind:</code> permet √©galement de faire un double 
binding entre une variable et une propri√©t√© d'un √©l√©ment du DOM pour, 
par exemple, les √©l√©ments du formulaire.</p>
<p>Nous pouvons donc remplacer la combinaison de <code>value:poids</code> et <code>on:input={onPoidsChange}</code> par <code>bind:value={poids}</code> dans le fichier <strong>Form.svelte</strong>.</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"poids"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"10"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"200"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"5"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{poids}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"taille"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"0.5"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"2.5"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"0.01"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{taille}</span><span class="pln"> </span><span class="tag">/&gt;</span></code></pre>
<p>Les fonctions <code>onPoidsChange</code> et <code>onTailleChange</code> ne sont donc plus n√©cessaires et peuvent √™tre supprim√©es. Ce qui nous donne le code suivant pour le composant <code>Form</code> :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  </span><span class="kwd">export</span><span class="pln"> let poids </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">export</span><span class="pln"> let taille </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;form&gt;</span><span class="pln">
  </span><span class="tag">&lt;label&gt;</span><span class="pln"> Poids ({poids} kg) :
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"poids"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"10"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"200"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"5"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{poids}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/label&gt;</span><span class="pln">

  </span><span class="tag">&lt;label&gt;</span><span class="pln"> Taille ({taille.toFixed(2)} m) :
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"taille"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"0.5"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"2.5"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"0.01"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{taille}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/label&gt;</span><span class="pln">
</span><span class="tag">&lt;/form&gt;</span><span class="pln">
</span></code></pre>


      </div></div></google-codelab-step><google-codelab-step label="R√©activit√©" duration="5" step="10"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">10. R√©activit√©</h2>
        <p>Nous pouvons modifier les valeurs de <code>poids</code> et <code>taille</code> dans <code>Imc</code> depuis <code>Form</code>, mais cela ne vient pas mettre √† jour la valeur d'<code>imc</code>, ni les styles car les valeurs de <code>imc</code>, <code>thin</code> et <code>bold</code> ne sont calcul√©es qu'√† la cr√©ation du composant. Les √©volutions de valeurs des propri√©t√©s ne sont pas prises en compte.</p>
<p><em>Svelte</em> propose donc une syntaxe pour rendre r√©active une (ou
 plusieurs) ligne de code. Cela permet de re-√©x√©cuter la ligne de code 
en question si une ou plusieurs variables contenues dans cette ligne 
sont modifi√©es.</p>
<p>Pour cela il faut ajouter <code>$:</code> au d√©but de la ligne (si on veut plusieurs lignes, on peut utiliser les <code>{}</code> : <code>$:{ }</code>).</p>
<p>Utilisons cette syntaxe de r√©activit√© dans pour le calcul de l'imc et des classes css <code>thin</code> et <code>bold</code>.</p>
<pre><code language="language-javascript" class="language-javascript"><span class="pln">$</span><span class="pun">:</span><span class="pln"> imc </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">poids </span><span class="pun">/</span><span class="pln"> taille </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span><span class="pun">).</span><span class="pln">toFixed</span><span class="pun">(</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
$</span><span class="pun">:</span><span class="pln"> thin </span><span class="pun">=</span><span class="pln"> imc </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">18</span><span class="pun">;</span><span class="pln">
$</span><span class="pun">:</span><span class="pln"> bold </span><span class="pun">=</span><span class="pln"> imc </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">25</span><span class="pun">;</span></code></pre>
<p>L'IMC est maintenant bien recalcul√© lors de la modification du formulaire.</p>
<aside class="special"><p> Il n'est pas n√©cessaire de d√©clarer la variable avec <code>const</code> ou <code>let</code> lorsque nous utilisons cette syntaxe. Si la variable n'est pas d√©j√† d√©clar√©e avant alors <em>Svelte</em> se charge de le faire pour nous. </p>
</aside>
<p>Cette syntaxe peut √©galement √™tre pratique pour faire du log et suivre les changements de valeurs des variables :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="pln">$</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">poids</span><span class="pun">);</span><span class="pln">
  console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">taille</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<aside class="warning"><p> Cette syntaxe $: n'est pas une invention de <em>Svelte</em>, c'est un d√©tournement d'une syntaxe peu utilis√©e en javascript, les <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/label" target="_blank">labeled statements</a>. </p>
</aside>
<p>Une autre m√©thode permet de s'abonner aux changements des param√®tres 
d'un composant en utilisant les fonctions du cycle de vie d'un composant
 :</p>
<ul>
<li><code>beforeUpdate</code> : la fonction pass√©e en param√®tre est appel√©e avant que les param√®tres ne soient modifi√©s;</li>
<li><code>afterUpdate</code> : la fonction est appel√©e apr√®s que les param√®tres aient √©t√© modifi√©s.</li>
</ul>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> beforeUpdate</span><span class="pun">,</span><span class="pln"> afterUpdate </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"svelte"</span><span class="pun">;</span><span class="pln">

beforeUpdate</span><span class="pun">(()</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">"the component is about to update"</span><span class="pun">);</span><span class="pln">
</span><span class="pun">});</span><span class="pln">

afterUpdate</span><span class="pun">(()</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">"the component just updated"</span><span class="pun">);</span><span class="pln">
  imc </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">poids </span><span class="pun">/</span><span class="pln"> taille </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span><span class="pun">).</span><span class="pln">toFixed</span><span class="pun">(</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
</span><span class="pun">});</span></code></pre>


      </div></div></google-codelab-step><google-codelab-step label="√âv√®nement lors du click sur le bouton" duration="10" step="11"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">11. √âv√®nement lors du click sur le bouton</h2>
        <p>Ajoutons maintenant la possibilit√© de sauvegarder notre IMC. Pour cela il est n√©cessaire d'ajouter un bouton <code>Sauvegarder</code> dans notre formulaire.</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  </span><span class="kwd">export</span><span class="pln"> let poids </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">export</span><span class="pln"> let taille </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;form&gt;</span><span class="pln">
  </span><span class="tag">&lt;label&gt;</span><span class="pln"> Poids ({poids} kg) :
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"poids"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"10"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"200"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"5"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{poids}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/label&gt;</span><span class="pln">

  </span><span class="tag">&lt;label&gt;</span><span class="pln"> Taille ({taille.toFixed(2)} m) :
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"taille"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"0.5"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"2.5"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"0.01"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{taille}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/label&gt;</span><span class="pln">

  </span><span class="tag">&lt;button</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"submit"</span><span class="tag">&gt;</span><span class="pln">Sauvegarder</span><span class="tag">&lt;/button&gt;</span><span class="pln">
</span><span class="tag">&lt;/form&gt;</span><span class="pln">
</span></code></pre>
<h2 is-upgraded="">Event dispatcher</h2>
<p>Pour envoyer un √©v√®nement, nous allons commencer par utiliser le <em>dispatcher</em> de <em>svelte</em>. Apr√®s la cr√©ation d'un <code>eventDispatcher</code> avec le code suivant :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> createEventDispatcher </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"svelte"</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> dispatch </span><span class="pun">=</span><span class="pln"> createEventDispatcher</span><span class="pun">();</span></code></pre>
<p>Nous pouvons maintenant dispatcher des √©v√®nements personnalis√©s :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="pln">dispatch</span><span class="pun">(</span><span class="str">"sauvegarder"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  date</span><span class="pun">,</span><span class="pln">
  imc</span><span class="pun">,</span><span class="pln">
</span><span class="pun">});</span></code></pre>
<p>La fonction dispatch prends 2 arguments:</p>
<ul>
<li>Le nom de l'√©v√®nement.</li>
<li>La valeur √† transmettre dans l'√©v√®nement.</li>
</ul>
<p>Le composant parent peut alors s'abonner √† l'√©v√®nement, de la m√™me fa√ßon qu'un √©v√®nement DOM natif, avec la syntaxe <code>on:sauvegarder={fonction_a_appeler}</code>.</p>
<p>La fonction <code>fonction_a_appeler</code> du composant parent 
recevra alors un argument qui repr√©sente l'√©v√®nement. Les valeurs 
pass√©es dans cet √©v√®nement sont accessibles dans la propri√©t√© <code>detail</code> de cet argument :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">function</span><span class="pln"> fonction_a_appeler</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">"mes valeurs"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">event</span><span class="pun">.</span><span class="pln">detail</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<h2 is-upgraded="">√âv√®nement personnalis√©</h2>
<p>Appliquons ce que nous avons vu pr√©c√©demment avec l'eventDispatcher √† notre composant. Nous √©coutons l'√©v√®nement <code>submit</code> du formulaire et envoyons un √©v√®nement personnalis√© <code>sauvegarder</code>. Nous obtenons le code suivant :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  </span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> createEventDispatcher </span><span class="pun">}</span><span class="pln"> from </span><span class="str">'svelte'</span><span class="pun">;</span><span class="pln">

  </span><span class="kwd">const</span><span class="pln"> dispatch </span><span class="pun">=</span><span class="pln"> createEventDispatcher</span><span class="pun">();</span><span class="pln">
  </span><span class="kwd">export</span><span class="pln"> let taille </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1.8</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">export</span><span class="pln"> let poids </span><span class="pun">=</span><span class="pln"> </span><span class="lit">80</span><span class="pun">;</span><span class="pln">

  </span><span class="kwd">function</span><span class="pln"> handleSubmit</span><span class="pun">(</span><span class="pln">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    dispatch</span><span class="pun">(</span><span class="str">'sauvegarder'</span><span class="pun">,</span><span class="pln"> event</span><span class="pun">.</span><span class="pln">target</span><span class="pun">.</span><span class="pln">poids</span><span class="pun">.</span><span class="pln">value </span><span class="pun">/</span><span class="pln"> </span><span class="pun">(</span><span class="pln">event</span><span class="pun">.</span><span class="pln">target</span><span class="pun">.</span><span class="pln">taille</span><span class="pun">.</span><span class="pln">value </span><span class="pun">*</span><span class="pln"> event</span><span class="pun">.</span><span class="pln">target</span><span class="pun">.</span><span class="pln">taille</span><span class="pun">.</span><span class="pln">value</span><span class="pun">));</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;form</span><span class="pln"> </span><span class="atn">on:submit</span><span class="pun">=</span><span class="atv">{handleSubmit}</span><span class="tag">&gt;</span><span class="pln">
  </span><span class="tag">&lt;label&gt;</span><span class="pln"> Poids ({poids} kg) :
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"poids"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"10"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"200"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"5"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{poids}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/label&gt;</span><span class="pln">

  </span><span class="tag">&lt;label&gt;</span><span class="pln"> Taille ({taille.toFixed(2)} m) :
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"taille"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"0.5"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"2.5"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"0.01"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{taille}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/label&gt;</span><span class="pln">

  </span><span class="tag">&lt;button</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"submit"</span><span class="tag">&gt;</span><span class="pln">Sauvegarder</span><span class="tag">&lt;/button&gt;</span><span class="pln">
</span><span class="tag">&lt;/form&gt;</span></code></pre>
<p>Et dans le fichier <strong>ImcCalculator.svelte</strong>, nous pouvons r√©agir √† l'√©v√®nement de la sorte :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  let taille </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1.8</span><span class="pun">;</span><span class="pln">
  let poids </span><span class="pun">=</span><span class="pln"> </span><span class="lit">80</span><span class="pun">;</span><span class="pln">

  </span><span class="kwd">function</span><span class="pln"> sauvegarderIMC</span><span class="pun">(</span><span class="pln">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">event</span><span class="pun">.</span><span class="pln">detail</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;Form</span><span class="pln"> </span><span class="atn">bind:poids</span><span class="pln"> </span><span class="atn">bind:taille</span><span class="pln"> </span><span class="atn">on:sauvegarder</span><span class="pun">=</span><span class="atv">{sauvegarderIMC}</span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;Imc</span><span class="pln"> {</span><span class="atn">taille</span><span class="pln">} {</span><span class="atn">poids</span><span class="pln">} </span><span class="tag">/&gt;</span></code></pre>
<p><em>Svelte</em> met √† notre disposition une petite astuce pour nous 
simplifier la vie dans ce genre de situation. Nous pouvons transmettre 
directement un event envoy√© par un √©l√©ment au sein de notre composant √† 
son parent.</p>
<p>Et la syntaxe est elle aussi tr√®s simple : <code>on:submit</code>.</p>
<p>C'est tout, rien de plus. Avec cette syntaxe, l'event "onSubmit" sera
 propag√© et peut donc √™tre √©cout√© directement sur le composant parent <code>&lt;Form on:submit={sauvegarderIMC}/&gt;</code></p>
<p>Mais dans notre cas, cela n'est pas une bonne pratique, notre 
composant ne doit pas exposer directement l'√©v√®nement √† son parent. Nous
 transformons l'√©v√©nement natif en un nouvel √©v√®nement m√©tier.</p>
<h2 is-upgraded="">Event modifier</h2>
<p>Une fois ce code impl√©ment√©, vous devriez remarquer que la page est 
rafra√Æchie √† chaque fois que l'on clique sur le bouton, car le bouton 
envoie le formulaire.</p>
<p>Pour corriger cela, il est n√©cessaire en javascript d'appeler la fonction <code>preventDefault</code> sur l'objet <code>event</code> pass√© en param√®tre de la fonction <code>handleSubmit</code>. Mais <em>Svelte</em> nous simplifie la vie en apportant une syntaxe pour ajouter des modifications √† un √©v√®nement.</p>
<p>En ajoutant <code>|preventDefault</code> apr√®s le <code>on:submit</code>, <em>Svelte</em> va automatiquement ex√©cuter le code <code>event.preventDefault()</code> avant d'appeler votre fonction :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;form</span><span class="pln"> </span><span class="atn">on:submit</span><span class="pln">|</span><span class="atn">preventDefault</span><span class="tag">&gt;</span></code></pre>
<aside class="special"><p><a href="https://svelte.dev/docs#on_element_event" target="_blank">D'autres modificateurs</a> sont disponibles : </p>
<ul>
<li><code>stopPropagation</code> : Ex√©cute le code <code>event.stopPropagation()</code> qui permet de ne pas propager l'√©v√®nement sur les noeuds html parents.</li>
<li><code>once</code>: Se d√©sabonne apr√®s avoir re√ßu un √©v√®nement.</li>
<li><code>self</code>: L'√©v√®nement n'est actif que si envoy√© par l'√©l√©ment DOM o√π l'on ajoute l'√©v√®nement.</li>
</ul>
</aside>
<h2 is-upgraded="">Afficher l'historique</h2>
<p>Ajoutons maintenant un tableau qui va contenir l'historique avec la date et l'IMC.</p>
<pre><code language="language-javascript" class="language-javascript"><span class="pln">  </span><span class="kwd">const</span><span class="pln"> historique </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[];</span><span class="pln">
  </span><span class="kwd">function</span><span class="pln"> sauvegarderIMC</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    historique</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">.</span><span class="pln">detail</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span></code></pre>
<p>Reste √† ajouter le code pour afficher les r√©sultats dans le html :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;h3&gt;</span><span class="pln">Evolution de l'IMC</span><span class="tag">&lt;/h3&gt;</span><span class="pln">
</span><span class="tag">&lt;ul&gt;</span><span class="pln">
	{#each historique as item, index}
		</span><span class="tag">&lt;li&gt;</span><span class="pln">{index + 1}: {item.toFixed(2)}</span><span class="tag">&lt;/li&gt;</span><span class="pln">
	{/each}
</span><span class="tag">&lt;/ul&gt;</span></code></pre>
<aside class="special"><p> La balise #each, permet de boucler sur un tableau, pour ensuite afficher chaque √©l√©ment du tableau. </p>
</aside>
<p>En testant notre code, vous remarquerez que l'historique ne s'affiche pas en cliquant sur le bouton. C'est parce que <em>Svelte</em>
 utilise l'affectation d'une variable pour savoir quand une donn√©e est 
modifi√©e. Or lorsque l'on fait un push sur notre tableau, la variable 
n'est pas modifi√©e et donc <em>Svelte</em> ne d√©tecte pas la modification. Utilisez alors la syntaxe de d√©composition pour reconstruire un nouveau tableau :</p>
<pre><code language="language-javascription" class="language-javascription"><span class="pln">	</span><span class="kwd">function</span><span class="pln"> sauvegarderIMC</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		historique </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[...</span><span class="pln">historique</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">event</span><span class="pun">.</span><span class="pln">detail</span><span class="pun">];</span><span class="pln">
	</span><span class="pun">}</span></code></pre>


      </div></div></google-codelab-step><google-codelab-step label="Mise en place du store" duration="10" step="12"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">12. Mise en place du store</h2>
        <h2 is-upgraded="">Pr√©sentation</h2>
<p>La communication entre plusieurs composants via les attributs et les 
√©v√®nements peut vite devenir complexe dans une grosse application. Il 
est donc n√©cessaire de mettre en place un m√©canisme pour partager des 
donn√©es entre les diff√©rents composants. Un pattern est maintenant tr√®s 
utilis√© pour cela dans les applications front, c'est le concept de 
"store". L'id√©e est d'avoir un endroit o√π garder en m√©moire √† tout 
moment, l'√©tat global de l'application.</p>
<p><em>Svelte</em> propose une impl√©mentation de ce pattern en permettant d'√©crire des stores. Il propose trois types de store :</p>
<ul>
<li><strong>writable</strong> : Cas le plus courant, un store qui est modifiable.</li>
<li><strong>readable</strong> : L'application ne peut que lire des 
donn√©es du store, mais pas √©crire (sert pour acc√©der √† des donn√©es 
venant d'une autre source et non modifi√© par l'application : api du 
navigateur, push serveur, temps ...).</li>
<li><strong>derived</strong> : Ce store observe d'autres stores et se met √† jour en fonction des modifications de ces derniers.</li>
</ul>
<h2 is-upgraded="">Un store writable</h2>
<p>Un store <strong>writable</strong> est donc un object qui contient 
une valeur initiale, que nous pouvons ensuite mettre √† jour, et 
s'abonner sur ces mises √† jours :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> writable </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"svelte/store"</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> count </span><span class="pun">=</span><span class="pln"> writable</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">

count</span><span class="pun">.</span><span class="pln">subscribe</span><span class="pun">((</span><span class="pln">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">value</span><span class="pun">);</span><span class="pln">
</span><span class="pun">});</span><span class="pln"> </span><span class="com">// logs '0'</span><span class="pln">

count</span><span class="pun">.</span><span class="kwd">set</span><span class="pun">(</span><span class="lit">1</span><span class="pun">);</span><span class="pln"> </span><span class="com">// logs '1'</span><span class="pln">

count</span><span class="pun">.</span><span class="pln">update</span><span class="pun">((</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln"> </span><span class="com">// logs '2'</span></code></pre>
<h2 is-upgraded="">Cr√©er un store pour stocker le poids et la taille</h2>
<p>Pour cela, cr√©ons un fichier javascript (il ne contient que du code, et pas de template, donc pas n√©cessaire d'avoir un fichier <em>Svelte</em>) <code>stores.js</code> dans le r√©pertoire <code>src/lib</code> qui va contenir la cr√©ation de nos deux stores pour stocker le poids et la taille :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> writable </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"svelte/store"</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">export</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> poids </span><span class="pun">=</span><span class="pln"> writable</span><span class="pun">(</span><span class="lit">80</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">export</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> taille </span><span class="pun">=</span><span class="pln"> writable</span><span class="pun">(</span><span class="lit">1.8</span><span class="pun">);</span></code></pre>
<p>Maintenant, nous pouvons modifier notre fichier <strong>Form.svelte</strong> pour utiliser notre store :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> poids</span><span class="pun">,</span><span class="pln"> taille </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"./stores"</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> onPoidsChange</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  poids</span><span class="pun">.</span><span class="kwd">set</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">.</span><span class="pln">target</span><span class="pun">.</span><span class="pln">value</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> onTailleChange</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  taille</span><span class="pun">.</span><span class="kwd">set</span><span class="pun">(</span><span class="pln">parseFloat</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">.</span><span class="pln">target</span><span class="pun">.</span><span class="pln">value</span><span class="pun">));</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<p>Nous allons repasser dans le premier mode de fonctionnement en s'abonnant directement sur les √©v√®nements des champs <code>poids</code> et <code>taille</code> et supprimer le bouton calculer.</p>
<p>Voici donc le code html du formulaire :</p>
<pre><code><span class="pln">   </span><span class="tag">&lt;form&gt;</span><span class="pln">
     </span><span class="tag">&lt;label&gt;</span><span class="pln"> Poids :
        </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"poids"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"10"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"200"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"5"</span><span class="pln"> </span><span class="atn">on:input</span><span class="pun">=</span><span class="atv">{onPoidsChange}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
     </span><span class="tag">&lt;/label&gt;</span><span class="pln">

     </span><span class="tag">&lt;label&gt;</span><span class="pln"> Taille :
        </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"taille"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"0.5"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"2.5"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"0.01"</span><span class="pln"> </span><span class="atn">on:input</span><span class="pun">=</span><span class="atv">{onTailleChange}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
     </span><span class="tag">&lt;/label&gt;</span><span class="pln">

    </span><span class="tag">&lt;button</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"submit"</span><span class="tag">&gt;</span><span class="pln">Sauvegarder</span><span class="tag">&lt;/button&gt;</span><span class="pln">
   </span><span class="tag">&lt;/form&gt;</span></code></pre>
<aside class="warning"><p> Remarquez que nous avons supprim√© 
provisoirement l'affichage des valeurs dans le champ label, nous verrons
 plus tard comment afficher le contenu du store avec une syntaxe 
simplifi√©e. </p>
</aside>
<p>Dans le fichier <strong>Imc.svelte</strong> dans la balise <code>&lt;script&gt;</code>, ajoutons le code pour r√©cup√©rer les valeurs du store :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> poids </span><span class="kwd">as</span><span class="pln"> storePoids</span><span class="pun">,</span><span class="pln"> taille </span><span class="kwd">as</span><span class="pln"> storeTaille </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"./stores"</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">let</span><span class="pln"> poids</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">let</span><span class="pln"> taille</span><span class="pun">;</span><span class="pln">

storePoids</span><span class="pun">.</span><span class="pln">subscribe</span><span class="pun">((</span><span class="pln">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">poids </span><span class="pun">=</span><span class="pln"> value</span><span class="pun">));</span><span class="pln">
storeTaille</span><span class="pun">.</span><span class="pln">subscribe</span><span class="pun">((</span><span class="pln">value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">taille </span><span class="pun">=</span><span class="pln"> value</span><span class="pun">));</span><span class="pln">

$</span><span class="pun">:</span><span class="pln"> imc </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">poids </span><span class="pun">/</span><span class="pln"> taille </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span><span class="pun">).</span><span class="pln">toFixed</span><span class="pun">(</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
$</span><span class="pun">:</span><span class="pln"> thin </span><span class="pun">=</span><span class="pln"> imc </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">18</span><span class="pun">;</span><span class="pln">
$</span><span class="pun">:</span><span class="pln"> bold </span><span class="pun">=</span><span class="pln"> imc </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">25</span><span class="pun">;</span></code></pre>
<aside class="warning"><p> Attention, le subscribe retourne une fonction
 qui permet de se d√©sabonner. Il faut donc stocker cette fonction dans 
une variable et utiliser le livecycle <code>onDestroy()</code> pour nettoyer les souscriptions et √©viter les fuites m√©moires. La syntaxe simplifi√©e s'en occupe automatiquement. </p>
</aside>
<p>De m√™me le code de la page <em>ImcCalculator.svelte</em> est simplifi√© :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
	</span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Imc</span><span class="pln"> from </span><span class="str">"./Imc.svelte"</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Form</span><span class="pln"> from </span><span class="str">"./Form.svelte"</span><span class="pun">;</span><span class="pln">

	</span><span class="kwd">const</span><span class="pln"> name </span><span class="pun">=</span><span class="pln"> </span><span class="str">"world"</span><span class="pun">;</span><span class="pln">
  let historique </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[];</span><span class="pln">

	</span><span class="kwd">function</span><span class="pln"> sauvegarderIMC</span><span class="pun">(</span><span class="pln">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		historique </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[...</span><span class="pln">historique</span><span class="pun">,</span><span class="pln"> event</span><span class="pun">.</span><span class="pln">detail</span><span class="pun">];</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;main&gt;</span><span class="pln">
	</span><span class="tag">&lt;h1&gt;</span><span class="pln">Calculateur IMC</span><span class="tag">&lt;/h1&gt;</span><span class="pln">
	</span><span class="tag">&lt;p&gt;</span><span class="pln">Bonjour {name} ! Calculez votre IMC (Indice de Masse Corporelle)</span><span class="tag">&lt;/p&gt;</span><span class="pln">
  </span><span class="tag">&lt;Form</span><span class="pln"> </span><span class="atn">on:sauvegarder</span><span class="pun">=</span><span class="atv">{sauvegarderIMC}</span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;Imc</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;h3&gt;</span><span class="pln">Evolution de l'IMC</span><span class="tag">&lt;/h3&gt;</span><span class="pln">
  </span><span class="com">&lt;!-- [...] --&gt;</span><span class="pln">
</span><span class="tag">&lt;/main&gt;</span></code></pre>
<h2 is-upgraded="">Syntaxe simplifi√©e</h2>
<p>La syntaxe avec les m√©thodes <code>set</code> et <code>subscribe</code> n'est pas tr√®s pratique et lisible pour les d√©veloppeurs. <em>Svelte</em> propose donc un m√©canisme pour rendre ce code plus simple et lisible. Pour cela, on va encore utiliser la syntaxe <code>$</code>. Toute variable, pr√©c√©d√© par un <code>$</code> sera utilisable comme une variable de base et se mettra √† jour automatiquement :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> writable </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"svelte/store"</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> count </span><span class="pun">=</span><span class="pln"> writable</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">

$</span><span class="pun">:</span><span class="pln"> console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="pln">$count</span><span class="pun">);</span><span class="pln">

$count </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> </span><span class="com">// logs '1'</span></code></pre>
<p>Cette syntaxe est √©galement disponible dans le template :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"number"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{$count}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;p&gt;</span><span class="pln">Count : {$count}</span><span class="tag">&lt;/p&gt;</span></code></pre>
<aside class="special"><p><em>Svelte</em> propose des fonctions pour cr√©er facilement des stores, mais tout object <code>Observable</code> (qui poss√®de un subscribe, unsubscribe) est consid√©r√© par <em>Svelte</em> comme un store et peut utiliser la syntaxe r√©active de <em>Svelte</em>. </p>
</aside>
<h2 is-upgraded="">Utiliser la syntaxe simplifi√©e dans notre application</h2>
<p>Gr√¢ce √† la syntaxe simplifi√©e, nous pouvons avoir un template tr√®s simple en utilisant <code>$poids</code> et <code>$taille</code> comme si elles √©taient de simple variables.</p>
<p>Dans le fichier <strong>Form.svelte</strong> :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
 </span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> poids</span><span class="pun">,</span><span class="pln"> taille </span><span class="pun">}</span><span class="pln"> from </span><span class="str">'./stores'</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;form&gt;</span><span class="pln">
  </span><span class="tag">&lt;label&gt;</span><span class="pln"> Poids ({$poids} kg) :
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"poids"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"10"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"200"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"5"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{$poids}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/label&gt;</span><span class="pln">

  </span><span class="tag">&lt;label&gt;</span><span class="pln"> Taille ({$taille.toFixed(2)} m) :
    </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"taille"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"range"</span><span class="pln"> </span><span class="atn">min</span><span class="pun">=</span><span class="atv">"0.5"</span><span class="pln"> </span><span class="atn">max</span><span class="pun">=</span><span class="atv">"2.5"</span><span class="pln"> </span><span class="atn">step</span><span class="pun">=</span><span class="atv">"0.01"</span><span class="pln"> </span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{$taille}</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/label&gt;</span><span class="pln">
</span><span class="tag">&lt;/form&gt;</span></code></pre>
<p>Dans le fichier <strong>Imc.svelte</strong> :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
 </span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> poids</span><span class="pun">,</span><span class="pln"> taille </span><span class="pun">}</span><span class="pln"> from </span><span class="str">'./stores'</span><span class="pln">
  $</span><span class="pun">:</span><span class="pln"> imc </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">$poids </span><span class="pun">/</span><span class="pln"> $taille </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span><span class="pun">).</span><span class="pln">toFixed</span><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span><span class="pln">
  $</span><span class="pun">:</span><span class="pln"> thin </span><span class="pun">=</span><span class="pln"> imc </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">18</span><span class="pln">
  $</span><span class="pun">:</span><span class="pln"> bold </span><span class="pun">=</span><span class="pln"> imc </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">25</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class:thin</span><span class="pln"> </span><span class="atn">class:bold</span><span class="tag">&gt;</span><span class="pln">
  Votre IMC ({$poids}/{$taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {imc}
</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>Maintenant, il n'est plus n√©cessaire de faire passer les informations par le composant <code>ImcCalculator</code>. Nous pourrions √©galement avoir d'autres composants qui utilisent ce store.</p>


      </div></div></google-codelab-step><google-codelab-step label="Store d√©riv√©" duration="5" step="13"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">13. Store d√©riv√©</h2>
        <p>En plus des stores simples <strong>writable</strong>, <em>Svelte</em> propose les stores <strong>derived</strong>,
 ce store se met √† jour par la modification d'un ou plusieurs autres 
stores. Ce qui est notre cas, ici, le calcule de l'IMC est un d√©riv√© des
 valeurs du poids et de la taille.</p>
<p>Ajoutons dans le fichier <code>stores.js</code>, ce nouveau store d√©riv√© :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> derived</span><span class="pun">,</span><span class="pln"> writable </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"svelte/store"</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">export</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> poids </span><span class="pun">=</span><span class="pln"> writable</span><span class="pun">(</span><span class="lit">80</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">export</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> taille </span><span class="pun">=</span><span class="pln"> writable</span><span class="pun">(</span><span class="lit">1.8</span><span class="pun">);</span><span class="pln">

</span><span class="kwd">export</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> imc </span><span class="pun">=</span><span class="pln"> derived</span><span class="pun">([</span><span class="pln">poids</span><span class="pun">,</span><span class="pln"> taille</span><span class="pun">],</span><span class="pln"> </span><span class="pun">([</span><span class="pln">$poids</span><span class="pun">,</span><span class="pln"> $taille</span><span class="pun">])</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="pln">$poids </span><span class="pun">/</span><span class="pln"> $taille </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span><span class="pun">).</span><span class="pln">toFixed</span><span class="pun">(</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
</span><span class="pun">});</span></code></pre>
<p>Nous pouvons maintenant supprimer dans le fichier <strong>Imc.svelte</strong> la ligne qui calcule l'IMC est utiliser √† la place la syntaxe simplifi√©e du store d√©riv√©e <code>$imc</code> :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  </span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> poids</span><span class="pun">,</span><span class="pln"> taille</span><span class="pun">,</span><span class="pln"> imc </span><span class="pun">}</span><span class="pln"> from </span><span class="str">'./stores'</span><span class="pln">

  $</span><span class="pun">:</span><span class="pln"> thin </span><span class="pun">=</span><span class="pln"> $imc </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">18</span><span class="pln">
  $</span><span class="pun">:</span><span class="pln"> bold </span><span class="pun">=</span><span class="pln"> $imc </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">25</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class:thin</span><span class="pln"> </span><span class="atn">class:bold</span><span class="tag">&gt;</span><span class="pln">
  Votre IMC ({$poids}/{$taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {$imc}
</span><span class="tag">&lt;/p&gt;</span></code></pre>


      </div></div></google-codelab-step><google-codelab-step label="Animation" duration="10" step="14"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">14. Animation</h2>
        <h2 is-upgraded="">Pr√©sentation</h2>
<p>Maintenant que nous avons une application finalis√©e, ajoutons quelques animations.</p>
<p><em>Svelte</em> permet d'ajouter facilement des animations, en 
pla√ßant simplement des attributs aux balises HTML pour, par exemple, 
ajouter une transition qui pourra s'ex√©cuter √† l'apparition ou la 
disparition d'un √©l√©ment. La syntaxe est simple, nous indiquons la 
transition que l'on veut utiliser, pr√©fix√©e par <code>in:</code> ou <code>out:</code>
 en fonction de si nous souhaitons jouer l'animation √† l'apparition ou √†
 la disparition de l'√©l√©ment. Si la m√™me transition est souhait√©e √† 
l'apparition et la disparition, il suffit d'utiliser le pr√©fixe <code>transition:</code> √† la place de <code>in:</code> et <code>out:</code>. Il existe 6 transitions propos√©es par d√©faut, mais il est possible de cr√©er sa propre transition personnalis√©e.</p>
<ul>
<li><strong>fade</strong> : Change l'opacit√© de l'√©l√©ment.</li>
<li><strong>blur</strong> : Applique un filtre de flou et change l'opacit√©.</li>
<li><strong>fly</strong> : D√©place l'√©l√©ment et change l'opacit√©.</li>
<li><strong>slide</strong> : Masque ou affiche l'√©l√©ment par un effet de slide.</li>
<li><strong>scale</strong> : Affiche ou masque l'√©l√©ment en changeant sa taille.</li>
<li><strong>draw</strong> : Int√©ressant pour un SVG pour avoir un effet de dessin par un crayon.</li>
</ul>
<p>Il est bien s√ªr possible de passer des param√®tres pour personnaliser 
les animations avec, par exemple, la dur√©e de l'animation, ou la 
position initiale :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">in:fly</span><span class="pun">=</span><span class="atv">"{{ y: 200, duration: 2000 }}"</span><span class="pln"> </span><span class="atn">out:fade</span><span class="tag">&gt;</span></code></pre>
<h2 is-upgraded="">Le mettre en place</h2>
<p>Ajoutons maintenant des animations sur les textes qui s'affichent en fonction de la valeur de l'IMC.</p>
<p>Les animations sont √† importer depuis <code>'svelte/transition'</code>. Dans le fichier <strong>Imc.svelte</strong>, nous aurons :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  </span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> poids</span><span class="pun">,</span><span class="pln"> taille</span><span class="pun">,</span><span class="pln"> imc </span><span class="pun">}</span><span class="pln"> from </span><span class="str">'./stores'</span><span class="pln">
  </span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> fly</span><span class="pun">,</span><span class="pln"> fade </span><span class="pun">}</span><span class="pln"> from </span><span class="str">'svelte/transition'</span><span class="pun">;</span><span class="pln">

  $</span><span class="pun">:</span><span class="pln"> thin </span><span class="pun">=</span><span class="pln"> $imc </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">18</span><span class="pln">
  $</span><span class="pun">:</span><span class="pln"> bold </span><span class="pun">=</span><span class="pln"> $imc </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">25</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class:thin</span><span class="pln"> </span><span class="atn">class:bold</span><span class="tag">&gt;</span><span class="pln">
  Votre IMC ({$poids}/{$taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {$imc}
</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{#if thin}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"souspoids"</span><span class="pln"> </span><span class="atn">in:fly</span><span class="pun">=</span><span class="atv">"{{ y: 200, duration: 2000 }}"</span><span class="pln"> </span><span class="atn">out:fade</span><span class="tag">&gt;</span><span class="pln">
    Vous √™tes maigre
  </span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else if bold}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"surpoids"</span><span class="pln"> </span><span class="atn">in:fly</span><span class="pun">=</span><span class="atv">"{{ y: 200, duration: 2000 }}"</span><span class="pln"> </span><span class="atn">out:fade</span><span class="tag">&gt;</span><span class="pln">
    Vous √™tes en surpoids
  </span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"normal"</span><span class="pln"> </span><span class="atn">in:fly</span><span class="pun">=</span><span class="atv">"{{ y: 200, duration: 2000 }}"</span><span class="pln"> </span><span class="atn">out:fade</span><span class="tag">&gt;</span><span class="pln">
    Vous √™tes svelte !
  </span><span class="tag">&lt;/p&gt;</span><span class="pln">
{/if}</span></code></pre>


      </div></div></google-codelab-step><google-codelab-step label="Modifier le titre de la page" duration="5" step="15"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">15. Modifier le titre de la page</h2>
        <p><em>Svelte</em> met √† disposition une collection d'<a href="https://svelte.dev/docs#svelte_self" target="_blank">√©l√©ments sp√©ciaux</a> qui nous donnent acc√®s √† des √©l√©ments d√©j√† existant dans le DOM tel que la balise <code>head</code> ou <code>body</code>. Mais √©galement √† l'objet <code>window</code> pour l'ajout d'events.</p>
<p>Nous pouvons manipuler cela en modifiant le composant <code>Imc</code> pour qu'il mette √† jour le titre de la page avec la valeur calcul√©e de l'IMC.</p>
<p>Pour cela, utilisons l'√©l√©ment sp√©cial <code>&lt;svelte:head&gt;</code> :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  </span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> poids</span><span class="pun">,</span><span class="pln"> taille</span><span class="pun">,</span><span class="pln"> imc </span><span class="pun">}</span><span class="pln"> from </span><span class="str">'./stores'</span><span class="pln">
  </span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> fly</span><span class="pun">,</span><span class="pln"> fade </span><span class="pun">}</span><span class="pln"> from </span><span class="str">'svelte/transition'</span><span class="pun">;</span><span class="pln">

  $</span><span class="pun">:</span><span class="pln"> thin </span><span class="pun">=</span><span class="pln"> $imc </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">18</span><span class="pln">
  $</span><span class="pun">:</span><span class="pln"> bold </span><span class="pun">=</span><span class="pln"> $imc </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">25</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">

</span><span class="tag">&lt;svelte:head&gt;</span><span class="pln">
  </span><span class="tag">&lt;title&gt;</span><span class="pln">Votre IMC : {$imc}</span><span class="tag">&lt;/title&gt;</span><span class="pln">
</span><span class="tag">&lt;/svelte:head&gt;</span><span class="pln">

</span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class:thin</span><span class="pln"> </span><span class="atn">class:bold</span><span class="tag">&gt;</span><span class="pln">
  Votre IMC ({$poids}/{$taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {$imc}
</span><span class="tag">&lt;/p&gt;</span><span class="pln">
{#if thin}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"souspoids"</span><span class="pln"> </span><span class="atn">in:fly</span><span class="pun">=</span><span class="atv">"{{ y: 200, duration: 2000 }}"</span><span class="pln"> </span><span class="atn">out:fade</span><span class="tag">&gt;</span><span class="pln">
    Vous √™tes maigre
  </span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else if bold}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"surpoids"</span><span class="pln"> </span><span class="atn">in:fly</span><span class="pun">=</span><span class="atv">"{{ y: 200, duration: 2000 }}"</span><span class="pln"> </span><span class="atn">out:fade</span><span class="tag">&gt;</span><span class="pln">
    Vous √™tes en surpoids
  </span><span class="tag">&lt;/p&gt;</span><span class="pln">
{:else}
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"normal"</span><span class="pln"> </span><span class="atn">in:fly</span><span class="pun">=</span><span class="atv">"{{ y: 200, duration: 2000 }}"</span><span class="pln"> </span><span class="atn">out:fade</span><span class="tag">&gt;</span><span class="pln">
    Vous √™tes svelte !
  </span><span class="tag">&lt;/p&gt;</span><span class="pln">
{/if}</span></code></pre>
<p>L'ajout de ce code permet √† <em>Svelte</em> de venir modifier la balise <code>title</code> de notre page √† chaque fois que le composant est inclus dans notre page. L'inclusion de <code>{$imc}</code> dans le titre permet √©galement la mise √† jour du titre lorsque la valeur du store <code>imc</code> change.</p>


      </div></div></google-codelab-step><google-codelab-step label="SvelteKit" duration="10" step="16"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">16. SvelteKit</h2>
        <p>Maintenant que nous avons fait le tour des principales fonctionnalit√©s offertes par <em>Svelte</em>, passons √† la vitesse sup√©rieure en d√©couvrant <em>SvelteKit</em>.</p>
<p>SvelteKit est un framework, bas√© sur <em>Svelte</em>, permettant de construire des sites ultra performants en int√©grant notament les fonctionnalit√©s suivantes :</p>
<ul>
<li>Un router</li>
<li>Une api avec de nouvelles fonctionnalit√©s</li>
<li>De la g√©n√©ration de pages c√¥t√© serveur</li>
<li>Une optimisation au build</li>
</ul>
<p>SvelteKit est le rempla√ßant du framework Sapper.</p>
<aside class="warning"><p><em>SvelteKit</em> n'est pas encore en version
 finale, mais son d√©veloppement est suffisamment avanc√© pour s'y 
int√©resser, et pourquoi pas l'utiliser en production (cependant, 
attention aux breaking changes !). </p>
</aside>
<p>SvelteKit utilise le bundler <code>vite</code> qui apporte la fonctionnalit√© de Hot Module Replacement (Recharge le code modifi√© sans m√™me recharger la page).</p>
<p>La force de <em>SvelteKit</em>  c'est de profiter de la puissance du 
compilateur svelte qui va g√©n√©rer tout le code n√©cessaire (et seulement 
celui-ci) pour faire fonctionner votre site et d'y ajouter tout 
l'outillage n√©cessaire facilitant la construction d'applications web 
complexes.</p>
<h2 is-upgraded="">Cr√©er un projet SvelteKit</h2>
<aside class="warning"><p> Votre code est d√©j√† un projet sveltekit, il n'est pas n√©cessaire de recr√©er un projet pour continuer le projet. </p>
</aside>
<p>M√™me si vous avez d√©j√† un projet <em>SvelteKit</em> gr√¢ce au template de projet. La cr√©ation d'un projet <em>Svelte</em>
 est simplifi√©e par une CLI pour cr√©er un projet qui va vous poser un 
certain nombre de questions pour choisir les options que vous voulez 
int√©grer.</p>
<pre><code language="language-sh" class="language-sh"><span class="pln">npm init svelte@next </span><span class="kwd">my</span><span class="pun">-</span><span class="pln">app
cd </span><span class="kwd">my</span><span class="pun">-</span><span class="pln">app
npm install
npm run dev</span></code></pre>
<p>Voici la sortie de la console pour la cr√©ation d'un projet :</p>
<pre><code><span class="pln">$ npm init svelte@next </span><span class="kwd">my</span><span class="pun">-</span><span class="pln">app
</span><span class="typ">Need</span><span class="pln"> to install the following packages</span><span class="pun">:</span><span class="pln">
  create</span><span class="pun">-</span><span class="pln">svelte@next
</span><span class="typ">Ok</span><span class="pln"> to proceed</span><span class="pun">?</span><span class="pln"> </span><span class="pun">(</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> 

create</span><span class="pun">-</span><span class="pln">svelte version </span><span class="lit">2.0</span><span class="pun">.</span><span class="lit">0</span><span class="pun">-</span><span class="kwd">next</span><span class="pun">.</span><span class="lit">98</span><span class="pln">

</span><span class="typ">Welcome</span><span class="pln"> to </span><span class="typ">SvelteKit</span><span class="pln"> 

</span><span class="typ">This</span><span class="pln"> </span><span class="kwd">is</span><span class="pln"> beta software</span><span class="pun">;</span><span class="pln"> expect bugs </span><span class="kwd">and</span><span class="pln"> missing features</span><span class="pun">.</span><span class="pln">

</span><span class="typ">Problems</span><span class="pun">?</span><span class="pln"> </span><span class="typ">Open</span><span class="pln"> an issue on https</span><span class="pun">:</span><span class="com">//github.com/sveltejs/kit/issues if none exists already.</span><span class="pln">

</span><span class="pun">‚úî</span><span class="pln"> </span><span class="typ">Which</span><span class="pln"> </span><span class="typ">Svelte</span><span class="pln"> app </span><span class="kwd">template</span><span class="pun">?</span><span class="pln"> </span><span class="pun">‚Ä∫</span><span class="pln"> </span><span class="typ">_SvelteKit_</span><span class="pln"> demo app
</span><span class="pun">‚úî</span><span class="pln"> </span><span class="typ">Use</span><span class="pln"> </span><span class="typ">TypeScript</span><span class="pun">?</span><span class="pln"> </span><span class="pun">...</span><span class="pln"> </span><span class="typ">No</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="typ">Yes</span><span class="pln">
</span><span class="pun">‚úî</span><span class="pln"> </span><span class="typ">Add</span><span class="pln"> </span><span class="typ">ESLint</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> code linting</span><span class="pun">?</span><span class="pln"> </span><span class="pun">...</span><span class="pln"> </span><span class="typ">No</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="typ">Yes</span><span class="pln">
</span><span class="pun">‚úî</span><span class="pln"> </span><span class="typ">Add</span><span class="pln"> </span><span class="typ">Prettier</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> code formatting</span><span class="pun">?</span><span class="pln"> </span><span class="pun">...</span><span class="pln"> </span><span class="typ">No</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="typ">Yes</span><span class="pln">

</span><span class="typ">Your</span><span class="pln"> project </span><span class="kwd">is</span><span class="pln"> ready</span><span class="pun">!</span><span class="pln">

</span><span class="typ">Install</span><span class="pln"> community</span><span class="pun">-</span><span class="pln">maintained integrations</span><span class="pun">:</span><span class="pln">
  https</span><span class="pun">:</span><span class="com">//github.com/svelte-add/svelte-adders</span><span class="pln">

</span><span class="typ">Next</span><span class="pln"> steps</span><span class="pun">:</span><span class="pln">
  </span><span class="lit">1</span><span class="pun">:</span><span class="pln"> cd </span><span class="kwd">my</span><span class="pun">-</span><span class="pln">app
  </span><span class="lit">2</span><span class="pun">:</span><span class="pln"> npm install </span><span class="pun">(</span><span class="kwd">or</span><span class="pln"> pnpm install</span><span class="pun">,</span><span class="pln"> etc</span><span class="pun">)</span><span class="pln">
  </span><span class="lit">3</span><span class="pun">:</span><span class="pln"> git init </span><span class="pun">&amp;&amp;</span><span class="pln"> git add </span><span class="pun">-</span><span class="pln">A </span><span class="pun">&amp;&amp;</span><span class="pln"> git commit </span><span class="pun">-</span><span class="pln">m </span><span class="str">"Initial commit"</span><span class="pln"> </span><span class="pun">(</span><span class="pln">optional</span><span class="pun">)</span><span class="pln">
  </span><span class="lit">4</span><span class="pun">:</span><span class="pln"> npm run dev </span><span class="pun">--</span><span class="pln"> </span><span class="pun">--</span><span class="pln">open

</span><span class="typ">To</span><span class="pln"> close the dev server</span><span class="pun">,</span><span class="pln"> hit </span><span class="typ">Ctrl</span><span class="pun">-</span><span class="pln">C

</span><span class="typ">Stuck</span><span class="pun">?</span><span class="pln"> </span><span class="typ">Visit</span><span class="pln"> us at https</span><span class="pun">:</span><span class="com">//svelte.dev/chat</span></code></pre>
<h2 is-upgraded="">Un framework sans runtime</h2>
<p>Si vous regardez dans votre package.json, vous n'aurez que des d√©pendances de dev et aucune d√©pendance runtime :</p>
<pre><code language="language-json" class="language-json"><span class="pun">{</span><span class="pln">
  </span><span class="str">"name"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"become-svelte"</span><span class="pun">,</span><span class="pln">
  </span><span class="str">"version"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"0.0.1"</span><span class="pun">,</span><span class="pln">
  </span><span class="str">"scripts"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="str">"dev"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"svelte-kit dev"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"build"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"svelte-kit build"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"package"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"svelte-kit package"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"preview"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"svelte-kit preview"</span><span class="pln">
  </span><span class="pun">},</span><span class="pln">
  </span><span class="str">"devDependencies"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="str">"@sveltejs/adapter-auto"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"next"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"@sveltejs/adapter-netlify"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"^1.0.0-next.38"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"@sveltejs/kit"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"next"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"netlify-cli"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"^8.6.20"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"svelte"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"^3.44.0"</span><span class="pln">
  </span><span class="pun">},</span><span class="pln">
  </span><span class="str">"type"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"module"</span><span class="pln">
</span><span class="pun">}</span></code></pre>


      </div></div></google-codelab-step><google-codelab-step label="Ajouter une nouvelle page" duration="5" step="17"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">17. Ajouter une nouvelle page</h2>
        <p>Cr√©ons une page <code>about.svelte</code> dans le r√©pertoire <code>src/routes</code>. Ajoutons-y un texte sp√©cifiant l'auteur du site :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;p&gt;</span><span class="pln">
Ce site a √©t√© cr√©√© par xxx lors de Devoxx France 2022
</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>La page est maintenant automatiquement disponible sur l'url <a href="http://localhost:3000/about" target="_blank">http://localhost:3000/about</a></p>


      </div></div></google-codelab-step><google-codelab-step label="Ajouter un layout" duration="5" step="18"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">18. Ajouter un layout</h2>
        <p>Il est aussi possible d'avoir un layout commun √† toutes les pages en cr√©ant un fichier <code>__layout.svelte</code> dans le r√©pertoire <code>src/routes</code>.</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">
</span><span class="tag">&lt;header&gt;</span><span class="pln">
	</span><span class="tag">&lt;h1&gt;</span><span class="pln">Devenir Svelte avec Svelte</span><span class="tag">&lt;/h1&gt;</span><span class="pln">
	</span><span class="tag">&lt;nav&gt;</span><span class="pln">
		</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/"</span><span class="tag">&gt;</span><span class="pln">Accueil</span><span class="tag">&lt;/a&gt;</span><span class="pln">
		</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/about"</span><span class="tag">&gt;</span><span class="pln">A propos</span><span class="tag">&lt;/a&gt;</span><span class="pln">
	</span><span class="tag">&lt;/nav&gt;</span><span class="pln">
</span><span class="tag">&lt;/header&gt;</span><span class="pln">
</span><span class="tag">&lt;main&gt;</span><span class="pln">
	</span><span class="tag">&lt;slot&gt;&lt;/slot&gt;</span><span class="pln">
</span><span class="tag">&lt;/main&gt;</span></code></pre>
<aside class="special"><p> La syntaxe <code>slot</code> permet d'indiquer √† <em>Svelte</em>
 d'ins√©rer √† cet emplacement le contenu qui est ajout√© entre les balises
 permettant d'utiliser le composant. Ici, les diff√©rentes pages seront 
affich√©es. </p>
</aside>


      </div></div></google-codelab-step><google-codelab-step label="Ajouter une page de recette" duration="10" step="19"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">19. Ajouter une page de recette</h2>
        <p>Il est possible d'avoir des sous-pages en cr√©ant un r√©pertoire dans le dossier <code>src/routes</code>.</p>
<p>Nous allons ajouter sur notre site une page listant des recettes de cuisine, permettant ensuite d'avoir le d√©tail de la recette.</p>
<p>Cr√©ons un r√©pertoire <code>recettes</code> dans <code>src/routes</code>.</p>
<p>Ensuite, en ajoutant une page <code>index.svelte</code> dans ce r√©pertoire, nous d√©finissons la page qui s'affichera pour l'url <code>/recettes</code>.</p>
<h2 is-upgraded="">Liste des recettes</h2>
<p>Pour la suite, nous avons besoin d'une liste de recettes de cuisine. 
Dans un premier temps, nous allons cr√©er cette liste de recettes dans 
une fichier json. Ajoutons une page <code>recettes.json</code> dans le r√©pertoire <code>src/route/recettes</code> avec les recettes suivantes :</p>
<pre><code language="language-json" class="language-json"><span class="pun">[</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="str">"name"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"Tomates farcies au thon (recette l√©g√®re)"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"image"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"https://assets.afcdn.com/recipe/20130616/20057_w1200h911c1cx256cy192.jpeg"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"totalTime"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">20</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"budget"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"difficulty"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"tags"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="str">"Entr√©e"</span><span class="pun">],</span><span class="pln">
        </span><span class="str">"people"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">4</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"ingredients"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="str">"4 tomates"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1/2 cc de moutarde"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"citron"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1 cc d'herbe de provence"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1 cs d'huile d'olive"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"poivre"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"sel"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"2 boites de thon au naturel"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"120g de cr√®me fraiche all√©g√©e"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1 √©chalotte hach√©e"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"basilique frais"</span><span class="pun">],</span><span class="pln">
        </span><span class="str">"steps"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="pln">
            </span><span class="str">"D√©couper un chapeau dans le haut de chaque tomate pr√©alablement lav√©e."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Evider les tomates √† l'aide d'une cuill√®re, saler l√©g√®rement l'int√©rieur et les retourner sur une grille afin qu'elles s'√©gouttent."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"M√©langer la cr√®me, la moutarde et le reste ingr√©dients avant d'y ajouter le thon √©goutt√© en miettes."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Bien m√©langer le tout."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Remplir chaque tomate de cette farce. Y ajouter les feuilles de basilic pour la pr√©sentation et le go√ªt!"</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"A servir frais, dispos√©s sur un lit de feuilles de salade."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Bon app√©tit."</span><span class="pln">
        </span><span class="pun">],</span><span class="pln">
        </span><span class="str">"credit"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"https://www.marmiton.org/recettes/recette_tomates-farcies-au-thon-recette-legere_81846.aspx"</span><span class="pln">
    </span><span class="pun">},</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="str">"name"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"Dahl de lentilles corail"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"image"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"https://assets.afcdn.com/recipe/20200928/114451_w1200h1877c1cx540cy844cxb1080cyb1689.jpeg"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"totalTime"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">30</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"budget"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"difficulty"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"people"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">4</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"tags"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="str">"Plat"</span><span class="pun">],</span><span class="pln">
        </span><span class="str">"ingredients"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="str">"30 cl de lentilles corail"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"5 tomates"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"4 carottes"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"25cl de lait de coco"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1 gousse d'ail"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1 cs de concentr√© de tomates"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1 cc de curcuma"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1/2 cc de cumin"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1/2 cc de gemgembre"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1/2 cc d'huile de tournesol"</span><span class="pun">],</span><span class="pln">
        </span><span class="str">"steps"</span><span class="pun">:[</span><span class="pln">
            </span><span class="str">"Laver les tomates et les d√©couper en d√©s. Peler les carottes, et les d√©couper en fines rondelles."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Dans une casserole, verser les lentilles corail et couvrir d'eau. Porter √† √©bullition. Laisser cuire pendant 10 min environ, jusqu'√† compl√®te absorption de l'eau. Retire du feu et laisser reposer."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Dans une sauteuse, verser l'huile et chauffer. Y ajouter l'ail qui dorera pendant une petite minute. Verser ensuite les l√©gumes et saupoudrer avec les √©pices. Ajouter enfin le concentr√© de tomate."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Verser le lait de coco et laisser mijoter environ 10 min. sans couvrir."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Enfin, ajouter les lentilles et bien remuer le tout."</span><span class="pln">
        </span><span class="pun">],</span><span class="pln">
        </span><span class="str">"credit"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"https://www.marmiton.org/recettes/recette_dahl-de-lentilles-corail_166862.aspx"</span><span class="pln">
    </span><span class="pun">},</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="str">"name"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"Dessert l√©ger aux fruits de la passion"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"image"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"https://assets.afcdn.com/recipe/20170204/34670_w1200h911c1cx331cy290.jpeg"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"totalTime"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">35</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"budget"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"difficulty"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"people"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">6</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"tags"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="str">"Dessert"</span><span class="pun">],</span><span class="pln">
        </span><span class="str">"ingredients"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="str">"1/2 l de lait"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"2 sachet de sucre vanille"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"75g de sucre"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"50g de farine"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"1 mangue"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"8 fruits de la passion"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"4 oeufs"</span><span class="pun">],</span><span class="pln">
        </span><span class="str">"steps"</span><span class="pun">:[</span><span class="pln">
            </span><span class="str">"Couper la mangue en petits morceaux, et vider les fruits de la passion."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"M√©langer d√©licatement les fruits ensemble, et les disposer dans le fond d'un plat assez creux (type grand saladier). R√©server."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Pr√©parer une cr√®me patissi√®re :"</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"faire bouillir 1/2 l de lait avec les 2 sachets de sucre vanill√©."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Pendant ce temps, m√©langer 3 jaunes d oeufs avec le sucre. On doit obtenir un m√©lange lisse."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Rajouter la farine, et remuer √©nergiquement (p√¢te onctueuse)."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Incorporer le lait et m√©langer. Remettre le tout sur le feu (feux doux), et laisser epaissir la cr√®me sans s'arr√™ter de tourner. Laisser refroidir."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Une fois que la cr√®me p√¢tissi√®re a refroidi, la mettre sur les fruits dans le saladier."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Battre 4 blancs en neige, et en recouvrir les fruits et la cr√®me patissi√®re."</span><span class="pun">,</span><span class="pln">
            </span><span class="str">"Mettre le saladier 3 min au grill, pour faire dorer les blancs en neige. Laisser refroidir, et conserver au frigo avant de servir."</span><span class="pln">
        </span><span class="pun">],</span><span class="pln">
        </span><span class="str">"credit"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"https://www.marmiton.org/recettes/recette_dessert-leger-aux-fruits-de-la-passion_43479.aspx"</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">]</span></code></pre>
<h2 is-upgraded="">Afficher la liste des recettes</h2>
<p>Pour afficher ces recettes, nous avons juste √† importer dans notre page <em>Svelte</em> le fichier json cr√©√© pr√©c√©demment.</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
    </span><span class="kwd">import</span><span class="pln"> recettes from </span><span class="str">"./recettes.json"</span><span class="pun">;</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<p>Nous pouvons ensuite parcourir la liste pour afficher les diff√©rentes recettes :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;section</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"recettes"</span><span class="tag">&gt;</span><span class="pln">
    {#each recettes as item, index (item.name)}
        </span><span class="tag">&lt;article&gt;</span><span class="pln">
            </span><span class="tag">&lt;div&gt;</span><span class="pln">
              </span><span class="tag">&lt;h2&gt;</span><span class="pln">{item.name}</span><span class="tag">&lt;/h2&gt;</span><span class="pln">
              </span><span class="tag">&lt;p&gt;</span><span class="pln">‚è± {item.totalTime} min üë®‚Äçüç≥ {['', 'Tr√®s Facile', 'Facile', 'Moyenne', 'Difficile'][item.difficulty || 0]} ‚Ç¨ {['', 'Bon march√©', 'Moyen', 'Assez cher'][item.budget||0]} üòã {item.people} Personnes</span><span class="tag">&lt;/p&gt;</span><span class="pln">
            </span><span class="tag">&lt;/div&gt;</span><span class="pln">
            </span><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">{item.image}</span><span class="pln"> </span><span class="atn">alt</span><span class="pun">=</span><span class="atv">{item.name}</span><span class="tag">&gt;</span><span class="pln">
        </span><span class="tag">&lt;/article&gt;</span><span class="pln">
    {/each}
</span><span class="tag">&lt;/section&gt;</span></code></pre>
<aside class="special"><p> La syntaxe <code>{#each recettes as item (item.name)}{/each}</code>
 permet d'it√©rer sur un tableau pour afficher une liste en cr√©ant une 
variable item pour r√©ccup√©rer l'√©l√©ment en cours lors de l'it√©ration. Le
 <code>(item.name)</code> permet d'indiquer la cl√© de notre √©l√©ment et ainsi permettre d'optimiser le rendu si l'√©l√©ment DOM existe d√©j√†. </p>
</aside>
<p>N'oublions pas d'ajouter le lien permettant d'acc√©der √† cette nouvelle page dans le fichier de layout :</p>
<pre><code language="language-html" class="language-html"><span class="pln">	</span><span class="tag">&lt;nav&gt;</span><span class="pln">
		</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/"</span><span class="tag">&gt;</span><span class="pln">Accueil</span><span class="tag">&lt;/a&gt;</span><span class="pln">
		</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/recettes"</span><span class="tag">&gt;</span><span class="pln">Recettes</span><span class="tag">&lt;/a&gt;</span><span class="pln">
		</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/about"</span><span class="tag">&gt;</span><span class="pln">A propos</span><span class="tag">&lt;/a&gt;</span><span class="pln">
	</span><span class="tag">&lt;/nav&gt;</span></code></pre>


      </div></div></google-codelab-step><google-codelab-step label="Afficher une page de d√©tail" duration="10" step="20"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">20. Afficher une page de d√©tail</h2>
        <p>Cr√©ons maintenant une page <code>[id].svelte</code> qui sera appel√©e par les url <code>/recettes/1</code> ou <code>recettes/2</code> par exemple. La variable <code>id</code> sera alors disponible directement dans la page avec la valeur pass√©e en param√®tre.</p>
<p>Pour r√©cup√©rer les parametres <em>SvelteKit</em> fournit un <strong>store </strong><code>page</code> depuis <code>$app/stores</code> qui permet de r√©cup√©rer les parametres et autres informations sur la page :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> page </span><span class="pun">}</span><span class="pln"> from </span><span class="str">'$app/stores'</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> recettes from </span><span class="str">"./recettes.json"</span><span class="pun">;</span><span class="pln">

let recette </span><span class="pun">=</span><span class="pln"> recettes</span><span class="pun">[</span><span class="pln">$page</span><span class="pun">.</span><span class="pln">params</span><span class="pun">.</span><span class="pln">id</span><span class="pun">]</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<p>Maintenant affichons le d√©tail d'une recette :</p>
<pre><code language="language-svletehtml" class="language-svletehtml"><span class="tag">&lt;section</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"recette"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">{recette.image}</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;h2&gt;</span><span class="pln">{recette.name}</span><span class="tag">&lt;/h2&gt;</span><span class="pln">
    </span><span class="tag">&lt;h3&gt;</span><span class="pln">‚è± {recette.totalTime} min üë®‚Äçüç≥ {['', 'Tr√®s Facile', 'Facile', 'Moyenne', 'Difficile'][recette.difficulty || 0]} ‚Ç¨ {['', 'Bon march√©', 'Moyen', 'Assez cher'][recette.budget||0]} üòã {recette.people} Personnes</span><span class="tag">&lt;/h3&gt;</span><span class="pln">
    
    </span><span class="tag">&lt;ul&gt;</span><span class="pln">
        {#each recette?.ingredients as ingredient}
            </span><span class="tag">&lt;li&gt;</span><span class="pln">{ingredient}</span><span class="tag">&lt;/li&gt;</span><span class="pln">
        {/each}
    </span><span class="tag">&lt;/ul&gt;</span><span class="pln">
    </span><span class="tag">&lt;dl&gt;</span><span class="pln">
        {#each recette?.steps as step, index}
            </span><span class="tag">&lt;dt&gt;</span><span class="pln">Etape {index+1}</span><span class="tag">&lt;/dt&gt;</span><span class="pln">
            </span><span class="tag">&lt;dd&gt;</span><span class="pln">{step}</span><span class="tag">&lt;/dd&gt;</span><span class="pln">
        {/each}
    </span><span class="tag">&lt;/dl&gt;</span><span class="pln">
</span><span class="tag">&lt;/section&gt;</span></code></pre>
<aside class="special"><p> La syntaxe <code>{#each recettes as item, index}{/each}</code> permet de r√©cup√©rer l'index courant du tableau dans la variable `index`. </p>
</aside>
<h2 is-upgraded="">Ajoutons un lien</h2>
<p>Sur la page de recette, il est maintenant n√©cessaire d'ajouter un lien vers la page de d√©tail.</p>
<p>Pour cela r√©cup√©rons l'index de la recette et ajoutons simplement une ligne vers <code>/recettes/{index}</code> comme ceci :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="pln">    </span><span class="pun">{#</span><span class="pln">each recettes </span><span class="kwd">as</span><span class="pln"> item</span><span class="pun">,</span><span class="pln"> index </span><span class="pun">(</span><span class="pln">item</span><span class="pun">.</span><span class="pln">name</span><span class="pun">)}</span><span class="pln">
        </span><span class="str">&lt;article&gt;</span><span class="pln">
            </span><span class="str">&lt;div&gt;</span><span class="pln">
                </span><span class="str">&lt;h2&gt;</span><span class="pun">&lt;</span><span class="pln">a href</span><span class="pun">=</span><span class="str">"/recettes/{index}"</span><span class="pun">&gt;{</span><span class="pln">item</span><span class="pun">.</span><span class="pln">name</span><span class="pun">}&lt;</span><span class="str">/a&gt;&lt;/</span><span class="pln">h2</span><span class="pun">&gt;</span></code></pre>
<p><em>Svelte</em> va automatiquement g√©rer la navigation de la page vers la page de d√©tail sans rechargement.</p>
<aside class="special"><p> Par d√©faut, _Svelte_ va intercepter les clics
 sur les liens `a` pour ne pas recharger la page sur les urls internes. 
Si besoin, nous pouvons d√©sactiver ce comportement en ajoutant 
l'attribut `rel="external"` sur le lien. </p>
</aside>
<h2 is-upgraded="">Changement de page dynamique</h2>
<p>Ajoutons en bas de la page de d√©tail, des liens pour naviguer automatiquement √† la recette suivante ou pr√©c√©dente :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;nav</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"recette-nav"</span><span class="tag">&gt;</span><span class="pln">
	{#if $page.params.id &gt; 0}
	</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/recettes/{Number($page.params.id) - 1}"</span><span class="tag">&gt;</span><span class="pln">Pr√©c√©dent</span><span class="tag">&lt;/a&gt;</span><span class="pln">
	{/if}
	{#if $page.params.id &lt; 2}
	</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/recettes/{Number($page.params.id) + 1}"</span><span class="tag">&gt;</span><span class="pln">Suivant</span><span class="tag">&lt;/a&gt;</span><span class="pln">
	{/if}
</span><span class="tag">&lt;/nav&gt;</span></code></pre>
<p>Testons maintenant ce lien. Nous remarquons que le changement de page ne fonctionne pas, la page ne r√©agit pas.</p>
<p>La r√©cup√©ration du param√®tre dans le store de la page est une notion 
dite "r√©active". Le composant de la page n'est pas r√©initilis√© lorsque 
nous changeons simplement un param√®tre de la page.</p>
<p>Pour que notre navigation fonctionne, il est donc n√©cessaire d'utiliser la syntaxe de r√©activit√© de <em>Svelte</em> pour r√©cup√©rer la bonne recette :</p>
<pre><code language="language-javascript" class="language-javascript"><span class="pln">$</span><span class="pun">:</span><span class="pln"> recette </span><span class="pun">=</span><span class="pln"> recettes</span><span class="pun">[</span><span class="pln">$page</span><span class="pun">.</span><span class="kwd">params</span><span class="pun">.</span><span class="pln">id</span><span class="pun">]</span></code></pre>


      </div></div></google-codelab-step><google-codelab-step label="Accessibilit√©" duration="5" step="21"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">21. Accessibilit√©</h2>
        <p>Peut-√™tre l'avez vous remarqu√©, lors de la cr√©ation de la page affichant une recette, <em>Svelte</em>
 nous a indiqu√© via un warning dans le terminal, d'un probl√®me 
d'accessibilit√© dans notre code. (Si vous utiliser un plugin dans l'IDE,
 l'erreur est √©galement affich√©e).</p>
<pre><code><span class="lit">17</span><span class="pun">:</span><span class="lit">47</span><span class="pun">:</span><span class="lit">21</span><span class="pln"> </span><span class="pun">[</span><span class="pln">vite</span><span class="pun">-</span><span class="pln">plugin</span><span class="pun">-</span><span class="pln">svelte</span><span class="pun">]</span><span class="pln"> become</span><span class="pun">-</span><span class="pln">svelte</span><span class="pun">/</span><span class="pln">src</span><span class="pun">/</span><span class="pln">routes</span><span class="pun">/</span><span class="pln">recettes</span><span class="pun">/[</span><span class="pln">id</span><span class="pun">].</span><span class="pln">svelte</span><span class="pun">:</span><span class="lit">9</span><span class="pun">:</span><span class="lit">4</span><span class="pln">
A11y</span><span class="pun">:</span><span class="pln"> </span><span class="str">&lt;img&gt;</span><span class="pln"> element should have an alt attribute</span></code></pre>
<p>Ce warning nous indique que nous n'avons pas mis d'attribut <code>alt</code> √† notre balise <code>img</code>.</p>
<p>Pour corriger ceci, renseignons par exemple l'attribut <code>alt</code> comme ceci :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">{recette.image}</span><span class="pln"> </span><span class="atn">alt</span><span class="pun">=</span><span class="atv">"Photo de la recette {recette.name}"</span><span class="tag">&gt;</span></code></pre>
<p>Retrouvez dans la <a href="https://svelte.dev/docs#accessibility-warnings" target="_blank">documentation</a>, la liste des erreurs d'accessibilit√© prises en compte.</p>


      </div></div></google-codelab-step><google-codelab-step label="Ajouter du code serveur" duration="10" step="22"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">22. Ajouter du code serveur</h2>
        <p>L'import d'un fichier json dans notre page inclut directement
 ce fichier dans le code javascript et est donc charg√© d√®s que l'on 
affiche notre site. Si la liste de recettes grossie, les performances de
 notre site seront impact√©es.</p>
<p>La force de <em>SvelteKit</em>  c'est aussi de permettre d'√©crire du code front et back au m√™me endroit, sans distinction.</p>
<p>Un fichier au format <code>.svelte</code> sera affich√© dans le front, alors qu'un fichier au format <code>.js</code> (ou <code>.ts</code> si nous utilisons TypeScript) sera alors execut√© c√¥t√© serveur.</p>
<p>Lorsque nous ajoutons une extension juste avant le <code>.js</code>, alors l'url prendra en compte cette derni√®re pour d√©finir le type du fichier. Par exemple, le fichier <code>recettes.json.js</code>
 sera alors accessible par l'url ‚Äò/recettes.json'. Il est conseill√© 
d'utiliser ce type d'extesion si nos pages et notre API se trouvent 
exactement au m√™me endroit. Sinon ,entre le fichier <code>recettes.svelte</code> ou <code>recettes.js</code>, <em>SvelteKit</em> appellera en priorit√© le fichier <code>.js</code>.</p>
<h2 is-upgraded="">/recettes.json</h2>
<p>D√©veloppons maintenant une API pour r√©cup√©rer les recettes, et ne pas
 importer l'int√©gralit√© de notre fichier json dans nos pages html.</p>
<p>Pour ce faire, commencons par cr√©er une page <code>index.json.js</code> dans le r√©pertoire <code>src/route/recettes</code></p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> recettes </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"./recettes.json"</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">export</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="kwd">get</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        body</span><span class="pun">:</span><span class="pln"> recettes</span><span class="pun">.</span><span class="pln">map</span><span class="pun">(({</span><span class="pln"> ingredients</span><span class="pun">,</span><span class="pln"> steps</span><span class="pun">,</span><span class="pln"> credit</span><span class="pun">,</span><span class="pln"> </span><span class="pun">...</span><span class="pln">rest </span><span class="pun">})</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> rest</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<p>Pour √©crire le code serveur, nous ajoutons et exportons une fonction du nom de la m√©thode http que nous voulons g√©rer (ici GET).</p>
<p>La fonction doit retourner un objet avec les propri√©t√©s suivantes :</p>
<ul>
<li>status : Status HTTP de la r√©ponse, si celui-ci n'est pas indiqu√©, indique le status 200.</li>
<li>headers : Si nous voulons indiquer des headers. √Ä ajouter soit sous la forme d'une liste de string ou d'un objet cl√©/valeur.</li>
<li>body : Si le body est de type <code>object</code> et que nous n'avons pas donn√© de contentType dans les headers, alors l'objet est automatiquement transform√© en json.</li>
</ul>
<p>Nous avons maintenant une URL <a href="http://localhost:3000/recettes.json" target="_blank">/recettes.json</a> qui retourne notre liste de recettes (auxquelles nous avons supprim√© les propri√©t√©s ingredients et steps).</p>
<h2 is-upgraded="">/recettes/1.json</h2>
<p>Ajoutons maintenant une API pour r√©cup√©rer une recette selon son <code>id</code>. Pour cela cr√©ons une page <code>[id].json.js</code> dans le r√©pertoire <code>src/route/recettes</code>.</p>
<pre><code language="language-javascript" class="language-javascript"><span class="kwd">import</span><span class="pln"> recettes </span><span class="kwd">from</span><span class="pln"> </span><span class="str">"./recettes.json"</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">export</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="kwd">get</span><span class="pun">({</span><span class="pln"> </span><span class="kwd">params</span><span class="pln"> </span><span class="pun">})</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        body</span><span class="pun">:</span><span class="pln"> recettes</span><span class="pun">[</span><span class="kwd">params</span><span class="pun">.</span><span class="pln">id</span><span class="pun">]</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<p>La fonction export√©e, est appel√©e avec un argument qui contient les informations suivantes :</p>
<ul>
<li>request : L'objet request de node avec toutes les informations qu'il contient (headers, queryParams, body, ...).</li>
<li>url : L'url de la page.</li>
<li>params : Une map avec les param√®tres de la page (les param√®tres entre [] dans le nom du fichier).</li>
</ul>
<p>Nous avons maintenant une URL <a href="http://localhost:3000/recettes/0.json" target="_blank">/recettes/0.json</a> qui retourne la premi√®re recette de notre liste.</p>


      </div></div></google-codelab-step><google-codelab-step label="Utiliser notre API" duration="10" step="23"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">23. Utiliser notre API</h2>
        <p>Il est maintenant n√©cessaire de modifier nos page svelte pour utiliser notre API.</p>
<p>Ce code doit √™tre execut√© √©galement c√¥t√© serveur lors du server side rendering, il est donc n√©cessaire d'utiliser la balise <code>&lt;script context="module"&gt;</code>.</p>
<p>Sveltekit permet d'√©crire une fonction nomm√©e <code>load</code> qui 
va s'executer lors du chargement de la page. Cette fonction peut 
retourner un objet props qui contient les param√®tres que l'on veut faire
 passer √† notre page qui poss√®de alors une propri√©t√© en entr√©e du 
composant (via <code>export let propname;</code>).</p>
<h2 is-upgraded="">Page des recettes</h2>
<p>Rempla√ßons dans la page <code>index.svelte</code>, la balise script par le code suivant :</p>
<pre><code><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">context</span><span class="pun">=</span><span class="atv">"module"</span><span class="tag">&gt;</span><span class="pln">
	</span><span class="com">/** @type {import('@sveltejs/kit').Load} */</span><span class="pln">
	</span><span class="kwd">export</span><span class="pln"> async </span><span class="kwd">function</span><span class="pln"> load</span><span class="pun">({</span><span class="pln"> fetch </span><span class="pun">})</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">const</span><span class="pln"> url </span><span class="pun">=</span><span class="pln"> </span><span class="pun">`/</span><span class="pln">recettes</span><span class="pun">.</span><span class="pln">json</span><span class="pun">`;</span><span class="pln">
		</span><span class="kwd">const</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> await fetch</span><span class="pun">(</span><span class="pln">url</span><span class="pun">);</span><span class="pln">

		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">res</span><span class="pun">.</span><span class="pln">ok</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				props</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
					recettes</span><span class="pun">:</span><span class="pln"> await res</span><span class="pun">.</span><span class="pln">json</span><span class="pun">()</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
			</span><span class="pun">};</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">

		</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			status</span><span class="pun">:</span><span class="pln"> res</span><span class="pun">.</span><span class="pln">status</span><span class="pun">,</span><span class="pln">
			error</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Error</span><span class="pun">(`</span><span class="typ">Could</span><span class="pln"> not load $</span><span class="pun">{</span><span class="pln">url</span><span class="pun">}`)</span><span class="pln">
		</span><span class="pun">};</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">
</span><span class="tag">&lt;script&gt;</span><span class="pln">
    </span><span class="kwd">export</span><span class="pln"> let recettes </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[];</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<h2 is-upgraded="">Page d√©tail d'une recette</h2>
<p>Rempla√ßons la balise <code>script</code> par le code suivant :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">context</span><span class="pun">=</span><span class="atv">"module"</span><span class="tag">&gt;</span><span class="pln">
	</span><span class="com">/** @type {import('@sveltejs/kit').Load} */</span><span class="pln">
	</span><span class="kwd">export</span><span class="pln"> async </span><span class="kwd">function</span><span class="pln"> load</span><span class="pun">({</span><span class="pln"> params</span><span class="pun">,</span><span class="pln"> fetch </span><span class="pun">})</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">const</span><span class="pln"> url </span><span class="pun">=</span><span class="pln"> </span><span class="pun">`/</span><span class="pln">recettes</span><span class="pun">/</span><span class="pln">$</span><span class="pun">{</span><span class="pln">params</span><span class="pun">.</span><span class="pln">id</span><span class="pun">}.</span><span class="pln">json</span><span class="pun">`;</span><span class="pln">
		</span><span class="kwd">const</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> await fetch</span><span class="pun">(</span><span class="pln">url</span><span class="pun">);</span><span class="pln">

		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">res</span><span class="pun">.</span><span class="pln">ok</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				props</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
					recette</span><span class="pun">:</span><span class="pln"> await res</span><span class="pun">.</span><span class="pln">json</span><span class="pun">()</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
			</span><span class="pun">};</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">

		</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			status</span><span class="pun">:</span><span class="pln"> res</span><span class="pun">.</span><span class="pln">status</span><span class="pun">,</span><span class="pln">
			error</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Error</span><span class="pun">(`</span><span class="typ">Could</span><span class="pln"> not load $</span><span class="pun">{</span><span class="pln">url</span><span class="pun">}`)</span><span class="pln">
		</span><span class="pun">};</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span><span class="pln">
</span><span class="tag">&lt;script&gt;</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> page </span><span class="pun">}</span><span class="pln"> from </span><span class="str">'$app/stores'</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">export</span><span class="pln"> let recette</span><span class="pun">;</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<p>La fonction <code>load</code>, permet de r√©cup√©rer plusieurs √©l√©ments :</p>
<ul>
<li>url : Url de la page.</li>
<li>params : Les param√®tres de la page (param√®tres entre [] dans le nom du fichier).</li>
<li>fetch : Fonction pour faire des appels http, identique √† fetch 
natif, sauf qu'il g√®re le fait d'√™tre appel√© c√¥t√© serveur ou c√¥t√© client
 (enregistre le retour de l'appel c√¥t√© server pour le serialiser dans le
 code de la page et r√©utiliser la valeur c√¥t√© client).</li>
<li>session : Donn√©e de session qui est accessible c√¥t√© serveur et c√¥t√© client.</li>
<li>stuff : Donn√©e que l'on r√©ucup√®re depuis le layout.</li>
</ul>
<p>La m√©thode retourne un objet avec les propri√©t√©s suivantes :</p>
<ul>
<li>status : Status HTTP de la page.</li>
<li>error : Si la fonction load a une erreur (status doit alors est de type 4xx ou 5xx)</li>
<li>redirect : Pour rediriger vers une autre page (status doit √™tre de type 3xx)</li>
<li>maxage : indique la dur√©e de mise en cache de la page</li>
<li>props : les informations que l'on passe au composant de la page lors de son affichage</li>
<li>stuff : informations qui est pass√© aux sous-pages (que l'on r√©cup√®re ensuite dans les param√®tres de la fonction load)</li>
</ul>


      </div></div></google-codelab-step><google-codelab-step label="SSR" duration="5" step="24"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">24. SSR</h2>
        <p>Le serveur side rendering permet de g√©n√©rer le code html sur 
le serveur avant d'envoyer le r√©sultat directement au navigateur. 
L'int√©r√™t est d'am√©liorer les performances de la page, car il suffit 
alors au navigateur d'afficher le resultat sans devoir construire toute 
la page.</p>
<p>Ce fonctionnement est automatique et disponible par d√©faut. <em>Svelte</em>
 c√¥t√© serveur va g√©n√©rer un √©tat de la page qui sera alors utilis√© par 
le code javascript c√¥t√© front pour s'initialiser et ainsi pouvoir 
ajouter l'interaction automatiquement.</p>
<p>Si vous regarder le code source d'une page, vous y verrez alors la totalit√© du html qui est g√©n√©r√© :</p>
<pre><code language="language-html" class="language-html"><span class="dec">&lt;!DOCTYPE html&gt;</span><span class="pln">
</span><span class="tag">&lt;html</span><span class="pln"> </span><span class="atn">lang</span><span class="pun">=</span><span class="atv">"en"</span><span class="tag">&gt;</span><span class="pln">
	</span><span class="tag">&lt;head&gt;</span><span class="pln">
		</span><span class="tag">&lt;meta</span><span class="pln"> </span><span class="atn">charset</span><span class="pun">=</span><span class="atv">"utf-8"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
		</span><span class="tag">&lt;meta</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"description"</span><span class="pln"> </span><span class="atn">content</span><span class="pun">=</span><span class="atv">""</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
		</span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"icon"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"./favicon.png"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
		</span><span class="tag">&lt;link</span><span class="pln">
			</span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://fonts.googleapis.com/css2?family=Fredoka+One&amp;display=swap"</span><span class="pln">
			</span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"stylesheet"</span><span class="pln">
		</span><span class="tag">/&gt;</span><span class="pln">
		</span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"stylesheet"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"./global.css"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
		</span><span class="tag">&lt;meta</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"viewport"</span><span class="pln"> </span><span class="atn">content</span><span class="pun">=</span><span class="atv">"width=device-width, initial-scale=1"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
		</span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"stylesheet"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/_app/assets/start-61d1577b.css"</span><span class="tag">&gt;</span><span class="pln">
		</span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"modulepreload"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/_app/start-53bce2a1.js"</span><span class="tag">&gt;</span><span class="pln">
		</span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"modulepreload"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/_app/chunks/vendor-fa2d59c6.js"</span><span class="tag">&gt;</span><span class="pln">
		</span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"modulepreload"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/_app/pages/__layout.svelte-d673c1f6.js"</span><span class="tag">&gt;</span><span class="pln">
		</span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"modulepreload"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/_app/pages/recettes/index.svelte-7cee68ff.js"</span><span class="tag">&gt;</span><span class="pln">
		</span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"modulepreload"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/_app/chunks/recette-6ce5406e.js"</span><span class="tag">&gt;</span><span class="pln">
		</span><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"module"</span><span class="tag">&gt;</span><span class="pln">
			</span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> start </span><span class="pun">}</span><span class="pln"> from </span><span class="str">"/_app/start-53bce2a1.js"</span><span class="pun">;</span><span class="pln">
			start</span><span class="pun">({</span><span class="pln">
				target</span><span class="pun">:</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">querySelector</span><span class="pun">(</span><span class="str">"#svelte"</span><span class="pun">),</span><span class="pln">
				paths</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str">"base"</span><span class="pun">:</span><span class="str">""</span><span class="pun">,</span><span class="str">"assets"</span><span class="pun">:</span><span class="str">""</span><span class="pun">},</span><span class="pln">
				session</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{},</span><span class="pln">
				route</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln">
				spa</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln">
				trailing_slash</span><span class="pun">:</span><span class="pln"> </span><span class="str">"never"</span><span class="pun">,</span><span class="pln">
				hydrate</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
					status</span><span class="pun">:</span><span class="pln"> </span><span class="lit">200</span><span class="pun">,</span><span class="pln">
					error</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">,</span><span class="pln">
					nodes</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="pln">
						</span><span class="kwd">import</span><span class="pun">(</span><span class="str">"/_app/pages/__layout.svelte-d673c1f6.js"</span><span class="pun">),</span><span class="pln">
						</span><span class="kwd">import</span><span class="pun">(</span><span class="str">"/_app/pages/recettes/index.svelte-7cee68ff.js"</span><span class="pun">)</span><span class="pln">
					</span><span class="pun">],</span><span class="pln">
					url</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URL</span><span class="pun">(</span><span class="str">"https://become-svelte.patou.dev/recettes"</span><span class="pun">),</span><span class="pln">
					params</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
			</span><span class="pun">});</span><span class="pln">
		</span><span class="tag">&lt;/script&gt;</span><span class="pln">
	</span><span class="tag">&lt;/head&gt;</span><span class="pln">
	</span><span class="tag">&lt;body&gt;</span><span class="pln">
		</span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"svelte"</span><span class="tag">&gt;</span><span class="pln">
      </span><span class="tag">&lt;header&gt;&lt;h1&gt;</span><span class="pln">Devenir Svelte avec Svelte</span><span class="tag">&lt;/h1&gt;</span><span class="pln">
      </span><span class="tag">&lt;nav&gt;&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/"</span><span class="tag">&gt;</span><span class="pln">Accueil</span><span class="tag">&lt;/a&gt;</span><span class="pln">
        </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/recettes"</span><span class="tag">&gt;</span><span class="pln">Recettes</span><span class="tag">&lt;/a&gt;</span><span class="pln">
        </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/about"</span><span class="tag">&gt;</span><span class="pln">A propos</span><span class="tag">&lt;/a&gt;&lt;/nav&gt;&lt;/header&gt;</span><span class="pln">
        </span><span class="tag">&lt;main&gt;&lt;section</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"recettes"</span><span class="tag">&gt;&lt;article&gt;&lt;h2&gt;&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/recettes/0"</span><span class="tag">&gt;</span><span class="pln">Tomates farcies au thon (recette l√©g√®re)</span><span class="tag">&lt;/a&gt;&lt;/h2&gt;</span><span class="pln">
            </span><span class="tag">&lt;h3&gt;</span><span class="pln">‚è± 20 min üë®‚Äçüç≥ Tr√®s facile ‚Ç¨ Bon march√© üòã 4 Personnes</span><span class="tag">&lt;/h3&gt;</span><span class="pln">
            </span><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"https://assets.afcdn.com/recipe/20130616/20057_w1200h911c1cx256cy192.jpeg"</span><span class="pln"> </span><span class="atn">alt</span><span class="pun">=</span><span class="atv">"Tomates farcies au thon (recette l√©g√®re)"</span><span class="tag">&gt;</span><span class="pln">
        </span><span class="tag">&lt;/article&gt;&lt;article&gt;&lt;h2&gt;&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/recettes/1"</span><span class="tag">&gt;</span><span class="pln">Dahl de lentilles corail</span><span class="tag">&lt;/a&gt;&lt;/h2&gt;</span><span class="pln">
            </span><span class="tag">&lt;h3&gt;</span><span class="pln">‚è± 30 min üë®‚Äçüç≥ Facile ‚Ç¨ Bon march√© üòã 4 Personnes</span><span class="tag">&lt;/h3&gt;</span><span class="pln">
            </span><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"https://assets.afcdn.com/recipe/20200928/114451_w1200h1877c1cx540cy844cxb1080cyb1689.jpeg"</span><span class="pln"> </span><span class="atn">alt</span><span class="pun">=</span><span class="atv">"Dahl de lentilles corail"</span><span class="tag">&gt;</span><span class="pln">
        </span><span class="tag">&lt;/article&gt;&lt;article&gt;&lt;h2&gt;&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/recettes/2"</span><span class="tag">&gt;</span><span class="pln">Dessert l√©ger aux fruits de la passion</span><span class="tag">&lt;/a&gt;&lt;/h2&gt;</span><span class="pln">
            </span><span class="tag">&lt;h3&gt;</span><span class="pln">‚è± 35 min üë®‚Äçüç≥ Facile ‚Ç¨ Bon march√© üòã 6 Personnes</span><span class="tag">&lt;/h3&gt;</span><span class="pln">
            </span><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"https://assets.afcdn.com/recipe/20170204/34670_w1200h911c1cx331cy290.jpeg"</span><span class="pln"> </span><span class="atn">alt</span><span class="pun">=</span><span class="atv">"Dessert l√©ger aux fruits de la passion"</span><span class="tag">&gt;</span><span class="pln">
        </span><span class="tag">&lt;/article&gt;&lt;/section&gt;&lt;/main&gt;</span><span class="pln">
    </span><span class="tag">&lt;/div&gt;</span><span class="pln">
	</span><span class="tag">&lt;/body&gt;</span><span class="pln">
</span><span class="tag">&lt;/html&gt;</span></code></pre>
<p>De m√™me, nous remarquons aussi du code javascript qui indique quel 
est l'√©tat de la page pour que le javascript puisse se d√©marrer et se 
positionner dans l'√©tat o√π la page a √©t√© cr√©√©.</p>
<p>Si nous regardons les appels http, et que nous ouvrons directement une page de recette : <a href="http://localhost:3000/recettes/0" target="_blank">http://localhost:3000/recettes/0</a>, nous remarquons qu'aucun appel √† l'url <a href="http://localhost:3000/recettes/0.json" target="_blank">http://localhost:3000/recettes/0.json</a> n'est fait. Si nous cliquons sur le lien <code>Suivant</code>, l'url <a href="http://localhost:3000/recettes/1.json" target="_blank">http://localhost:3000/recettes/1.json</a> est charg√©e.</p>
<h2 is-upgraded="">Prefetch</h2>
<p>SvelteKit va essayer de pr√©charger au maximum les pages et les 
ressources. Si nous voulons permettre de pr√©charger une page disponible 
derri√®re un lien (au survol de celui-ci), il suffit d'ajouter <code>sveltekit:prefetch</code> sur une balise html <code>&lt;a&gt;</code>.</p>
<p>Dans le fichier <code>index.svelte</code> du r√©pertoire <code>src/routes</code>, modifions le lien vers les pages de recettes :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;h2&gt;&lt;a</span><span class="pln"> </span><span class="atn">sveltekit:prefetch</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"/recettes/{index}"</span><span class="tag">&gt;</span><span class="pln">{item.name}</span><span class="tag">&lt;/a&gt;&lt;/h2&gt;</span></code></pre>
<p>Maintenant en regardant les requettes http, nous pouvons voir que l'url <code>/recettes/x.json</code>
 sera pr√©charg√©e au survol du lien, avant m√™me de cliquer sur celui-ci. 
La page s'affichera ensuite imm√©diatement apr√®s un clic sur le lien.</p>


      </div></div></google-codelab-step><google-codelab-step label="Testing" duration="10" step="25"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">25. Testing</h2>
        <p>√Ä pr√©sent, penchons nous un peu sur la partie testing. Nous allons voir comment nous pouvons tester nos composants <em>Svelte</em>.</p>
<h2 is-upgraded="">Configuration</h2>
<p>Pour √©crire des tests dans notre application, nous allons utiliser <a href="https://jestjs.io/fr/" target="_blank">jest</a> et la  <a href="https://testing-library.com/docs/svelte-testing-library/intro" target="_blank">Svelte Testing Library</a> .</p>
<h3 is-upgraded="">jest, svelte-jester &amp; babel</h3>
<p>Commen√ßons par installer <a href="https://jestjs.io/fr/" target="_blank">jest</a>, ainsi que <a href="https://github.com/svelteness/svelte-jester" target="_blank">svelte-jester</a> qui va nous permettre de tester nos composants Svelte et <a href="https://babeljs.io/" target="_blank">babel</a> pour pouvoir utiliser les modules es6.</p>
<pre><code language="language-sh:" class="language-sh:"><span class="pln">npm install </span><span class="pun">--</span><span class="pln">save</span><span class="pun">-</span><span class="pln">dev jest svelte</span><span class="pun">-</span><span class="pln">jester babel</span><span class="pun">-</span><span class="pln">jest </span><span class="lit">@babel</span><span class="pun">/</span><span class="pln">preset</span><span class="pun">-</span><span class="pln">env</span></code></pre>
<p>Ensuite, nous pouvons ajouter les scripts suivants dans le <code>package.json</code> pour pouvoir lancer les tests :</p>
<pre><code language="language-json" class="language-json"><span class="pln">  </span><span class="str">"test"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"jest src"</span><span class="pun">,</span><span class="pln">
  </span><span class="str">"test:watch"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"npm run test -- --watch"</span></code></pre>
<p>Toujours dans le fichier <code>package.json</code>, configurons jest en ajoutant les lignes suivantes :</p>
<pre><code language="language-json" class="language-json"><span class="pln"> </span><span class="str">"jest"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
   </span><span class="str">"testEnvironment"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"jsdom"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"transform"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="str">"^.+\\.js$"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"babel-jest"</span><span class="pun">,</span><span class="pln">
      </span><span class="str">"^.+\\.svelte$"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"svelte-jester"</span><span class="pln">
    </span><span class="pun">},</span><span class="pln">
    </span><span class="str">"moduleFileExtensions"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="pln">
      </span><span class="str">"js"</span><span class="pun">,</span><span class="pln">
      </span><span class="str">"svelte"</span><span class="pln">
    </span><span class="pun">]</span><span class="pln">
  </span><span class="pun">}</span></code></pre>
<p>Configurons √† pr√©sent babel en ajoutant √† la racine du projet un nouveau fichier <code>.babelrc</code> :</p>
<pre><code language="language-json" class="language-json"><span class="pun">{</span><span class="pln">
    </span><span class="str">"presets"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[[</span><span class="str">"@babel/preset-env"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="str">"targets"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str">"node"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"current"</span><span class="pun">}}]]</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<h3 is-upgraded="">@testing-library/svelte</h3>
<p>Nous allons maintenant installer <a href="https://testing-library.com/docs/svelte-testing-library/intro" target="_blank">@testing-library/svelte</a>.</p>
<pre><code language="language-shell" class="language-shell"><span class="pln">npm install </span><span class="pun">--</span><span class="pln">save</span><span class="pun">-</span><span class="pln">dev </span><span class="lit">@testing</span><span class="pun">-</span><span class="pln">library</span><span class="pun">/</span><span class="pln">svelte </span><span class="lit">@testing</span><span class="pun">-</span><span class="pln">library</span><span class="pun">/</span><span class="pln">jest</span><span class="pun">-</span><span class="pln">dom</span></code></pre>
<p>La configuration des outils n√©cessaires aux tests est termin√©e. Passons √† la cr√©ation des tests.</p>
<h2 is-upgraded="">Cr√©ation des tests</h2>
<p>Pour d√©couvrir comment tester des composants <em>Svelte</em>, nous allons cr√©er des tests sur le composant <code>Imc</code>.</p>
<h3 is-upgraded="">Premier test</h3>
<p>Commen√ßons par cr√©er notre fichier de test √† c√¥t√© du fichier <code>Imc.svelte</code> : <code>Imc.test.js</code>.</p>
<p>Pour le premier test, nous allons chercher √† valider le fait que 
l'imc est bien calcul√© avec les valeurs par d√©faut de l'application.</p>
<p>Dans le fichier <code>Imc.svelte</code>, nous allons ajouter un identifiant de test <code>data-testid="imc"</code>sur la balise <code></code></p><p> affichant l'imc. Cela va nous permettre de s√©lectionner cette balise dans le DOM pour r√©cup√©rer son contenu.</p>
<pre><code language="language-html" class="language-html"><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">class:thin</span><span class="pln"> </span><span class="atn">class:bold</span><span class="pln"> </span><span class="atn">data-testid</span><span class="pun">=</span><span class="atv">"imc"</span><span class="tag">&gt;</span><span class="pln">
  Votre IMC ({$poids}/{$taille}</span><span class="tag">&lt;sup&gt;</span><span class="pln">2</span><span class="tag">&lt;/sup&gt;</span><span class="pln">) est de {$imc}
</span><span class="tag">&lt;/p&gt;</span></code></pre>
<p>Ensuite, nous pouvons √©crire notre test dans le fichier <code>Imc.test.js</code> :</p>
<pre><code language="language-js" class="language-js"><span class="kwd">import</span><span class="pln"> </span><span class="str">'@testing-library/jest-dom'</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> render </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">'@testing-library/svelte'</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Imc</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">'./Imc'</span><span class="pln">

describe</span><span class="pun">(</span><span class="str">'Imc'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    it</span><span class="pun">(</span><span class="str">'should display default imc'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="com">// Chargement du composant.</span><span class="pln">
        </span><span class="kwd">const</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> getByTestId </span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> render</span><span class="pun">(</span><span class="typ">Imc</span><span class="pun">)</span><span class="pln">
        </span><span class="com">// S√©lectionne le &lt;p&gt; affichant l'Imc et r√©cup√®re le contenu textuel.</span><span class="pln">
        </span><span class="kwd">const</span><span class="pln"> displayImc </span><span class="pun">=</span><span class="pln"> getByTestId</span><span class="pun">(</span><span class="str">'imc'</span><span class="pun">).</span><span class="pln">textContent</span><span class="pun">;</span><span class="pln">
        </span><span class="com">// Le texte attendu, avec l'imc calcul√© gr√¢ce aux valeurs par d√©faut.</span><span class="pln">
        </span><span class="kwd">const</span><span class="pln"> expectedImc </span><span class="pun">=</span><span class="pln"> </span><span class="str">'Votre IMC (80/1.82) est de 24.69'</span><span class="pun">;</span><span class="pln">
        </span><span class="com">// La v√©rification.</span><span class="pln">
        expect</span><span class="pun">(</span><span class="pln">displayImc</span><span class="pun">).</span><span class="pln">toBe</span><span class="pun">(</span><span class="pln">expectedImc</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">});</span><span class="pln">
</span><span class="pun">});</span></code></pre>
<p>Maintenant, nous pouvons lancer le test et v√©rifier que ce dernier passe correctement.</p>
<pre><code language="language-sh" class="language-sh"><span class="pln">npm run test</span></code></pre>
<h3 is-upgraded="">Second test</h3>
<p>Un second test que nous pouvons ajouter ici est la v√©rification de l'affichage de l'indicateur <code>Vous √™tes svelte !</code> avec l'imc par d√©faut.</p>
<pre><code language="language-js" class="language-js"><span class="pln">    it</span><span class="pun">(</span><span class="str">'should display the right health indicator'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">const</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> getByText </span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> render</span><span class="pun">(</span><span class="typ">Imc</span><span class="pun">);</span><span class="pln">
        expect</span><span class="pun">(</span><span class="pln">getByText</span><span class="pun">(</span><span class="str">'Vous √™tes svelte !'</span><span class="pun">)).</span><span class="pln">toBeInTheDocument</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">});</span></code></pre>
<p>L'id√©e n'√©tant d'√™tre exhaustif sur les tests du composant <code>Imc</code>,
 nous allons nous arr√™ter l√† pour la partie testing. Si vous souhaitez 
aller un peu plus loin, vous pourrez ajouter d'autres tests pour tester 
les autres √©tats du composant. R√©f√©rez vous √† la documention de <a href="https://testing-library.com/docs/svelte-testing-library/intro" target="_blank">@testing-library/svelte</a> et de <a href="https://jestjs.io/fr/" target="_blank">jest</a> pour vous aider.</p>


      </div></div></google-codelab-step><google-codelab-step label="D√©ployer l'application" duration="10" step="26"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">26. D√©ployer l'application</h2>
        <p>Pour d√©ployer l'application cr√©√©e sur un serveur, il est 
n√©cessaire d'installer un "adapter". Cet adapter va transformer le code 
pour g√©n√©rer le code statique et le code dynamique et les confirgurer en
 fonction de la plateforme cible.</p>
<h2 is-upgraded="">Application node</h2>
<p>Installer l'adapter :</p>
<pre><code language="language-shell" class="language-shell"><span class="pln">npm install </span><span class="pun">-</span><span class="pln">d </span><span class="lit">@sveltejs</span><span class="pun">/</span><span class="pln">adapter</span><span class="pun">-</span><span class="pln">node@next</span></code></pre>
<p>Puis dans le fichier svelte.config.js modifier l'import de l'adapter par :</p>
<pre><code language="language-js" class="language-js"><span class="kwd">import</span><span class="pln"> adapter </span><span class="kwd">from</span><span class="pln"> </span><span class="str">'@sveltejs/adapter-node'</span><span class="pun">;</span></code></pre>
<p>Il est aussi possible passer des param√®tres √† l'adapter :</p>
<pre><code language="language-js" class="language-js"><span class="kwd">import</span><span class="pln"> adapter </span><span class="kwd">from</span><span class="pln"> </span><span class="str">'@sveltejs/adapter-node'</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">export</span><span class="pln"> </span><span class="kwd">default</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	kit</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		adapter</span><span class="pun">:</span><span class="pln"> adapter</span><span class="pun">({</span><span class="pln"> </span><span class="kwd">out</span><span class="pun">:</span><span class="pln"> </span><span class="str">'my-output-directory'</span><span class="pln"> </span><span class="pun">})</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">};</span><span class="pln">
</span></code></pre>
<h2 is-upgraded="">Application static</h2>
<p>Si votre application n'a pas de code cot√© serveur, il est possible 
d'avoir un adapter qui va g√©n√©rer un site statique (uniquement du html 
et du javascript).</p>
<p>Pour cela, il suffit d'installer l'adapter <code>@sveltejs/adapter-static</code>.</p>
<p>Le site peut alors √™tre d√©ploy√© sur n'importe quel serveur http.</p>
<h2 is-upgraded="">D√©ployer l'application sur netlify</h2>
<p>Netlify permet d'avoir un site avec des fichiers statiques mais aussi
 des fonctions javascript permettant d'√©xecuter votre application back 
ou le pr√©rendu html de votre front.</p>
<p>Installer l'adapter :</p>
<pre><code language="language-shell" class="language-shell"><span class="pln">npm install </span><span class="pun">-</span><span class="pln">d </span><span class="lit">@sveltejs</span><span class="pun">/</span><span class="pln">adapter</span><span class="pun">-</span><span class="pln">netlify@next</span></code></pre>
<p>Puis modifiez le fichier de configuration svelte.config.js :</p>
<pre><code language="language-js" class="language-js"><span class="kwd">import</span><span class="pln"> adapter </span><span class="kwd">from</span><span class="pln"> </span><span class="str">'@sveltejs/adapter-netlify'</span><span class="pun">;</span><span class="pln">

</span><span class="com">/** @type {import('@sveltejs/kit').Config} */</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> config </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	kit</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		adapter</span><span class="pun">:</span><span class="pln"> adapter</span><span class="pun">({</span><span class="pln">
			split</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pln">
		</span><span class="pun">}),</span><span class="pln">

		</span><span class="com">// hydrate the &lt;div id="svelte"&gt; element in src/app.html</span><span class="pln">
		target</span><span class="pun">:</span><span class="pln"> </span><span class="str">'#svelte'</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">};</span><span class="pln">

</span><span class="kwd">export</span><span class="pln"> </span><span class="kwd">default</span><span class="pln"> config</span><span class="pun">;</span></code></pre>
<p>Cr√©er ensuite un fichier netlify.toml pour indiquer √† netlify comment constuire votre application et la publier</p>
<pre><code language="language-properties" class="language-properties"><span class="pun">[</span><span class="pln">build</span><span class="pun">]</span><span class="pln">
  command </span><span class="pun">=</span><span class="pln"> </span><span class="str">"npm run build"</span><span class="pln">
  publish </span><span class="pun">=</span><span class="pln"> </span><span class="str">"build"</span></code></pre>
<h3 is-upgraded="">D√©ployer directement depuis git</h3>
<p>Sauvegardez votre site sur un repos github, gitlab, ou bitbucket.</p>
<p>Allez directement sur https://app.netlify.com/start</p>
<p>Connectez vous avec votre compte github, gitlab ou bitbucket, et 
selectionnez votre projet. Netlify va automatiquement s'abonner √† votre 
projet git et mettera alors automatiquement √† jour votre site sur 
netlify</p>
<h3 is-upgraded="">D√©ployer de mani√®re manuel</h3>
<p>Si vous voulez d√©ployer sur netlify depuis votre CI, netlify fournit 
une ligne de commande qui permet de deployer quand vous voulez votre 
projet.</p>
<p>Documentation : <a href="https://docs.netlify.com/cli/get-started/" target="_blank">https://docs.netlify.com/cli/get-started/</a></p>


      </div></div></google-codelab-step><google-codelab-step label="Ajouter une recherche de recette sur Marmiton (Bonus)" duration="15" step="27"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">27. Ajouter une recherche de recette sur Marmiton (Bonus)</h2>
        <p>Ajoutons maintenant un formulaire de recherche pour rechercher des recettes sur le site marmiton.org.</p>
<p>Une biblioth√®que apporte une API pour faire une recherche sur le site marmiton.org : https://www.npmjs.com/package/marmiton-api</p>
<h2 is-upgraded="">Ajouter la lib</h2>
<p>Ajoutons cette d√©pendance sur le projet :</p>
<pre><code language="language-shell" class="language-shell"><span class="pln">npm install marmiton</span><span class="pun">-</span><span class="pln">api</span></code></pre>
<h2 is-upgraded="">API de recherche</h2>
<p>Il faut maintenant cr√©er une API sur notre projet qui r√©cup√®re en 
POST la recherche qui est faite.Nous utilisons la lib nouvellement 
ajout√©e et puis nous retournons le r√©sultat.</p>
<p>Cr√©ons un nouveau fichier <code>search.json.js</code> dans le r√©pertoire <code>src/route/recettes</code></p>
<pre><code><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> searchRecipes</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MarmitonQueryBuilder</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">'marmiton-api'</span><span class="pln">

</span><span class="com">/** @type {import('@sveltejs/kit').RequestHandler} */</span><span class="pln">
</span><span class="kwd">export</span><span class="pln"> async </span><span class="kwd">function</span><span class="pln"> post</span><span class="pun">({</span><span class="pln"> request </span><span class="pun">})</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">const</span><span class="pln"> body </span><span class="pun">=</span><span class="pln"> await request</span><span class="pun">.</span><span class="pln">json</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">const</span><span class="pln"> qb </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MarmitonQueryBuilder</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">const</span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> qb
    </span><span class="pun">.</span><span class="pln">withTitleContaining</span><span class="pun">(</span><span class="pln">body</span><span class="pun">.</span><span class="pln">query</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">.</span><span class="pln">build</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">const</span><span class="pln"> recipes </span><span class="pun">=</span><span class="pln"> await searchRecipes</span><span class="pun">(</span><span class="pln">query</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> limit</span><span class="pun">:</span><span class="pln"> </span><span class="lit">6</span><span class="pln"> </span><span class="pun">})</span><span class="pln">

    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        body</span><span class="pun">:</span><span class="pln"> recipes
    </span><span class="pun">};</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<p>Nous avons maintenant une API pour faire une recherche sur marmiton sur l'url <a href="http://localhost:3000/recettes/search.json" target="_blank">http://localhost:3000/recettes/search.json</a></p>
<p>Vous pouvez la tester avec la requette suivante :</p>
<pre><code language="language-shell" class="language-shell"><span class="pln">curl </span><span class="pun">--</span><span class="pln">location </span><span class="pun">--</span><span class="pln">request POST </span><span class="str">'http://localhost:3000/recettes/search.json'</span><span class="pln"> \
</span><span class="pun">--</span><span class="pln">data</span><span class="pun">-</span><span class="pln">raw </span><span class="str">'{
    "query": "tomate"
}'</span></code></pre>
<h2 is-upgraded="">Interface front</h2>
<p>Dans le fichier <code>index.svelte</code>, ajoutons le code pour le formulaire de recherche :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;form</span><span class="pln"> </span><span class="atn">on:submit</span><span class="pln">|</span><span class="atn">preventDefault</span><span class="pun">=</span><span class="atv">{submitForm}</span><span class="tag">&gt;</span><span class="pln">
	</span><span class="tag">&lt;label</span><span class="pln"> </span><span class="atn">for</span><span class="pun">=</span><span class="atv">"query"</span><span class="tag">&gt;</span><span class="pln">
	</span><span class="tag">&lt;span</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"sr-only"</span><span class="tag">&gt;</span><span class="pln">Recherche sur marmiton.org</span><span class="tag">&lt;/span&gt;</span><span class="pln">
	</span><span class="tag">&lt;/label&gt;</span><span class="pln">
	</span><span class="tag">&lt;input</span><span class="pln">
	    </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"query"</span><span class="pln">
	    </span><span class="atn">aria-label</span><span class="pun">=</span><span class="atv">"Recherche sur marmiton.org"</span><span class="pln">
		</span><span class="atn">type</span><span class="pun">=</span><span class="atv">"search"</span><span class="pln">
		</span><span class="atn">name</span><span class="pun">=</span><span class="atv">"query"</span><span class="pln">
		</span><span class="atn">placeholder</span><span class="pun">=</span><span class="atv">"Recherche sur marmiton.org"</span><span class="pln">
		</span><span class="atn">required</span><span class="pln">
		</span><span class="atn">bind:value</span><span class="pun">=</span><span class="atv">{query}</span><span class="pln">
	</span><span class="tag">/&gt;</span><span class="pln">
	</span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"submit"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"Rechercher"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;/form&gt;</span></code></pre>
<p>Impl√©mentons maintenant la fonction qui fait la recherche :</p>
<p>Rempla√ßons le script qui d√©fini la variable <code>recettes</code> par ce code :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;script&gt;</span><span class="pln">
  </span><span class="kwd">export</span><span class="pln"> let recettes </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[];</span><span class="pln">
	let query</span><span class="pun">;</span><span class="pln">

	async </span><span class="kwd">function</span><span class="pln"> submitForm</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">const</span><span class="pln"> submit </span><span class="pun">=</span><span class="pln"> await fetch</span><span class="pun">(</span><span class="str">'/recettes/search.json'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		method</span><span class="pun">:</span><span class="pln"> </span><span class="str">'POST'</span><span class="pun">,</span><span class="pln">
		headers</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="str">'Accept'</span><span class="pun">:</span><span class="pln"> </span><span class="str">'application/json, text/plain, */*'</span><span class="pun">,</span><span class="pln">
			</span><span class="str">'Content-Type'</span><span class="pun">:</span><span class="pln"> </span><span class="str">'application/json'</span><span class="pln">
		</span><span class="pun">},</span><span class="pln">
		body</span><span class="pun">:</span><span class="pln"> JSON</span><span class="pun">.</span><span class="pln">stringify</span><span class="pun">({</span><span class="pln"> query </span><span class="pun">}),</span><span class="pln">
		</span><span class="pun">})</span><span class="pln">
		</span><span class="kwd">const</span><span class="pln"> data </span><span class="pun">=</span><span class="pln"> await submit</span><span class="pun">.</span><span class="pln">json</span><span class="pun">()</span><span class="pln">

		recettes </span><span class="pun">=</span><span class="pln"> data
	</span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></code></pre>
<p>Nous faisons ici un appel vers notre API POST que nous avons √©crit juste avant et nous mettons le r√©sultat dans la variable <code>recettes</code>.</p>
<p>Comme l'API de recherche ne nous permet pas de r√©cup√©rer les infos 
d'une recette, et que nous n'avons pas l'image, il est n√©cessaire 
d'adapter un peu le code qui affiche les recettes :</p>
<pre><code language="language-sveltehtml" class="language-sveltehtml"><span class="tag">&lt;section</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"recettes"</span><span class="tag">&gt;</span><span class="pln">
    {#each recettes as item, index (item.name)}
        </span><span class="tag">&lt;article&gt;</span><span class="pln">
            </span><span class="tag">&lt;h2&gt;&lt;a</span><span class="pln"> </span><span class="atn">sveltekit:prefetch</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"{item.url ?? `/recettes/${index}`}"</span><span class="tag">&gt;</span><span class="pln">{item.name}</span><span class="tag">&lt;/a&gt;&lt;/h2&gt;</span><span class="pln">
            </span><span class="tag">&lt;h3&gt;</span><span class="pln">‚è± {item.totalTime} min üë®‚Äçüç≥ {['', 'Tr√®s Facile', 'Facile', 'Moyenne', 'Difficile'][item.difficulty || 0]} ‚Ç¨ {['', 'Bon march√©', 'Moyen', 'Assez cher'][item.budget||0]} üòã {item.people} Personnes</span><span class="tag">&lt;/h3&gt;</span><span class="pln">
            {#if item.image}
               </span><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">{item.image}</span><span class="pln"> </span><span class="atn">alt</span><span class="pun">=</span><span class="atv">{item.name}</span><span class="tag">&gt;</span><span class="pln">
            {/if}
        </span><span class="tag">&lt;/article&gt;</span><span class="pln">
    {/each}
</span><span class="tag">&lt;/section&gt;</span></code></pre>
<p>Nous ouvrons directement la page de marmiton, et nous masquons l'image si elle n'existe pas (la lib ne nous la retourne pas).</p>
<h2 is-upgraded="">Bonus</h2>
<p>Am√©liorer cette recherche :</p>
<ul>
<li>Indicateur de chargement lorsque l'on fait la recherche.</li>
<li>Message si pas de r√©sultats.</li>
<li>Message si il y a une erreur.</li>
<li>Afficher la recette en grand dans l'application.</li>
<li>Ajouter plus d'options de recherche (regarder l'api marmiton-api 
pour connaitre les diff√©rentes options possible) : filtre par 
ingr√©dients, par difficult√©s, prix, ...</li>
</ul>


      </div></div></google-codelab-step><google-codelab-step label="Fin" duration="1" step="28"><div class="instructions"><div class="inner"><h2 is-upgraded="" class="step-title">28. Fin</h2>
        <p>Bravo ! Vous √™tes arriv√©s √† la fin de ce lab ! Nous esp√©rons que vous avez appr√©ci√© cette petite exp√©rience avec <em>Svelte</em> !</p>
<p>Vous trouverez le code final de l'app <a href="https://github.com/Zenika/labs-svelte/tree/master/become-svelte" target="_blank">ici</a>.</p>
<aside class="special"><p>   Pour devenir <em>Svelte</em>, pratiquez r√©guli√®rement ... </p>
</aside>


      </div></div></google-codelab-step></div><div id="controls"><div id="fabs"><a href="#" id="previous-step" title="Previous step" disappear="">Back</a><div class="spacer"></div><a href="#" id="next-step" title="Next step">Next</a><a href="https://codelab-svelte.web.app/" id="done" title="Codelab complete" hidden="">Done</a></div></div></div></google-codelab>

  <script src="Devenir%20svelte%20avec%20Svelte_fichiers/native-shim.js"></script>
  <script src="Devenir%20svelte%20avec%20Svelte_fichiers/custom-elements.js"></script>
  <script src="Devenir%20svelte%20avec%20Svelte_fichiers/prettify.js"></script>
  <script src="Devenir%20svelte%20avec%20Svelte_fichiers/codelab-elements.js"></script>
  <script src="Devenir%20svelte%20avec%20Svelte_fichiers/api.js"></script>



</body></html>